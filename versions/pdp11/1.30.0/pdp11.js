(function(){var l;
function aa(a){var b=16,c;if(a){b||(b=10);var d=a.charAt(0),f=0<a.indexOf(",");f&&(a=a.replace(/,/g,""));"#"==d?(b=8,d=null):"$"==d&&(b=16,d=null);null==d?a=a.substr(1):("0"==d&&(d=a.charAt(1),"b"==d&&f&&(b=2,d=null),"o"==d?(b=8,d=null):"x"==d&&(b=16,d=null)),null==d?a=a.substr(2):(d=a.charAt(a.length-1).toLowerCase(),"y"==d?(b=2,d=null):"."==d?(b=10,d=null):"h"==d&&(b=16,d=null),null==d&&(a=a.substr(0,a.length-1))));var e,d=a;((f=b)&&10!=f?16==f?d.match(/^[0-9a-f]+$/i):8==f?d.match(/^[0-7]+$/):2==
f&&d.match(/^[01]+$/):d.match(/^[0-9]+$/))&&!isNaN(e=parseInt(a,b))&&(c=e|0)}return c}function n(a,b){var c="";b?11<b&&(b=11):b=a&-65536?11:6;if(null==a||isNaN(a))for(;0<b--;)c="?"+c;else for(;0<b--;)c=String.fromCharCode((a&7)+48)+c,a>>=3;return""+c}function q(a,b,c){var d="";b?8<b&&(b=8):b=a&-65536?8:4;if(null==a||isNaN(a))for(;0<b--;)d="?"+d;else for(;0<b--;){var f=a&15,f=f+(0<=f&&9>=f?48:55),d=String.fromCharCode(f)+d;a>>=4}return(c?"0x":"")+d}
function ba(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("&");0<c&&(b=b.substr(0,c));return b}function ca(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}function da(){var a=r();return-1!==a.indexOf("pcjs.org",a.length-8)}var ea={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function fa(a){return a.replace(/[&<>"']/g,function(a){return ea[a]})}var ga=Date.now||function(){return+new Date};
function ha(){function a(a){return(10>a?"0":"")+a}var b=new Date;return b.getFullYear()+"-"+a(b.getMonth()+1)+"-"+a(b.getDate())+" "+a(b.getHours())+":"+a(b.getMinutes())+":"+a(b.getSeconds())}
function t(a,b,c,d){var f=0,e=null,g=null;if("object"==typeof resources&&(e=resources[a]))return d&&d(a,e,f),[e,f];if(c&&"function"==typeof resources)return resources(a,function(b,c){d&&d(a,b,c)}),g;var h=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");c&&(h.onreadystatechange=function(){4===h.readyState&&(e=h.responseText,200==h.status||!h.status&&e.length&&"file:"==(window?window.location.protocol:"file:")||(f=h.status||-1),d&&d(a,e,f))});if(b&&"object"==
typeof b){var k="",m;for(m in b)b.hasOwnProperty(m)&&(k&&(k+="&"),k+=m+"="+encodeURIComponent(b[m]));k=k.replace(/%20/g,"+");h.open("POST",a,!!c);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.send(k)}else h.open("GET",a,!!c),"bytes"==b&&h.overrideMimeType("text/plain; charset=x-user-defined"),h.send();c||(e=h.responseText,200!=h.status&&(f=h.status||-1),d&&d(a,e,f),g=[e,f]);return g}function r(){return"http://"+(window?window.location.host:"www.pcjs.org")}
function u(a){window&&window.alert(a)}function ia(a){var b=!1;window&&(b=window.confirm(a));return b}var ja=null;function ka(){if(null==ja){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}ja=a}return ja}function la(a){var b;if(window)try{b=window.localStorage.getItem(a)}catch(c){}return b}
function ma(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}function na(a){if(window){var b=window?window.navigator.userAgent:"";return"iOS"==a&&b.match(/(iPod|iPhone|iPad)/)&&b.match(/AppleWebKit/)||"MSIE"==a&&b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)?!0:!1}return!1}var v={init:[],show:[],exit:[]},oa=!1,pa=!1,qa=!0;function ra(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}function w(a){v.init.push(a)}
function sa(a){if(qa)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){u(""+("An unexpected exception occurred:\n\n"+c.message+"\n\nPlease send this information to support@pcjs.org. Thanks."))}}function ta(a){!qa&&a?(qa=!0,oa&&ua("init"),pa&&ua("show")):qa=a}function ua(a){v[a]&&sa(v[a])}ra("onload",function(){oa=!0;sa(v.init)});ra("onpageshow",function(){pa=!0;sa(v.show)});ra(na("Opera")||na("iOS")?"onunload":"onbeforeunload",function(){sa(v.exit)});
function x(a,b,c){this.type=a;b||(b={id:"",name:""});this.id=b.id||"";this.name=b.name;this.Lb=b.comment;this.ic=b;b=this.id.indexOf(".");0>b?this.yb=this.id:(this.Nb=this.id.substr(0,b),this.yb=this.id.substr(b+1));this[a]=c;this.g={ready:!1,Ya:!1,Bb:!1,L:!1,error:!1};this.nb=null;this.g.error=!1;this.u={};this.H=null;y.push(this)}var va=void 0,wa={};
if(window){va||(va=window.location.search.substr(1));for(var xa,ya=/\+/g,za=/([^&=]+)=?([^&]*)/g;xa=za.exec(va);)wa[decodeURIComponent(xa[1].replace(ya," "))]=decodeURIComponent(xa[2].replace(ya," "))}function Aa(a){function b(){}if(window){if(!a)throw new TypeError;if(Object.create)return Object.create(a);var c=typeof a;if("object"!==c&&"function"!==c)throw new TypeError;}b.prototype=a;return new b}
function z(a,b){b||(b=x);a.prototype=Aa(b.prototype);a.prototype.constructor=a;a.prototype.parent=b.prototype}if(window){window.PCjs||(window.PCjs={});var Ba=window.PCjs.Machines||(window.PCjs.Machines={}),y=window.PCjs.Components||(window.PCjs.Components=[])}else Ba={},y=[];function Ca(a,b,c){Ba[a]&&b&&(Ba[a][b]=c)}function A(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<y.length;b++){var d=y[b];a&&d.id.indexOf(a)||c.push(d)}return c}
function Da(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<y.length;d++)if(c)c==y[d]&&(c=null);else if(!(a!=y[d].type||b&&y[d].id.indexOf(b)))return y[d]}return null}function B(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){u(c.message+" ("+a+")")}return b}
function C(a,b){b=D(b.parentNode,"pdp11-control");for(var c=0;c<b.length;c++)for(var d=b[c].childNodes,f=0;f<d.length;f++){var e=d[f];if(1===e.nodeType){var g=e.getAttribute("class");if(g)for(var h=g.split(" "),k=0;k<h.length;k++)switch(g=h[k],g){case "pdp11-binding":(g=B(e))&&g.binding&&a.aa(g.type,g.binding,e,g.value),k=h.length}}}}
function D(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var f=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)f.test(a[b].className)&&c.push(a[b]);return c}
x.prototype={constructor:x,parent:null,toString:function(){return this.name?this.name:this.id||this.type},aa:function(a,b,c){switch(b){case "clear":return this.u[b]||(this.u[b]=c,c.onclick=function(a){return function(){a.u.print&&(a.u.print.value="")}}(this)),!0;case "print":return this.u[b]||(this.Cb=this.u[b]=c,c.value="",this.I=function(a){return function(b,c){8192<a.value.length&&(a.value=a.value.substr(a.value.length-4096));a.value+=(void 0!==c?c+": ":"")+(b||"")+"\n";a.scrollTop=a.scrollHeight}}(c),
this.K=function(a){this.I(a,this.yb)}),!0;default:return!1}},log:function(){},I:function(){},status:function(a){this.I(this.yb+": "+a)},K:function(a,b,c){c=c||this.type;b||u((c?c+": ":"")+a)},ua:function(){return this.g.L=!0},ta:function(a,b){b&&(this.g.L=!1);return!0}};function Ea(a,b){if(a.g.Bb)return a.g.Ya&&(a.g.Ya=!1),a.g.Bb=!1;if(a.g.error)return a.I(a.toString()+" error"),!1;a.g.Ya=b;return a.g.Ya}function E(a){if(!a.g.error&&(a.g.ready=!0,a.g.ready)){var b=a.nb;a.nb=null;b&&b()}}
function Fa(a,b){b&&(a.g.ready?b():a.nb=b);return a.g.ready}var Ga="undefined"!==typeof ArrayBuffer;function Ha(a){x.call(this,"Panel",a,Ha)}z(Ha);l=Ha.prototype;l.aa=function(a,b,c,d){return this.h&&this.h.aa(a,b,c,d)||this.a&&this.a.aa(a,b,c,d)?!0:this.parent.aa.call(this,a,b,c,d)};l.Ja=function(a,b,c,d){this.h=a;this.j=b;this.a=c;this.H=d};l.ua=function(a,b){b||Ia();return!0};l.ta=function(){return!0};l.Ma=function(){};
function Ia(){for(var a=!1,b=D(document,"pdp11","panel"),c=0;c<b.length;c++){var d=b[c],f=B(d),e;a:{e=f.id;if(void 0!==e){var g;for(g=0;g<y.length;g++)if(y[g].id===e){e=y[g];break a}}e=null}e||(a=!0,e=new Ha(f));C(e,d);a&&E(e)}}w(Ia);
function G(a,b,c){x.call(this,"Bus",a,G);this.a=b;this.H=c;this.B=a.busWidth||16;this.o=Math.pow(2,this.B);this.i=this.o-1|0;this.j=(this.B>>1)+2;10>this.j&&(this.j=10);15<this.j&&(this.j=15);this.f=1<<this.j;this.C=this.f>>2;this.h=this.f-1;this.l=this.o/this.f|0;this.J=this.l-1;this.ma=[];this.w=null;this.Za=this.M;a=new I;Ja(a,this.H);this.b=Array(this.l);for(b=0;b<this.l;b++)this.b[b]=a;this.Va=Array(4);this.Va[0]=Ka;this.Va[1]=La;this.Va[2]=Ma;this.Va[3]=Na;Oa(this,this.o-8192,8192,Pa,this);
Oa(this,57344,8192,Pa,this);E(this)}z(G);function Ka(a,b){var c=this.controller,d=c.ma[a];if(d){if(d[0])return d[0](b);if(d[2])return b&1?d[2](b&-2)>>8:d[2](b)&255}else if(b&1&&(d=c.ma[a&-2],d[2]))return d[2](b&-2)>>8;c.I("warning: unconverted read access to byte @"+n(b));return c.Za(b,-1,1)}
function La(a,b,c){var d=this.controller,f=d.ma[a];if(f){if(f[1]){f[1](b,c);return}if(f[3]){a=f[2]?f[2](c):0;if(c&1)f[3](a&255|b<<8,c&-2);else f[3](a&-256|b,c);return}}else if(c&1&&(f=d.ma[a&-2],f[3])){c&=-2;a=f[2]?f[2](c):0;f[3](a&255|b<<8,c);return}d.I("warning: unconverted write access to byte @"+n(c));d.Za(c,b,1)}
function Ma(a,b){var c=this.controller;if(a=c.ma[a]){if(a[2])return a[2](b);if(a[0])return a[0](b)|a[0](b+1)<<8}c.I("warning: unconverted read access to word @"+n(b));return c.Za(b,-1,0)}function Na(a,b,c){var d=this.controller;if(a=d.ma[a]){if(a[3]){a[3](b,c);return}if(a[1]){a[1](b&255,c);a[1](b>>8,c+1);return}}d.I("warning: unconverted write access to word @"+n(c));d.Za(c,b,0)}G.prototype.reset=function(){this.w&&this.w()};G.prototype.M=function(){return 0};
G.prototype.ua=function(a,b){b||this.reset();return!0};function Oa(a,b,c,d,f){for(var e=b,g=c,h=e>>>a.j;0<g&&h<a.b.length;){var k=a.b[h],m=h*a.f,p=a.f-(e-m);p>g&&(p=g);if(k&&k.size){if(k.type==d&&k.controller==f){if(e+g<=k.Qa)return k.vb+=k.Qa-e,k.Qa=e,!0;if(e>=k.Qa+k.vb){p=k.size-(e-m);p>g&&(p=g);k.vb=e-k.Qa+p;e=m+a.f;g-=p;h++;continue}}return Qa(1,e,g)}e=new I(e,p,a.f,d,f);Ja(e,a.H,k);a.b[h++]=e;e=m+a.f;g-=p}return 0>=g?(a.status(Math.floor(c/1024)+"Kb "+Ra[d]+" at "+q(b,8,!0)),!0):Qa(2,b,c)}
function Sa(a){for(var b=0,c=[],d=0;d<a.l;d++){var f=a.b[d];if(f.qa||f.fc){c[b++]=d;var e=b++;if(f=f.save()){for(var g=0,h=0,k=[];g<f.length;){for(var m=f[g],p=g+1;p<f.length&&f[p]===m;)p++;k[h++]=p-g;k[h++]=m;g=p}k.length<f.length&&(f=k)}c[e]=f}}return c}function Qa(a,b,c){u("Memory block error ("+a+": "+q(b)+","+q(c)+")");return!1}
function J(a){x.call(this,"Device",a,J);this.f={Fb:[],ca:0,U:128,b:127,ec:0};this.h={data:0,Ic:0,Ra:20,Bc:0};this.b={Eb:0,s:0};this.i={cb:2496,P:0,v:128,eb:0,bb:0,T:0,Vb:0,R:[],Ha:[406,406,406,406],F:[12,12,12,12]};this.l={s:129,Xa:0,G:0,sa:0,na:0,ya:0,R:[],F:[40,40,40,40],Ha:[1024,1024,512,512],cc:[157,157,29,29]};this.o={a:[8210,8208,8210,8226],F:[22,22,22,50],Ga:[19,19,19,32],xb:[815,411,815,630],R:[],A:2176,Ua:0,Sa:0,$:[0,0,0,0,0,0,0,0],Z:0,S:[4544,4544,4544,4544,4544,4544,4544,4544],Ta:[0,0,
0,0,0,0,0,0],La:0,zc:[0,0,0,0,0,0,0,0],Wb:0,Xb:[0,0,0,0,0,0,0,0],u:[0,0,0,0,0,0,0,0],Ac:[1,2,3,4,5,6,7,8],Yb:[0,0,0,0,0,0,0,0],ha:[0,0,0,0,0,0,0,0],ub:[0,0,0,0,0,0,0,0],xc:[0,0,0,0,0,0,0,0],yc:[0,0,0,0,0,0,0,0],vc:[0,0,0,0,0,0,0,0],wc:[0,0,0,0,0,0,0,0],xa:0,Hb:0}}z(J);
var Ta=[4127,448,4191,450,4383,452,2591,454,21983,32768,65534,13791,16384,65534,770,2719,454,2591,65534,257,0,2566,33028,34051,33282,1281,33537,0,2758,32771,770,1025,1793,0,3078,33794,34305,513,0,5574,43690,4480,4097,4162,4227,4292,4357,57665,1281,769,0,3138,34305,1281,0,24707,2691,2627,24769,34561,1793,0,3076,20739,24899,2691,34562,2753,1281,0,2624,33537,0,16385,24641,1537,1793,0,193,8279,21589,516,12549,1538,2629,513,0,38336,65281,32769,0,32258,2561,2689,32258,3008,514,3009,769,0,5574,510,2551,
2,0,9678,208,769,0,5582,226,135,0,2598,5606,236,2,0,95,242,128,5573,57344,2591,6,5599,256,4,5574,510,3045,5599,460,76,2591,78,5571,65510,5579,12,5570,512,4224,4104,3024,8197,33788,4224,4609,8193,769,0,2640,8197,33785,6145,2625,8193,769,0,8194,761,2574,5572,43690,5579,24,5568,2048,5570,512,2628,4360,2632,2632,8708,769,0,3103,65514,34562,0,305,35406,754,258,119,65160,3024,32403,5579,36,5568,3072,35446,1,740,5570,512,4224,4104,3024,8197,33788,5569,3,2574,3039,454,528,5582,24,4224,2632,2632,8200,769,
0,3024,3103,65514,34562,0,264,8197,33779,5003,2574,32337,260,0,258,5579,12,6080,448,6081,450,6084,452,116,2,6084,65400,17860,65024,21956,62976,38848,65401,3200,161,76,0,16944,10797];l=J.prototype;
l.Ja=function(a,b,c,d){this.j=b;this.a=c;this.H=d;a=Ua;for(var f in a){var e=a[f];c=b;d=+f;for(var g=e[0]?e[0].bind(this):null,h=e[1]?e[1].bind(this):null,k=e[2]?e[2].bind(this):null,e=e[3]?e[3].bind(this):null,m=+f;m<=d;m+=2){var p=m&8191;void 0!==c.ma[p]?u("I/O address already registered: "+q(m,8,!0)):c.ma[p]=[g,h,k,e,!1]}}f=this.bc.bind(this);b.w=this.reset.bind(this);b.Za=f;E(this)};l.oc=function(){var a=this.b.ra;this.b.ra&=-129;return a};
l.Dc=function(a){this.b.ra=a;a&64&&!this.b.Eb&&(setInterval(this.kc.bind(this),25),this.b.Eb=1);this.b.ra=a&-129};l.pc=function(){var a=this.a;return a.w&62337|a.Oa<<5|a.Pa<<1};l.Ec=function(a){var b=4,c=this.a;c.w=a&=62337;c.Oa=a>>5&3;c.Pa=a>>1&15;c.ob=a&257?a&1?6:4:0;Va(c);a=c.w;a&1|256&&(b=this.a.Da&16?1:2);this.h.Ra=this.h.Ra&-8|b};l.rc=function(){return this.f.U};
l.Hc=function(a){if(128==(this.f.U&192)&&a&64){var b=this;K(this.a,8,4,52,function(){b.f.U|=128;return!!(b.f.U&64)})}this.f.U=this.f.U&128|a&-129};l.qc=function(){return Wa(this.a)};l.Fc=function(a){Xa(this.a,a&-1809|Wa(this.a)&1808);this.a.D|=128};
function Ya(a){var b=a.i,c,d,f,e=b.T>>13&7;"undefined"===typeof b.R[e]&&(b.R[e]={cache:[],postProcess:a.sc,drive:e,blocksize:256,mapped:0,maxblock:b.Ha[e]*b.F[e],url:"rk"+e+".dsk"});b.v&=-129;switch(b.v>>1&7){case 0:b.cb=2496;b.P=0;b.v=128;b.T=0;break;case 1:if((b.T>>4&511)>=b.Ha[e]){b.P|=32832;b.v|=49152;break}if((b.T&15)>=b.F[e]){b.P|=32800;b.v|=49152;break}c=(b.T>>4&511)*b.F[e]+(b.T&15);d=(b.v&48)<<12|b.bb;f=65536-b.eb&65535;Za(a,b.R[e],c,d,f);return;case 2:if((b.T>>4&511)>=b.Ha[e])b.P|=32832,
b.v|=49152;else if((b.T&15)>=b.F[e])b.P|=32800,b.v|=49152;else{c=(b.T>>4&511)*b.F[e]+(b.T&15);d=(b.v&48)<<12|b.bb;f=65536-b.eb&65535;a.rb(b.R[e],c,d,f);return}}b.cb=e<<13|b.cb&8176|b.T%9&15;K(a.a,20,5,144,function(){b.v=b.v&65534|128;return!!(b.v&64)})}l.sc=function(a,b,c,d,f){var e=this.i;e.bb=d&65535;e.v=e.v&-49|d>>12&48;e.eb=65536-f&65535;switch(a){case 1:e.P|=33024;e.v|=49152;break;case 2:e.P|=33792,e.v|=49152}K(this.a,20,5,144,function(){e.v=e.v&65534|128;return!!(e.v&64)})};
function $a(a){var b=a.l,c,d,f,e=b.s>>8&3;b.s&=-2;"undefined"===typeof b.R[e]&&(b.R[e]={cache:[],postProcess:a.tc,drive:e,blocksize:128,mapped:1,maxblock:b.Ha[e]*b.F[e],url:"rl"+e+".dsk"});switch(b.s>>1&7){case 2:b.sa&8&&(b.s&=63);b.sa=b.cc[e]|b.ya&64;break;case 3:1==(b.G&3)&&(b.ya=b.G&4?b.ya+(b.G&65408)&65408|b.G<<2&64:b.ya-(b.G&65408)&65408|b.G<<2&64,b.G=b.ya);break;case 4:b.sa=b.ya;break;case 5:if(b.G>>6>=b.Ha[e]){b.s|=37888;break}if((b.G&63)>=b.F[e]){b.s|=37888;break}c=(b.G>>6)*b.F[e]+(b.G&63);
d=(b.na&63)<<16|b.Xa;f=65536-b.sa&65535;Za(a,b.R[e],c,d,f);return;case 6:if(b.G>>6>=b.Ha[e])b.s|=37888;else if((b.G&63)>=b.F[e])b.s|=37888;else{c=(b.G>>6)*b.F[e]+(b.G&63);d=(b.na&63)<<16|b.Xa;f=65536-b.sa&65535;a.rb(b.R[e],c,d,f);return}}K(a.a,20,5,112,function(){b.s|=129;return!!(b.s&64)})}
l.tc=function(a,b,c,d,f){var e=this.l;e.Xa=d&65535;e.s=e.s&-49|d>>12&48;e.na=d>>16&63;e.G=~~(c/e.F[b.fa])<<6|c%e.F[b.fa];e.ya=e.G;e.sa=65536-f&65535;switch(a){case 1:e.s|=33792;break;case 2:e.s|=40960}K(this.a,20,5,112,function(){e.s|=129;return!!(e.s&64)})};function ab(a){a=a.o;a.A=2176;a.Z=0;a.S=[4544,4544,4544,4544,4544,4544,4544,4544];a.Ta=[0,0,0,0,0,0,0,0];a.La=a.Ua=a.Sa=a.xa=a.Hb=0}
function bb(a,b){var c=a.o,d,f,e;c.A&=-16513;c.Z&=-2049;c.S[b]&=-1153;K(a.a,-1,0,172);"undefined"===typeof c.R[b]&&(c.R[b]={cache:[],postProcess:a.uc,drive:b,blocksize:256,mapped:0,maxblock:c.xb[0]*c.Ga[0]*c.F[0],url:"rp"+b+".dsk"});switch(c.A&63){case 5:c.ub[b]=c.ha[b];c.A|=32896;c.S[b]|=32896;c.La|=1<<b;break;case 9:ab(a);break;case 19:c.S[b]|=64;break;case 49:if(c.ha[b]>=c.xb[0]||c.$[b]>>8>=c.Ga[0]||(c.$[b]&255)>=c.F[0]){c.Ta[b]|=1024;c.A|=49152;break}d=(c.ha[b]*c.Ga[0]+(c.$[b]>>8))*c.F[0]+(c.$[b]&
255);f=(c.xa&63)<<16|c.Sa;e=65536-c.Ua&65535;Za(a,c.R[b],d,f,e);return;case 57:if(c.ha[b]>=c.xb[0]||c.$[b]>>8>=c.Ga[0]||(c.$[b]&255)>=c.F[0])c.Ta[b]|=1024,c.A|=49152;else{d=(c.ha[b]*c.Ga[0]+(c.$[b]>>8))*c.F[0]+(c.$[b]&255);f=(c.xa&63)<<16|c.Sa;e=65536-c.Ua&65535;a.rb(c.R[b],d,f,e);return}}K(a.a,3,5,172,function(){c.A=c.A&65534|128;c.S[b]|=128;return!!(c.A&64)})}
l.uc=function(a,b,c,d,f){var e=this.o;e.Ua=65536-f&65535;e.Sa=d&65535;e.A=e.A&-769|d>>8&768;e.xa=d>>16&63;f=~~(c/e.F[0]);d=~~(f/e.Ga[0]);e.$[b.fa]=f%e.Ga[0]<<8|c%e.F[0];e.ub[b.fa]=e.ha[b.fa]=d;e.La|=1<<b.fa;c>=b.mc-1&&(e.S[b.fa]|=1024);switch(a){case 1:e.Z|=512;e.A|=49152;break;case 2:e.Z|=2048,e.A|=49152}K(this.a,20,5,172,function(){e.S[b.fa]|=128;e.A=e.A&65534|128;return!!(e.A&64)})};l.kc=function(){this.b.ra|=128;this.b.ra&64&&K(this.a,0,6,64)};
function cb(a,b,c,d,f,e){var g=~~((e+c.oa-1)/c.oa),h=new XMLHttpRequest;2048>g&&d+2048<c.mc&&(g=2048);h.open("GET",c.url,!0);h.setRequestHeader("Range","bytes="+(d*c.oa<<1)+"-"+(((d+g)*c.oa<<1)-1));h.responseType="arraybuffer";h.onreadystatechange=function(){if(4==h.readyState){var g=b.bind(a),m,p,F,H;m=h.response;if(h.status&&206!=h.status||!m)c.qb(1,c,d,f,e);else{m=new Uint8Array(m);p=d;for(H=0;H<m.length;){if("undefined"===typeof c.cache[p])for(c.cache[p]=[],F=0;F<c.oa;F++)c.cache[p][F]=H<m.length?
m[H]&255|m[H+1]<<8&65280:0,H+=2;else H+=c.oa<<1;p++}g(c,d,f,e)}}};h.send(null)}function L(a,b,c,d,f){c&1?f?d=0<=d?d<<8&65280|b&255:b:M(a.a,4):0<=d?f&&(d=b&65280|d&255):d=b;return d}l.rb=function(a,b,c,d){for(var f;0<d;){if("undefined"===typeof a.cache[b]){cb(this,this.rb,a,b,c,d);return}for(f=0;f<a.oa&&0<d;f++){if(0>db(this.a,a.lc?eb(this.a,c):c,a.cache[b][f])){a.qb(2,a,b,c,d);return}c+=2;--d}b++}a.qb(0,a,b,c,d)};
function Za(a,b,c,d,f){for(var e,g;0<f;){if("undefined"===typeof b.cache[c])for(b.cache[c]=[],e=0;e<b.oa;e++)b.cache[c][e]=0;for(e=0;e<b.oa&&0<f;e++){g=a.a.tb(b.lc?eb(a.a,d):d);if(0>g){b.qb(2,b,c,d,f);return}b.cache[c][e]=g;d+=2;--f}c++}b.qb(0,b,c,d,f)}l.reset=function(){this.h.Ra=this.h.Ra&-120|20;this.f.ca=0;this.f.U=128;this.b.ra=0;this.i.v=128;this.l.s=128;ab(this)};
l.bc=function(a,b,c){var d,f,e=this.a;switch(a&-64){case 4194240:switch(a&-2){case 4194300:0>b?d=e.va&65280:(a&1&&(b<<=8),e.va=b|255,d=0);break;case 4194298:if(0>b)d=e.Gb;else{a&1&&(b<<=8);if(d=b&65024){f=d>>9;do d+=34;while(f>>=1)}e.Gb=d;e.ga=2}break;case 4194294:if(70!==e.Ia)return M(e,4);0>b?d=e.m:d=e.m=0;break;case 4194292:if(70!==e.Ia)return M(e,4);d=1;break;case 4194290:if(70!==e.Ia)return M(e,4);d=0;break;case 4194288:if(70!==e.Ia)return M(e,4);d=61183;break;case 4194296:0<=b&&!(a&1)&&(b&=
255);case 4194286:case 4194284:case 4194282:case 4194280:case 4194278:case 4194276:case 4194274:case 4194272:if(70!==e.Ia)return M(e,4);f=a-4194272>>1;0>b?d=e.Db[f]:(d=L(this,e.Db[f],a,b,c),0<=d&&(e.Db[f]=d));break;case 4194254:return a&1?e.N>>14&1?(0<=b&&(e.c[6]=b),d=e.c[6]):(0<=b&&(e.wa[3]=b),d=e.wa[3]):e.N>>14&0?(0<=b&&(e.c[6]=b),d=e.c[6]):(0<=b&&(e.wa[1]=b),d=e.wa[1]),d;case 4194252:case 4194250:case 4194248:return f=a&7,e.N&2048?(0<=b&&(e.c[f]=b),d=e.c[f]):(0<=b&&(e.Ka[f]=b),d=e.Ka[f]),d;case 4194246:return a&
1?(0<=b&&(e.c[7]=b),d=e.c[7]):e.N>>14&0?(0<=b&&(e.c[6]=b),d=e.c[6]):(0<=b&&(e.wa[0]=b),d=e.wa[0]),d;case 4194244:case 4194242:case 4194240:return f=a&7,e.N&2048?(0<=b&&(e.Ka[f]=b),d=e.Ka[f]):(0<=b&&(e.c[f]=b),d=e.c[f]),d;default:return e.m|=16,M(e,4)}break;case 4194176:f=a>>1&31;d=L(this,e.O[3][f],a,b,c);0<=d&&(e.O[3][f]=d,e.O[3][f&15]&=65295);break;case 4194112:var g=this.f;switch(a&-2){case 4194174:d=L(this,e.hb,a,b,c);0<=d&&(e.hb=d);break;case 4194172:d=e.Ca;d&65280&&(d=(d<<8|d>>8)&65535);break;
case 4194168:0>b?d=this.h.Bc&65535:(d=L(this,this.h.data,a,b,c),0<=d&&(this.h.data=d));break;case 4194166:0<=b&&(b&127&&(g.ec=0),g.U&=-129,K(e,100,4,52,function(){g.U|=128;return!!(g.U&64)}));d=0;break;case 4194162:d=0;0>b&&(g.ca&=-129,0<g.Fb.length&&(d=g.Fb.shift(),0<g.Fb.length&&setTimeout(function(){g.ca|=128;g.ca&64&&K(e,40,4,48)},50)));break;case 4194160:0>b?d=g.ca:(d=L(this,g.ca,a,b,c),0<=d&&(g.ca=g.ca&128|d&-129));break;default:return e.m|=16,M(e,4)}break;case 4194048:f=this.i;switch(a&-2){case 4194048:d=
L(this,f.cb,a,b,c);0<=d&&(f.cb=d);break;case 4194050:d=L(this,f.P,a,b,c);0<=d&&(f.P=d);break;case 4194052:d=L(this,f.v,a,b,c);0<=b&&0<=d&&(f.v=d&-36993|f.v&36992,f.v&1&&Ya(this));break;case 4194054:d=L(this,f.eb,a,b,c);0<=d&&(f.eb=d);break;case 4194056:d=L(this,f.bb,a,b,c);0<=d&&(f.bb=d);break;case 4194058:d=L(this,f.T,a,b,c);0<=d&&(f.T=d);break;case 4194060:break;case 4194062:d=L(this,f.Vb,a,b,c);0<=d&&(f.Vb=d);break;default:return e.m|=16,M(e,4)}break;case 4193728:var h=this.o;f=h.Z&7;switch(a&
-2){case 4193728:d=L(this,h.A,a,b,c);0<=b&&0<=d&&(h.xa=h.xa&60|d>>8&3,h.A=d&17279|h.A&34944|2048,d&1&&h.A&128?bb(this,f):192==(d&192)&&K(e,0,5,172));break;case 4193730:d=L(this,h.Ua,a,b,c);0<=d&&(h.Ua=d);break;case 4193732:d=L(this,h.Sa,a,b,c);0<=d&&(h.Sa=d&65534);break;case 4193734:d=L(this,h.$[f],a,b,c);0<=d&&(h.$[f]=d&7967);break;case 4193736:d=L(this,h.Z,a,b,c);0<=d&&(h.Z=d&63|h.Z&65472,d&128&&ab(this));break;case 4193738:d=h.S[f];break;case 4193740:d=h.Ta[f];break;case 4193742:d=L(this,h.La,
a,b,c);0<=d&&(h.La=d&255);break;case 4193744:d=h.zc[f];break;case 4193746:d=L(this,h.Wb,a,b,c);0<=d&&(h.Wb=d);break;case 4193748:d=L(this,h.Xb[f],a,b,c);0<=d&&(h.Xb[f]=d&1023);break;case 4193750:d=8210;break;case 4193752:d=h.Ac[f];break;case 4193754:d=L(this,h.Yb[f],a,b,c);0<=d&&(h.Yb[f]=d);break;case 4193756:d=L(this,h.ha[f],a,b,c);0<=d&&(h.ha[f]=d&511);break;case 4193758:h.ub[f]=h.ha[f];d=h.ub[f];break;case 4193760:d=h.xc[f];break;case 4193762:d=h.yc[f];break;case 4193764:d=h.vc[f];break;case 4193766:d=
h.wc[f];break;case 4193768:d=L(this,h.xa,a,b,c);0<=d&&(h.xa=d&63,h.A=h.A&-769|(d&3)<<8);break;case 4193770:d=L(this,h.Hb,a,b,c);0<=d&&(h.Hb=d);break;default:return e.m|=16,M(e,4)}break;case 4192512:f=this.l;switch(a&-2){case 4192512:d=L(this,f.s,a,b,c);0<=b&&0<=d&&(f.na=f.na&60|d>>4&3,f.s=f.s&-1023|d&1022,f.s&128||$a(this));break;case 4192514:d=L(this,f.Xa,a,b,c);0<=d&&(f.Xa=d&65534);break;case 4192516:d=L(this,f.G,a,b,c);0<=d&&(f.G=d);break;case 4192518:d=L(this,f.sa,a,b,c);0<=d&&(f.sa=d);break;
case 4192520:d=L(this,f.na,a,b,c);0<=d&&(f.na=d&63,f.s=f.s&-49|(f.na&3)<<4);break;default:return e.m|=16,M(e,4)}break;case 4191552:switch(a&-2){case 4191566:0>b?d=e.Da:(d=L(this,e.Da,a,b,c),0<=d&&(70!==e.Ia&&(d&=-49),e.Da=d,e.pb[0]=d&4?15:7,e.pb[1]=d&2?15:7,e.pb[3]=d&1?15:7,e.ob&&(f=2,e.Da&16&&(f=1),this.h.Ra=this.h.Ra&-8|f)));break;default:return e.m|=16,M(e,4)}break;case 4191424:f=a>>1&31;d=L(this,e.O[0][f],a,b,c);0<=d&&(e.O[0][f]=d,e.O[0][f&15]&=65295);break;case 4191360:f=a>>1&31;d=L(this,e.O[1][f],
a,b,c);0<=d&&(e.O[1][f]=d,e.O[1][f&15]&=65295);break;case 4190400:case 4190336:if(70!==e.Ia)return M(e,4);f=a>>2&31;d=e.fb[f];a&2&&(d>>=16);d&=65535;0<=b&&(d=L(this,d,a,b,c),0<=d&&(e.fb[f]=a&2?d<<16|e.fb[f]&65535:e.fb[f]&4294901760|d&65534));break;case 4188672:case 4188736:case 4188800:case 4188864:case 4188928:case 4188992:case 4189056:case 4189120:if(0>b)d=Ta[a>>1&255];else return e.m|=16,M(e,4);break;default:return e.m|=16,M(e,4)}c&&0<=d&&(a&1?d>>=8:d&=255);"undefined"===typeof d&&console.log("panic(76)");
return d};var fb={},Ua=(fb[65382]=[null,null,J.prototype.oc,J.prototype.Dc],fb[65402]=[null,null,J.prototype.pc,J.prototype.Ec],fb[65396]=[null,null,J.prototype.rc,J.prototype.Hc],fb[65534]=[null,null,J.prototype.qc,J.prototype.Fc],fb);w(function(){for(var a=D(document,"pdp11","device"),b=0;b<a.length;b++){var c=a[b],d=B(c),d=new J(d);C(d,c)}});var gb;if(Ga){var hb=new ArrayBuffer(2);(new DataView(hb)).setUint16(0,256,!0);gb=256===(new Uint16Array(hb))[0]}else gb=!1;var ib=gb;
function I(a,b,c,d,f){this.id=jb+=2;this.a=null;this.Qa=a;this.vb=b;this.size=c||0;this.type=d||kb;this.f=d==lb;this.controller=null;Ja(this);this.qa=this.fc=!1;if(c)if(f)this.controller=f,this.a=null,mb(this,f.Va);else if(Ga)this.u=new ArrayBuffer(c),this.j=new DataView(this.u,0,c),this.b=new Uint8Array(this.u,0,c),this.l=new Uint16Array(this.u,0,c>>1),this.a=new Int32Array(this.u,0,c>>2),mb(this,ib?nb:ob);else{this.a=Array(c>>2);for(a=0;a<this.a.length;a++)this.a[a]=0;mb(this,pb)}else mb(this)}
var kb=0,lb=2,Pa=4,Ra=["NONE","RAM","ROM","VID","H/W"],jb=0;
I.prototype={constructor:I,parent:null,Eb:function(a){this.Qa=a},save:function(){var a,b;if(this.controller)a=null;else if(Ga)for(a=Array(this.size>>2),b=0;b<a.length;b++)a[b]=this.j.getInt32(b<<2,!0);else a=this.a;return a},restore:function(a){if(this.controller)return!a;if(a&&this.size==a.length<<2){var b;if(Ga)for(b=0;b<a.length;b++)this.j.setInt32(b<<2,a[b],!0);else this.a=a;return this.qa=!0}return!1},o:function(){return 255},B:function(){},w:function(a,b){return this.ab(a++,b++)|this.ab(a,b)<<
8},C:function(a,b,c){this.gb(a++,b&255,c++);this.gb(a,b>>8,c)},X:function(a){return this.a[a>>2]>>>((a&3)<<3)&255},ka:function(a){var b=a>>2;a=(a&3)<<3;var c=this.a[b]>>a;return 24>a?c&65535:c&255|(this.a[b+1]&255)<<8},Ba:function(a,b){var c=a>>2;a=(a&3)<<3;this.a[c]=this.a[c]&~(255<<a)|b<<a;this.qa=!0},Pa:function(a,b){var c=a>>2;a=(a&3)<<3;24>a?this.a[c]=this.a[c]&~(65535<<a)|b<<a:(this.a[c]=this.a[c]&16777215|b<<24,c++,this.a[c]=this.a[c]&-256|b>>8);this.qa=!0},M:function(a,b){return this.V(a,
b)},ba:function(a,b){return this.ia(a,b)},za:function(a,b,c){this.f||this.ac(a,b,c)},Fa:function(a,b,c){this.f||this.Na(a,b,c)},J:function(a){return this.b[a]},W:function(a){return this.b[a]},Y:function(a){return this.j.getUint16(a,!0)},ja:function(a){return a&1?this.b[a]|this.b[a+1]<<8:this.l[a>>1]},la:function(a,b){this.b[a]=b;this.qa=!0},Aa:function(a,b){this.b[a]=b;this.qa=!0},Ea:function(a,b){this.j.setUint16(a,b,!0);this.qa=!0},Oa:function(a,b){a&1?(this.b[a]=b,this.b[a+1]=b>>8):this.l[a>>1]=
b;this.qa=!0}};function Ja(a,b,c){a.H=b;a.h=a.i=0;c&&((a.h=c.h)&&qb(a,rb,!1),(a.i=c.i)&&sb(a,rb,!1))}function sb(a,b,c){c&&a.i||(a.gb=!a.f&&b[1]||a.B,a.Gc=!a.f&&b[3]||a.C);if(c||void 0===c)a.ac=b[1]||a.B,a.Na=b[3]||a.C}function qb(a,b,c){c&&a.h||(a.ab=b[0]||a.o,a.sb=b[2]||a.w);if(c||void 0===c)a.V=b[0]||a.o,a.ia=b[2]||a.w}function mb(a,b){b||(b=tb);qb(a,b,void 0);sb(a,b,void 0)}
var tb=[],pb=[I.prototype.X,I.prototype.Ba,I.prototype.ka,I.prototype.Pa],rb=[I.prototype.M,I.prototype.za,I.prototype.ba,I.prototype.Fa];if(Ga)var ob=[I.prototype.J,I.prototype.la,I.prototype.Y,I.prototype.Ea],nb=[I.prototype.W,I.prototype.Aa,I.prototype.ja,I.prototype.Oa];
function ub(a,b){x.call(this,"CPU",a,ub);var c=a.multiplier||1;this.Ab=a.cycles||b;this.ka=c;this.zb=Math.round(this.Ab/1E4)/100;this.ia=this.zb*this.ka;this.g.ea=!1;this.g.Zb=!1;this.g.Wa=a.autoStart;this.g.Ob=!1;this.g.mb=!1;this.jb=this.ja=0;this.kb=a.csStart;this.Aa=a.csInterval;this.Ba=a.csStop;this.Na=[];this.Sb=this.Ib.bind(this);E(this)}z(ub);var vb=["power","reset"];l=ub.prototype;
l.Ja=function(a,b,c,d){this.h=a;this.j=b;this.H=d;for(b=0;b<vb.length;b++)(c=this.u[vb[b]])&&this.h.aa(null,vb[b],c);this.za=null;a=wb(a,"autoStart");null!=a&&(this.g.Wa="true"==a?!0:"false"==a?!1:!!a);E(this)};l.reset=function(){};l.save=function(){return null};l.restore=function(){return!1};l.ua=function(a,b){if(!b){if(a&&this.restore){xb(this);if(!this.restore(a))return!1;yb(this)}else this.reset();this.I("No debugger detected")}zb(this);return!0};l.ta=function(a){return a?this.save():!0};
l.Wa=function(){return this.g.Wa||void 0===this.u.run?(this.Ib(),!0):!1};l.Tb=function(){return 0};function yb(a){void 0===a.kb&&(a.kb=0);void 0===a.Aa&&(a.Aa=-1);void 0===a.Ba&&(a.Ba=-1);a.g.mb=0<=a.kb&&0<a.Aa;a.g.mb&&(a.jb=0,a.ja=a.kb-a.Y)}function N(a,b,c,d){if(a.u[b]){void 0===c&&(a.g.error=!0,a.K("Value for "+b+" is invalid"),O(a));var f=a.H&&a.H.b||8;c=!a.g.ea||a.g.Ob?8==f?n(c,d):q(c,d):"--------".substr(0,d||4);a.u[b].textContent!=c&&(a.u[b].textContent=c)}}
l.aa=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.u[b]=c;a=!0;break;case "run":this.u[b]=c;c.onclick=function(){var a;if(a=d.h)if(a=d.h,a.g.L)a=!0;else{var b=null,c,h=A(a.id);for(c=0;c<h.length&&(b=h[c],b===a||b.g.ready);c++);if(c==h.length)for(c=0;c<h.length&&(b=h[c],b===a||b.g.L);c++);c==h.length&&(b=a);u("The "+b.type+" component ("+b.id+") is not "+(b.g.ready?"powered yet":"ready yet"+(b.nb?" (waiting for notification)":""))+".");a=!1}a&&(d.g.ea?O(d):d.Ib())};a=!0;
break;case "speed":this.u[b]=c;a=!0;break;case "setSpeed":this.u[b]=c,c.onclick=function(){Ab(d,d.ka<<1)},c.textContent=this.ia.toFixed(2)+"Mhz",a=!0}return a};function Bb(a,b,c){a.Y+=b;c&&(a.X=a.a=0)}function Cb(a,b){var c=1;b&&1<a.ka&&a.V&&(c=a.V/a.zb);a.Qb=Math.round(1E3/30);a.lb=Math.floor(a.Ab/30*c);b||(a.Ea=a.lb);a.wb=0}function Db(a){return a.Y+a.M+a.X-a.a}function xb(a){a.V=0;a.Rb=0;a.Y=a.M=a.X=a.a=0;yb(a);Ab(a,1)}
function Ab(a,b){if(void 0!==b&&(.8>a.V/a.ia&&(b=1),a.ka=b,b=a.zb*a.ka,a.ia!=b)){a.ia=b;b=a.ia.toFixed(2)+"Mhz";var c=a.u.setSpeed;c&&(c.textContent=b);a.I("target speed: "+b)}Bb(a,a.M);a.M=0;a.J=ga();a.W=0;Cb(a)}
l.Ib=function(){if(Ea(this,!0)){if(!this.g.ea){Ab(this);this.h&&this.h.start(this.J,Db(this));this.g.ea=!0;this.g.Zb=!0;this.za&&this.za.start();var a=this.u.run;a&&(a.textContent="Halt");this.h&&this.h.Ma(!0)}this.wb>=this.Ab&&Cb(this,!0);this.Fa=0;this.ib=ga();this.W&&(a=this.ib-this.W,a>this.Qb&&(this.J+=a,this.J>this.ib&&(this.J=this.ib)));try{do{for(var b,c=this.g.mb?1:this.lb,d=this.Na.length-1;0<=d;d--){var f=this.Na[d];0>f[0]||c>f[0]&&(c=f[0])}b=c;try{this.$b(b)}catch(m){if("number"!=typeof m)throw m;
}for(var e=this.X-this.a,a=e,g=this.Na.length-1;0<=g;g--){var h=this.Na[g];0>h[0]||(h[0]-=a,0>=h[0]&&(h[0]=-1,h[1]()))}this.Fa+=e;this.M+=e;Bb(this,0,!0);a=e;if(this.g.mb){var k=!1;this.jb=this.jb+this.Tb()|0;this.ja-=a;0>=this.ja&&(this.ja+=this.Aa,k=!0);0<=this.Ba&&this.Ba<=Db(this)&&(this.Aa=this.Ba=-1,yb(this),O(this),k=!0);k&&this.I(Db(this)+" cycles: checksum="+q(this.jb))}this.Ea-=e;if(0>=this.Ea){this.Ea+=this.lb;15<=++this.Rb&&(this.h&&this.h.Ma(),this.Rb=0);break}}while(this.g.ea)}catch(m){O(this);
zb(this);this.h&&this.h.stop(ga(),Db(this));Ea(this,!1);b=m.stack||m.message;this.g.error=!0;this.K(b);return}b=setTimeout;c=this.Sb;this.W=ga();d=this.Qb;this.Fa&&(d=Math.round(d*this.Fa/this.lb));d-=this.W-this.ib;if(f=this.W-this.J)this.V=Math.round(this.M/(10*f))/100,864E5<=f&&(this.Y=0,Ab(this));if(0>d||this.V<this.ia)-1E3>d&&(this.J-=d),d=0;this.wb+=this.Fa;this.W+=d;b(c,d)}else zb(this),this.h&&this.h.stop(ga(),Db(this))};l.$b=function(){return 0};
function O(a){a.g.Ya&&(a.g.Bb=!0);a.X-=a.a;a.a=0;Bb(a,a.M);a.M=0;if(a.g.ea){a.g.ea=!1;a.za&&a.za.stop();var b=a.u.run;b&&(b.textContent="Run")}a.g.complete=void 0}function zb(a){a.h&&a.h.Ma(void 0)}
function Eb(a){this.jc=a.resetAddr||0;ub.call(this,a,1E6);this.Kb=0;this.decode=Fb.bind(this);this.C=65536;this.l=32768;this.o=65535;this.i=32768;this.c=[0,0,0,0,0,0,0,this.jc];this.Ka=[0,0,0,0,0,0];this.wa=[0,0,0,0];this.Pa=this.B=0;this.O=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,65535,65535,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];this.fb=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.Db=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.b=-1;this.D=0;this.Ia=70;this.la=-1;this.Ub=0;Gb(this);this.g.complete=this.g.dc=!1}z(Eb,ub);l=Eb.prototype;l.reset=function(){this.g.ea&&O(this);Gb(this);xb(this);this.g.error=!1;this.parent.reset.call(this)};
function Gb(a){a.va=255;a.m=0;a.Gb=0;a.w=0;a.Ca=0;a.hb=0;a.Da=0;a.ob=0;a.Oa=0;a.pb=[7,7,7,7];a.f=[];a.ga=2;Va(a)}function Va(a){a.ob?(a.Jb=65536,a.ba=a.hc,a.sb=a.da):(a.Jb=0,a.ba=a.gc,a.sb=a.tb)}l.Tb=function(){return 0};l.save=function(){var a=new P(this);a.set(0,[]);a.set(1,[this.Y,this.ka]);a.set(2,Sa(this.j));return a.data()};
l.restore=function(a){var b=a[1];this.Y=b[1];Ab(this,b[3]);a:{b=this.j;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],f=a[c+1];if(f&&f.length<b.C){for(var e=0,g=Array(b.C),h=0;h<f.length-1;)for(var k=f[h++],m=f[h++];k--;)g[e++]=m;f=g}e=b.b[d];if(!e||!e.restore(f)){u("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
l.aa=function(a,b,c){switch(b){case "R0":case "R1":case "R2":case "R3":case "R4":case "R5":case "R6":case "R7":case "NF":case "ZF":case "VF":case "CF":case "PS":this.u[b]=c;this.Kb++;a=!0;break;default:a=this.parent.aa.call(this,a,b,c)}return a};
l.Ma=function(a){if(this.Kb&&(a||!this.g.ea||this.g.Ob)){for(a=0;a<this.c.length;a++)N(this,"R"+a,this.c[a]);a=Wa(this);N(this,"PS",a);N(this,"NF",a&8?1:0,1);N(this,"ZF",a&4?1:0,1);N(this,"VF",a&2?1:0,1);N(this,"CF",a&1?1:0,1)}if(a=this.u.speed)a.textContent=this.g.ea&&this.V?this.V.toFixed(2)+"Mhz":"Stopped"};
function K(a,b,c,d,f){for(var e=a.f.length;0<e--;)if(a.f[e].Cc===d){0<e&&(a.f[e-1].pa+=a.f[e].pa);a.f.splice(e,1);break}if(0<=b){2===a.Ub&&(b=0,a.Ub=0,setTimeout(a.Sb,0));for(e=a.f.length;0<e--;){if(a.f[e].pa>b){a.f[e].pa-=b;break}b-=a.f[e].pa}a.f.splice(e+1,0,{delay:b,priority:c<<5&224,vector:d,callback:f})}a.ga=2}function Wa(a){return a.N=a.N&63728|(a.i&32768?8:0)|(a.o&65535?0:4)|(a.l&32768?2:0)|(a.C&65536?1:0)}
function Xa(a,b){a.i=b<<12;a.o=~b&4;a.l=b<<14;a.C=b<<16;if((b^a.N)&2048)for(var c=a.Ka.length;0<=--c;){var d=a.c[c];a.c[c]=a.Ka[c];a.Ka[c]=d}a.B=b>>14&3;c=a.N>>14&3;a.B!=c&&(a.wa[c]=a.c[6],a.c[6]=a.wa[a.B]);a.ga=2;a.N=b}function Hb(a,b){a.D&128||(a.i=a.o=a.C=b,a.l=0)}function Q(a,b){a.D&128||(a.i=a.o=b,a.l=0)}function Ib(a,b,c,d){a.D&128||(a.i=a.o=a.C=b,a.l=(c^d)&(d^b))}
function M(a,b){var c=!1;0>a.la?a.la=Wa(a):a.B||(b=4,c=!0);a.w&57344||(a.Ca=63222,a.hb=b);a.B=0;var d=a.da(b|65536),f=a.da(b+2&65535|65536);Xa(a,f&53247|a.la>>2&12288);c&&(a.m|=4,a.c[6]=4);Jb(a,a.la);Jb(a,a.c[7]);a.c[7]=d;a.D&=-113;a.la=-1;throw b;}function eb(a,b){var c=b>>13&31;31>c?a.Da&32&&(b=a.fb[c]+(b&8190)&4194302,3932160<=b&&4186112>b&&console.log("panic(898)")):b|=4186112;return b}
function Kb(a,b,c){var d,f,e,g=0;if(c&a.ob){d=b>>13&a.pb[a.B];f=a.O[a.B][d];e=(a.O[a.B][d+16]<<6)+(b&8191)&4194303;a.Da&16?3932160<=e&&4186112>e&&(e=eb(a,e&262143)):(e&=262143,253952<=e&&(e|=4186112));3932160>e&&(3915776<=e&&(a.m|=32,M(a,4)),e&1&&!(c&1)&&(a.m|=64,M(a,4)));switch(f&7){case 1:g=4096;case 2:f|=128;c&4&&(g=8192);break;case 4:g=4096;case 5:c&4&&(g=4096);case 6:f|=c&4?192:128;break;default:g=32768}32512!==(f&32520)&&(f&8?f&32512&&(b&8128)<(f>>2&8128)&&(g|=16384):(b&8128)>(f>>2&8128)&&(g|=
16384));a.O[a.B][d]=f;if(4194170!==e||a.B)a.Oa=a.B,a.Pa=d;g&&(g&57344&&(0<=a.la&&(g|=128),a.w&57344||(a.w=a.w|g|a.Oa<<5|a.Pa<<1),M(a,168)),a.w&61440||!(4191360>e||4194239<e)||(a.w|=4096,a.w&512&&(a.D|=32)))}else e=b&65535,57344<=e?e|=4186112:e&1&&!(c&1)&&(a.m|=64,M(a,4));return e}l.tb=function(a){if(4194304<=a)a=this.c[a-4194304];else if(0<=a){var b=this.j,c=a&b.h,d=(a&b.i)>>>b.j;a=c!=b.h?b.b[d].sb(c,a):b.b[d++].ab(c,a)|b.b[d&b.J].ab(0,a+1)<<8}return a};l.da=function(a){return this.tb(Kb(this,a,2))};
function db(a,b,c){c&=65535;if(4194304<=b)return a.c[b-4194304]=c;if(0<=b){a=a.j;var d=c,f=b&a.h,e=(b&a.i)>>>a.j;f!=a.h?a.b[e].Gc(f,d&65535,b):(a.b[e++].gb(f,d&255,b),a.b[e&a.J].gb(0,d>>8&255,b+1));return c}return b}function Lb(a,b){4194304<=b?b=a.c[b-4194304]&255:0<=b&&(a=a.j,b=a.b[(b&a.i)>>>a.j].ab(b&a.h,b));return b}function Mb(a,b,c){c&=255;4194304<=b?a.c[b-4194304]=a.c[b-4194304]&65280|c:0<=b&&(a=a.j,a.b[(b&a.i)>>>a.j].gb(b&a.h,c&255,b))}
function Jb(a,b){var c=a.c[6]-2&65535;a.c[6]=c;a.w&57344||(a.Ca=a.Ca<<8|246);!a.B&&c<=a.va&&4<c&&(c<=a.va-32?(a.m|=4,a.c[6]=4,M(a,4)):(a.m|=8,a.D|=4));c=Kb(a,c|65536,4);db(a,c,b)}
function Nb(a,b,c){var d,f,e=b&7,g=c&8?0:a.Jb;switch(b>>3&7){case 0:M(a,4);break;case 1:return 6===e&&!a.B&&c&4&&(a.c[6]<=a.va||65534<=a.c[6])&&(a.c[6]<=a.va-32||65534<=a.c[6]?(a.m|=4,a.c[6]=4,M(a,4)):(a.m|=8,a.D|=64)),7===e?a.c[e]:a.c[e]|g;case 2:f=2;d=a.c[e];7!==e&&(d|=g,6>e&&c&1&&(f=1));break;case 3:f=2;d=a.c[e];7!==e&&(d|=g);if(0>(d=a.da(d)))return d;d|=g;break;case 4:f=-2;6>e&&c&1&&(f=-1);d=a.c[e]+f&65535;7!==e&&(d|=g);break;case 5:f=-2;d=a.c[e]-2&65535;7!==e&&(d|=g);if(0>(d=a.da(d)))return d;
d|=g;break;case 6:if(0>(d=a.da(a.c[7])))return d;a.c[7]=a.c[7]+2&65535;d=d+a.c[e]&65535;return d|g;case 7:if(0>(d=a.da(a.c[7])))return d;a.c[7]=a.c[7]+2&65535;d=d+a.c[e]&65535;return 0>(d=a.da(d|65536))?d:d|g}a.c[e]=a.c[e]+f&65535;!g||a.w&57344||(a.Ca=a.Ca<<8|f<<3&248|e);6===e&&!a.B&&c&4&&0>=f&&(a.c[6]<=a.va||65534<=a.c[6])&&(a.c[6]<=a.va-32?(a.m|=4,a.c[6]=4,M(a,4)):(a.m|=8,a.D|=64));return d}l.gc=function(a,b){return Nb(this,a,b)};l.hc=function(a,b){return Kb(this,Nb(this,a,b),b)};
function R(a,b){return b&56?a.sb(Nb(a,b,2)):a.c[b&7]}function S(a,b){return b&56?Lb(a,a.ba(b,3)):a.c[b&7]&255}function Ob(a,b,c,d){b&56?(b=a.ba(b,6),db(a,b,d.call(a,c,a.tb(b)))):(b&=7,a.c[b]=d.call(a,c,a.c[b])&65535)}function Pb(a,b,c,d){b&56?(b=a.ba(b,7),Mb(a,b,d.call(a,c,Lb(a,b)))):(b&=7,a.c[b]=a.c[b]&65280|d.call(a,c,a.c[b])&255)}function Qb(a,b,c){b&56?db(a,a.ba(b,4),c):a.c[b&7]=c&65535;return c}
function Rb(a,b,c,d){b&56?Mb(a,a.ba(b,5),c):(b&=7,a.c[b]=c?d&1?c<<24>>24&65535:a.c[b]&-256|c&255:a.c[b]&-256);return c}function T(a,b){return a.c[7]+(b<<24>>23)&65535}
l.$b=function(a){this.g.complete=!0;this.g.dc=!1;this.g.Zb=!1;this.X=this.a=a;do{this.D&112&&(this.D&32?M(this,168):this.D&64?M(this,4):this.D&16&&M(this,12),this.D&=-113);if(this.ga)if(1==this.ga)this.ga=2;else{this.ga=0;a=null;for(var b=this.Gb&224,c=this.f.length;0<=--c;){if(0<this.f[c].pa){this.f[c].pa--;this.ga=2;break}if(this.f[c].Mb){if(!this.f[c].Mb()){this.f.splice(c,1);continue}this.f[c].Mb=null}this.f[c].nc>b&&(b=this.f[c].nc,a=this.f[c],this.f.splice(c,1))}b>(this.N&224)&&(a?M(this,a.Cc):
M(this,160))}this.w&57344||(this.Ca=0,this.hb=this.c[7]);this.D=this.N&16;a=this.b=this.da(this.c[7]);0<=a&&(this.c[7]=this.c[7]+2&65535);this.decode(a);if(0>this.b){this.c[7]=this.c[7]-2&65535;this.I("unimplemented");break}}while(0<this.a);return this.g.complete?this.X-this.a:void 0===this.g.complete?0:-1};w(function(){for(var a=D(document,"pdp11","cpu"),b=0;b<a.length;b++){var c=a[b],d=B(c),d=new Eb(d);C(d,c)}});
function Sb(a,b){var c=a+b;this.D&128||(this.i=this.o=this.C=c,this.l=(a^c)&(b^c));return c&65535}function Tb(a,b){a=~a&b;Q(this,a);return a}function Ub(a,b){a=~a&b;Q(this,a<<8);return a}function Vb(a,b){a|=b;Q(this,a);return a}function Wb(a,b){a|=b;Q(this,a<<8);return a}function Xb(a,b){var c=b-a;Ib(this,c,a,b);return c&65535}function Yb(){this.b=-1;--this.a}function Zb(){this.b=-1;--this.a}function U(a){a&1&&(this.C=0);a&2&&(this.l=0);a&4&&(this.o=1);a&8&&(this.i=0);--this.a}
function $b(){this.b=-1;--this.a}function ac(a){var b=Nb(this,a,8);a=a>>6&7;Jb(this,this.c[a]);this.c[a]=this.c[7];this.c[7]=b;--this.a}function bc(){this.b=-1;--this.a}function cc(){--this.a}function V(a){a&1&&(this.C=65536);a&2&&(this.l=32768);a&4&&(this.o=0);a&8&&(this.i=32768);--this.a}function dc(){this.b=-1;--this.a}function ec(){this.b=-1;--this.a}function W(){M(this,8)}function Fb(a){fc[a>>12].call(this,a)}
var fc=[function(a){gc[a>>8&15].call(this,a)},function(a){Q(this,Qb(this,a,R(this,a>>6)));--this.a},function(a){var b=R(this,a>>6);a=R(this,a);Ib(this,b-a,a,b);--this.a},function(a){Q(this,R(this,a>>6)&R(this,a));--this.a},function(a){Ob(this,a,R(this,a>>6),Tb);--this.a},function(a){Ob(this,a,R(this,a>>6),Vb);--this.a},function(a){Ob(this,a,R(this,a>>6),Sb);--this.a},function(a){hc[a>>8&15].call(this,a)},function(a){ic[a>>8&15].call(this,a)},function(a){var b=S(this,a>>6);Q(this,Rb(this,a,b,1)<<8);
--this.a},function(a){var b=S(this,a>>6)<<8;a=S(this,a)<<8;Ib(this,b-a,a,b);--this.a},function(a){Q(this,(S(this,a>>6)&S(this,a))<<8);--this.a},function(a){Pb(this,a,S(this,a>>6),Ub);--this.a},function(a){Pb(this,a,S(this,a>>6),Wb);--this.a},function(a){Ob(this,a,R(this,a>>6),Xb);--this.a},W],gc=[function(a){jc[a>>4&15].call(this,a)},function(a){this.c[7]=T(this,a);--this.a},function(a){this.o&65535&&(this.c[7]=T(this,a));--this.a},function(a){this.o&65535||(this.c[7]=T(this,a));--this.a},function(a){!(this.i&
32768)==!(this.l&32768)&&(this.c[7]=T(this,a));--this.a},function(a){!(this.i&32768)!=!(this.l&32768)&&(this.c[7]=T(this,a));--this.a},function(a){this.o&65535&&!(this.i&32768)==!(this.l&32768)&&(this.c[7]=T(this,a));--this.a},function(a){this.o&65535&&!(this.i&32768)==!(this.l&32768)||(this.c[7]=T(this,a));--this.a},ac,ac,function(a){kc[a>>6&3].call(this,a)},function(a){lc[a>>6&3].call(this,a)},function(a){mc[a>>6&3].call(this,a)},function(a){nc[a>>6&3].call(this,a)},W,W],jc=[function(a){oc[a&15].call(this,
a)},W,W,W,W,W,W,W,function(a){var b=this.da(this.c[6]|65536);0<=b&&(this.c[6]=this.c[6]+2&65535);a&=7;this.c[7]=this.c[a];this.c[a]=b;--this.a},function(a){this.N&49152||(this.N=this.N&-2017|(a&7)<<5,this.ga=1);--this.a},function(a){pc[a&15].call(this,a)},function(a){qc[a&15].call(this,a)},W,W,W,W],pc=[cc,function(){this.C=0;--this.a},function(){this.l=0;--this.a},U,function(){this.o=1;--this.a},U,U,U,function(){this.i=0;--this.a},U,U,U,U,U,U,U],qc=[cc,function(){this.C=65536;--this.a},function(){this.l=
32768;--this.a},V,function(){this.o=0;--this.a},V,V,V,function(){this.i=32768;--this.a},V,V,V,V,V,V,V],oc=[function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.N&49152||(Gb(this),this.j.reset());--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},W,W,W,W,W,W,W,W],hc=[bc,bc,$b,$b,Yb,Yb,Zb,Zb,ec,ec,W,W,W,W,dc,dc],ic=[function(a){this.i&32768||(this.c[7]=T(this,a));
--this.a},function(a){this.i&32768&&(this.c[7]=T(this,a));--this.a},function(a){this.C&65536||!(this.o&65535)||(this.c[7]=T(this,a));--this.a},function(a){if(this.C&65536||!(this.o&65535))this.c[7]=T(this,a);--this.a},function(a){this.l&32768||(this.c[7]=T(this,a));--this.a},function(a){this.l&32768&&(this.c[7]=T(this,a));--this.a},function(a){this.C&65536||(this.c[7]=T(this,a));--this.a},function(a){this.C&65536&&(this.c[7]=T(this,a));--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;
--this.a},function(a){rc[a>>6&3].call(this,a)},function(a){sc[a>>6&3].call(this,a)},function(a){tc[a>>6&3].call(this,a)},function(a){uc[a>>6&3].call(this,a)},W,W],kc=[function(a){Hb(this,Qb(this,a,0));--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}],lc=[function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}],mc=[function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=
-1;--this.a},function(){this.b=-1;--this.a}],nc=[function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}],rc=[function(a){Hb(this,Rb(this,a,0));--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}],sc=[function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}],tc=[function(){this.b=-1;--this.a},function(){this.b=-1;
--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}],uc=[function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a},function(){this.b=-1;--this.a}];
function X(a){x.call(this,"ROM",a,X);this.b=null;this.o=a.addr;this.f=a.size;this.w=a.writable;this.h=a.alias;this.i=a.file;this.B=ba(this.i);if(this.i){a=this.i;var b=ca(this.B);"json"!=b&&"hex"!=b&&(a=r()+"/api/v1/dump?file="+this.i+"&format=bytes&decimal=true");var c=this;t(a,null,!0,function(a,b,e){vc(c,a,b,e)})}}z(X);X.prototype.Ja=function(a,b,c,d){this.j=b;this.a=c;this.H=d;wc(this)};X.prototype.ua=function(){this.l&&(this.H&&this.H.a(this.id,this.o,this.f,this.l),delete this.l);return!0};
X.prototype.ta=function(){return!0};
function vc(a,b,c,d){if(d)a.K("Unable to load system ROM (error "+d+": "+b+")");else{Ca(a.Nb,b,c);var f;if("["==c.charAt(0)||"{"==c.charAt(0))try{var e,g,h=eval("("+c+")");if(e=h.bytes)a.b=e;else if(e=h.words)for(a.b=Array(2*e.length),g=f=0;f<e.length;f++)a.b[g++]=e[f]&255,a.b[g++]=e[f]>>8&255;else if(e=h.data)for(a.b=Array(4*e.length),g=f=0;f<e.length;f++)a.b[g++]=e[f]&255,a.b[g++]=e[f]>>8&255,a.b[g++]=e[f]>>16&255,a.b[g++]=e[f]>>24&255;else a.b=h;a.l=h.symbols;if(!a.b.length){u("Empty ROM: "+b);
return}if(1==a.b.length){u(a.b[0]);return}}catch(k){a.K("ROM data error: "+k.message);return}else for(b=c.replace(/\n/gm," ").replace(/ +$/,"").split(" "),a.b=Array(b.length),f=0;f<b.length;f++)a.b[f]=aa(b[f]);wc(a)}}
function wc(a){if(!Fa(a))if(!a.i)E(a);else if(a.b&&a.j){a.f||(a.f=a.b.length);if(a.b.length!=a.f){var b="ROM size ("+q(a.b.length,8,!0)+") does not match specified size ("+q(a.f,8,!0)+")";a.g.error=!0;a.K(b)}else{b=a.o;if(Oa(a.j,b,a.f,a.w?1:lb)){var c;for(c=0;c<a.b.length;c++){var d=a.j,f=b+c;d.b[(f&d.i)>>>d.j].ac(f&d.h,a.b[c]&255,f)}b=!0}else b=!1;if(b){b=[];"number"==typeof a.h?b.push(a.h):null!=a.h&&a.h.length&&(b=a.h);for(c=0;c<b.length;c++){for(var e=a,d=b[c],f=e.j,g=e.f,h=[],k=e.o>>>f.j;0<g&&
k<f.b.length;)h.push(f.b[k++]),g-=f.f;f=e.j;e=e.f;g=0;for(d>>>=f.j;0<e&&d<f.b.length;){k=h[g++];if(!k)break;f.b[d++]=k;e-=f.f}}delete a.b}}E(a)}}w(function(){for(var a=D(document,"pdp11","rom"),b=0;b<a.length;b++){var c=a[b],d=B(c),d=new X(d);C(d,c)}});function xc(a){x.call(this,"RAM",a,xc);this.h=a.addr;this.f=a.size;this.b=!1}z(xc);l=xc.prototype;l.Ja=function(a,b,c,d){this.j=b;this.a=c;this.H=d;E(this)};l.ua=function(a,b){b||this.reset();return!0};l.ta=function(a){return a?this.save():!0};
l.reset=function(){!this.b&&this.f&&Oa(this.j,this.h,this.f,1)&&(this.b=!0);this.b||u("No RAM allocated")};l.save=function(){return null};l.restore=function(){return!0};w(function(){for(var a=D(document,"pdp11","ram"),b=0;b<a.length;b++){var c=a[b],d=B(c),d=new xc(d);C(d,c)}});function yc(a){x.call(this,"Keyboard",a,yc);E(this)}z(yc);yc.prototype.aa=function(){return!1};yc.prototype.Ja=function(a,b,c,d){this.h=a;this.a=c;this.H=d;this.za=null};
w(function(){for(var a=D(document,"pdp11","keyboard"),b=0;b<a.length;b++){var c=a[b],d=B(c),d=new yc(d);C(d,c)}});
function zc(a,b,c){x.call(this,"Computer",a,zc);this.g.L=!1;Ac(this,b);this.J=wb(this,"autoPower",a);this.h=0;this.Y=a.busWidth||a.buswidth;this.b=Y;this.B=null;this.o=this.W=!1;this.url=wb(this,"url")||"";(Math.random()+.1).toString(36);this.f=Bc(this);if(this.a=Da("CPU",this.id)){this.H=Da("Debugger",this.id);this.j=new G({id:this.Nb+".bus",busWidth:this.Y},this.a,this.H);var d,f=A(this.id);if((this.i=Da("Panel",this.id))&&this.i.Cb)for(b=0;b<f.length;b++)d=f[b],d.K=this.i.K,d.I=this.i.I,d.Cb=this.i.Cb;
this.I("PDP11js v1.30.0\nCopyright \u00a9 2012-2016 Jeff Parsons <Jeff@pcjs.org>\nLicense: GPL version 3 or later <http://gnu.org/licenses/gpl.html>");this.I("Portions adapted from the PDP-11/70 Emulator v1.3 by Paul Nankervis <paulnank@hotmail.com>");for(b=0;b<f.length;b++)d=f[b],d.Ja&&d.Ja(this,this.j,this.a,this.H);b=null;d=a.resume;void 0!==d&&(1<d.length?b=this.w=d:this.b=parseInt(d,10));var e;if(a=wb(this,"state")||(e=!0,a.state))b=this.M=a,e||(this.o=!0,this.b=Y),this.b&&(this.C=new P(this,
"1.30.0"),Z(this.C)?b=null:delete this.C);!b&&this.b&&(b=Cc(this))&&(this.o=!0);if(b){var g=this;t(b,null,!0,function(a,b,c){c?(g.w=null,g.o=!1,g.K("Unable to load machine state from server (error "+c+(b?": "+(String.prototype.trim?b.trim():b.replace(/^\s+|\s+$/g,"")):"")+")")):(g.B=b,g.W=!0);E(g)})}else E(this);this.u.power||(this.J=!0);!c&&this.J&&Dc(this,this.$a)}else u("Unable to find CPU component")}z(zc);var Y=0;
function Ac(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){u(d.message+" ("+c+")")}}a.X=b}function wb(a,b,c){var d=b.toLowerCase(),d=wa[b]||wa[d];void 0===d&&a.X&&(d=a.X[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}function Dc(a,b,c){for(var d=A(a.id),f=0;f<=d.length;f++){var e=f<d.length?d[f]:a;if(!Fa(e)){Fa(e,function(){Dc(a,b,c)});return}}b.call(a,c)}
function Ec(a,b){var c=new P(a,"1.30.0","validate");if(Z(c)&&Fc(c)){var d=c.get("timestamp"),f=b?b.get("timestamp"):"unknown";d!=f&&(a.K("Machine state may be out-of-date\n("+d+" vs. "+f+")\nCheck your browser's local storage limits"),b||c.clear())}}l=zc.prototype;
l.$a=function(a){void 0===a&&(a=this.b||(this.B?1:Y));if(!this.h){this.h++;var b=!1,c=!1;this.V=!1;var d=this.C||new P(this,"1.30.0");if(-1==a)b=!0;else if(a>Y){if(Z(d,this.B)){this.l=new P(this,"1.30.0","failsafe");Z(this.l)&&(Gc(this,d),a=2,Hc(this.l));this.l.set("timestamp",ha());Ic(this.l);var f=this.b&&!this.o;if(1==a||ia("Click OK to restore the previous PDP11js machine state, or CANCEL to reset the machine.")){if(c=Fc(d)){var e=d.get("code"),g=d.get("data");e&&("ok"==e?Z(d,g):("error"==e&&
"no machine state"!=g?(this.K("Error: "+g),"unable to verify user"==g&&(ma("user",""),this.f=null)):this.I(e+": "+g),Hc(d),Z(d)?(c=Fc(d),f=!0):c=!1))}f&&Ec(this,c?d:null)}else 2==a&&d.clear()}else Ec(this);delete this.B;delete this.C}f=A(this.id);for(e=0;e<f.length;e++)g=f[e],g!==this&&g!=this.a&&(c=Jc(this,g,d,b,c));b=[d,a,c];-1!=a?Dc(this,this.Pb,b):this.Pb(b)}};
function Jc(a,b,c,d,f){if(!b.g.L){b.g.L=!0;if(b.ua){var e=null;f&&((e=c.get(b.id))||(e=c.get(b.id.replace(/[a-z0-9]\./i,"."))));"string"===typeof e&&(e=null);!b.ua(e,d)&&e&&(u("Unable to restore state for "+b.type),a.M&&!a.W?(c.clear(),a.b=Y,window&&window.location.reload()):a.V=!0,b.ua(null),f=!1)}if(!d&&b.Lb)for(a=b.Lb.split("|"),c=0;c<a.length;c++)b.status(a[c])}return f}
l.Pb=function(a){var b=a[0],c=0>a[1];a=a[2];this.ba=!0;this.g.L=!0;var d=this.u.power;d&&(d.textContent="Shutdown");this.a&&(Jc(this,this.a,b,c,a),this.a.Wa());this.V&&(Gc(this,b),b.clear());!c&&this.l&&(this.l.clear(),delete this.l);this.h=0};
function Gc(a,b){if(ia("There may be a problem with your PDP11js machine.\n\nTo help us diagnose it, click OK to send this PDP11js machine state to http://www.pcjs.org.")){var c=a.f||"";b=b.toString();var d={app:"PDP11js",ver:"1.30.0"};d.url=a.url;d.user=c;d.type="bug";d.data=b;t("http://www.pcjs.org/api/v1/report",d,!0)}}
function Kc(a,b,c){var d,f="none";if(a.h)return null;a.h--;var e=new P(a,"1.30.0"),g=new P(a,"1.30.0","validate"),h=ha();g.set("timestamp",h);e.set("timestamp",h);e.set("version","1.30.0");e.set("url",window?window.location.href:null);e.set("browser",window?window.navigator.userAgent:"");a.a&&a.a.ta&&(c&&O(a.a),d=a.a.ta(b,c),"object"===typeof d&&e.set(a.a.id,d),c&&(a.a.g.L=!1,!1===d&&(f=null)));for(var h=A(a.id),k=0;k<h.length;k++){var m=h[k];m.g.L&&(m.ta&&(d=m.ta(b,c),"object"===typeof d&&e.set(m.id,
d)),c&&(m.g.L=!1,!1===d&&(f=null)))}f&&(c?(h=d=!1,b?(a.f&&Lc(a,a.f,e.toString()),Ic(g)&&Ic(e)||(f=null,d=h=!0)):a.b&&(d=!0,h=3==a.b),d&&e.clear(h)):f=e.toString());c&&(a.g.L=!1,b=a.u.power)&&(b.textContent="Power");a.h=0;return f}l.reset=function(){this.j&&this.j.reset&&this.j.reset();for(var a=A(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.j&&c.reset&&c.reset()}};l.start=function(a,b){for(var c=A(this.id),d=0;d<c.length;d++){var f=c[d];"CPU"!=f.type&&f!==this&&f.start&&f.start(a,b)}};
l.stop=function(a,b){for(var c=A(this.id),d=0;d<c.length;d++){var f=c[d];"CPU"!=f.type&&f!==this&&f.stop&&f.stop(a,b)}};
l.aa=function(a,b,c){var d=this;switch(b){case "power":return this.u[b]=c,c.onclick=function(){d.h||(d.g.L?Kc(d,!1,!0):Dc(d,d.$a))},!0;case "reset":return this.u[b]=c,c.onclick=function(){if(d.g.L&&!d.h)if(d.b&&!d.w){var a=ia("Click OK to save changes to this PDP11js machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");Kc(d,a,!0);!a&&d.M?window&&window.location.reload():d.$a(Y)}else d.reset(),d.a&&d.a.Wa()},!0;case "save":if(da())c.parentNode.removeChild(c);else return this.u[b]=
c,c.onclick=function(){var a=Bc(d,!0);if(a){var b=!!(d.b&&!d.w||d.M),c=Kc(d,b);b?Lc(d,a,c):d.K("Resume disabled, machine state not saved")}},!0}return!1};
function Bc(a,b){var c=a.f;c||((c=la("user"),void 0!==c)?!c&&b&&(b=null,window&&(b=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c=b)&&((c=Mc(a,c))||a.K("The user ID is invalid.")):b&&a.K("Browser local storage is not available"));return c}
function Mc(a,b){a.f=null;b=t(r()+"/api/v1/user?req=verify&user="+b);var c=b[1];if(!b[0]&&c)try{b=eval("("+c+")"),b.code&&"ok"==b.code&&(ma("user",b.data),a.f=b.data)}catch(d){u(d.message+" ("+c+")")}return a.f}function Cc(a){var b=null;a.f&&(b=r()+"/api/v1/user?req=load&user="+a.f+"&state="+Nc(a,"1.30.0"));return b}
function Lc(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=Nc(a,"1.30.0");d.data=c;b=t(r()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var f=d.indexOf("\n");0<f&&(d=d.substr(0,f));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.K("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.K(c),ma("user",""),a.f=null)}}
l.Ma=function(a){this.a&&this.a.Ma(a);this.i&&this.i.Ma(a)};w(function(){for(var a=D(document,"pdp11-machine"),b=0;b<a.length;b++)for(var c=a[b],d=B(c),c=D(c,"pdp11","computer"),f=0;f<c.length;f++){var e=c[f],g=B(e),g=new zc(g,d,!0);C(g,e);g.J&&Dc(g,g.$a)}});v.show.push(function(){for(var a=D(document,"pdp11","computer"),b=0;b<a.length;b++){var c=B(a[b]);(c=Da("Computer",c.id))&&c.ba&&!c.g.L&&c.$a(-1)}});
v.exit.push(function(){for(var a=D(document,"pdp11","computer"),b=0;b<a.length;b++){var c=B(a[b]);(c=Da("Computer",c.id))&&c.g.L&&Kc(c,!(!c.b||c.w),!0)}});function P(a,b,c){this.id=a.id;this.key=Nc(a,b,c);this.H=a.H;Hc(this,a.ic)}function Nc(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}
P.prototype={constructor:P,set:function(a,b){try{this[this.id][a]=b}catch(c){}},get:function(a){return this[this.id][a]||null},value:function(){return this[this.id]},data:function(){return this[this.id]},toString:function(){var a=this[this.id];return"string"==typeof a?a:JSON.stringify(a)},clear:function(a){Hc(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(f){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(f){}b.splice(c,
1);c=0}}};function Hc(a,b){a[a.id]={};b&&a.set("parms",b);a.a=!1}function Ic(a){var b=!0;if(ka()){var c=JSON.stringify(a[a.id]);ma(a.key,c)||(u("Unable to store "+c.length+" bytes in browser local storage"),b=!1)}return b}function Fc(a){var b=!0;try{a[a.id]=JSON.parse(a[a.id])}catch(c){u(c.message||c),b=!1}return b}function Z(a,b){return b?(a[a.id]=b,a.a=!0):a.a?!0:ka()&&(b=la(a.key))?(a[a.id]=b,a.a=!0):!1}var Oc=0;
function Pc(a,b,c,d,f,e){f("Loading "+a+"...");t(a,null,!0,function(g,h,k){k?(h||(h="unable to load "+a+" ("+k+")"),e(h,null)):Qc(h,a,b,c,d,f,e)})}
function Qc(a,b,c,d,f,e,g){function h(a,e){if(e)g(e,null);else{c&&(Ca(c,b,a),(e=b)&&0>e.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(e=window.location.pathname+e),d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{",d+='url:"'+e+'"}',"object"==typeof resources&&(e=null),a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(d?" parms='"+d+"'":"")+(e?' url="'+e+'"':"")));f||(a=a.replace(/(<xsl:variable name="APPNAME">).*?(<\/xsl:variable>)/,"$1PDP11js$2"),
a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pdp11$2"));e=null;if("<"==a.charAt(0))try{f||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(a)):e=(new window.DOMParser).parseFromString(a,"text/xml")}catch(p){e=null,a=p.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);g(a,e)}}a?f?Rc(a,e,h):h(a,null):g("no data"+(b?" for file: "+b:""),null)}
function Rc(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var f=d[2];b("Loading "+f+"...");t(f,null,!0,function(e,g,h){if(h||!g)c(a,"unable to resolve XML reference: "+d[0]+" ("+h+")");else{if(e=d[3])if(h=g.match(new RegExp("<"+d[1]+"[^>]*>"))){for(var k=h[0],m,p=/( [a-z]+=)(['"])(.*?)\2/g;m=p.exec(e);)k=0>k.indexOf(m[1])?k.replace(">",m[0]+">"):k.replace(new RegExp(m[1]+"(['\"])(.*?)\\1"),m[0]);h[0]!=k&&(g=g.replace(h[0],k))}else{c(a,"missing <"+d[1]+"> in "+f);return}g=g.replace(/<\?xml[^>]*>[\r\n]*/,
"");a=a.replace(d[0],g);Rc(a,b,c)}})}else c(a,null)}
function Sc(a,b,c,d){function f(a){if(void 0===h){var b=g&&D(g,"machine-warning");h=b&&b[0]||g}h&&(h.innerHTML=fa(a))}function e(a){f("Error: "+a);k&&(--Oc||ta(!0));k=!1}var g,h,k=!0;Oc++;Ba[a]={};try{if(g=document.getElementById(a)){var m;if("object"==typeof resources&&(m=resources.css)){var p=document.head||document.getElementsByTagName("head")[0],F=document.createElement("style");F.type="text/css";F.styleSheet?F.styleSheet.cssText=m:F.appendChild(document.createTextNode(m));p.appendChild(F)}c||
(c="/versions/pdp11/1.30.0/components.xsl");m=function(d,h){h?Pc(c,null,null,!1,f,function(d,k){k?(Ca(a,c,d),f("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window?(k=h.transformNode(k))?(g.outerHTML=k,--Oc||ta(!0)):e("transformNodeToObject failed"):document.implementation&&document.implementation.createDocument?(d=new XSLTProcessor,d.importStylesheet(k),(k=d.transformToFragment(h,document))?g.parentNode?(g.parentNode.replaceChild(k,g),--Oc||ta(!0)):e("invalid machine element: "+
a):e("transformToFragment failed")):e("unable to transform XML: unsupported browser")):e(d)}):e(d)};"<"!=b.charAt(0)?Pc(b,a,d,!0,f,m):Qc(b,null,a,d,!1,f,m)}else e("missing machine element: "+a)}catch(H){e(H.message)}return k}window.embedPDP11=function(a,b,c,d){ta(!1);return Sc(a,b,c,d)};window.enableEvents=ta;window.sendEvent=ua;})();
