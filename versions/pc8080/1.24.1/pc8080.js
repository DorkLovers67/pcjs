(function(){var k;function aa(a){var b=16,c;if(a){b||(b=16);if("$"==a.charAt(0))b=16,a=a.substr(1);else if("0x"==a.substr(0,2))b=16,a=a.substr(2);else{var d=a.charAt(a.length-1).toLowerCase();"h"==d?(b=16,d=null):"."==d&&(b=10,d=null);null==d&&(a=a.substr(0,a.length-1))}var e,d=a,f=b;(f&&10!=f?16==f?null!==d.match(/^[0-9a-f]+$/i):2==f&&null!==d.match(/^[01]+$/i):null!==d.match(/^[0-9]+$/))&&!isNaN(e=parseInt(a,b))&&(c=e|0)}return c}
function m(a,b){var c="";void 0===b?b=8:8<b&&(b=8);if(null==a||isNaN(a))for(;0<b--;)c="?"+c;else for(;0<b--;){var d=a&15,d=d+(0<=d&&9>=d?48:55),c=String.fromCharCode(d)+c;a>>=4}return c}function ca(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("&");0<c&&(b=b.substr(0,c));return b}function da(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}function ea(){var a=fa();return-1!==a.indexOf("pcjs.org",a.length-8)}
var ga={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function ha(a){return a.replace(/[&<>"']/g,function(a){return ga[a]})}function ia(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}var ja={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US"},ka=Date.now||function(){return+new Date};
function la(){function a(a){return(10>a?"0":"")+a}var b=new Date;return b.getFullYear()+"-"+a(b.getMonth()+1)+"-"+a(b.getDate())+" "+a(b.getHours())+":"+a(b.getMinutes())+":"+a(b.getSeconds())}
function ma(a,b,c,d){var e=0,f=null,h=null;if("object"==typeof resources&&(f=resources[a]))return d&&d(a,f,e),[f,e];if(c&&"function"==typeof resources)return resources(a,function(b,c){d&&d(a,b,c)}),h;var g=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");c&&(g.onreadystatechange=function(){4===g.readyState&&(f=g.responseText,200==g.status||!g.status&&f.length&&"file:"==(window?window.location.protocol:"file:")||(e=g.status||-1),d&&d(a,f,e))});if(b&&"object"==
typeof b){var l="",n;for(n in b)b.hasOwnProperty(n)&&(l&&(l+="&"),l+=n+"="+encodeURIComponent(b[n]));l=l.replace(/%20/g,"+");g.open("POST",a,!!c);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send(l)}else g.open("GET",a,!!c),"bytes"==b&&g.overrideMimeType("text/plain; charset=x-user-defined"),g.send();c||(f=g.responseText,200!=g.status&&(e=g.status||-1),d&&d(a,f,e),h=[f,e]);return h}function fa(){return"http://"+(window?window.location.host:"www.pcjs.org")}
function p(a){window&&window.alert(a)}function na(a){var b=!1;window&&(b=window.confirm(a));return b}var oa=null;function pa(){if(null==oa){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}oa=a}return oa}function qa(a){var b;if(window)try{b=window.localStorage.getItem(a)}catch(c){}return b}
function ra(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}function sa(a){if(window){var b=window?window.navigator.userAgent:"";return"iOS"==a&&b.match(/(iPod|iPhone|iPad)/)&&b.match(/AppleWebKit/)||"MSIE"==a&&b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)?!0:!1}return!1}var ta={init:[],show:[],exit:[]},ua=!1,va=!1,wa=!0;function xa(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}function ya(a){ta.init.push(a)}
function za(a){if(wa)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){Aa("An unexpected exception occurred:\n\n"+c.message+"\n\nPlease send this information to support@pcjs.org. Thanks.",void 0,void 0)}}function Ba(a){!wa&&a?(wa=!0,ua&&Ea("init"),va&&Ea("show")):wa=a}function Ea(a){ta[a]&&za(ta[a])}xa("onload",function(){ua=!0;za(ta.init)});xa("onpageshow",function(){va=!0;za(ta.show)});xa(sa("Opera")||sa("iOS")?"onunload":"onbeforeunload",function(){za(ta.exit)});
function r(a,b,c){this.type=a;b||(b={id:"",name:""});this.id=b.id||"";this.name=b.name;this.vb=b.comment;this.Tc=b;b=this.id.indexOf(".");0>b?this.Ra=this.id:(this.Sa=this.id.substr(0,b),this.Ra=this.id.substr(b+1));this[a]=c;this.l={ga:!1,Ga:!1,nb:!1,V:!1,ua:!1};this.Ya=null;this.l.ua=!1;this.B={};this.N=null;t.push(this)}var Fa=void 0,Ga={};
if(window){Fa||(Fa=window.location.search.substr(1));for(var Ha,Ia=/\+/g,Ja=/([^&=]+)=?([^&]*)/g;Ha=Ja.exec(Fa);)Ga[decodeURIComponent(Ha[1].replace(Ia," "))]=decodeURIComponent(Ha[2].replace(Ia," "))}function Ka(a){function b(){}if(window){if(!a)throw new TypeError;if(Object.create)return Object.create(a);var c=typeof a;if("object"!==c&&"function"!==c)throw new TypeError;}b.prototype=a;return new b}
function v(a,b){b||(b=r);a.prototype=Ka(b.prototype);a.prototype.constructor=a;a.prototype.parent=b.prototype}if(window){window.PCjs||(window.PCjs={});var La=window.PCjs.Machines||(window.PCjs.Machines={}),t=window.PCjs.Components||(window.PCjs.Components=[])}else La={},t=[];function Ma(a,b,c){La[a]&&b&&(La[a][b]=c)}function Aa(a,b,c){b||p((c?c+": ":"")+a)}
function Na(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<t.length;b++){var d=t[b];a&&d.id.indexOf(a)||c.push(d)}return c}function Oa(a){if(void 0!==a){var b;for(b=0;b<t.length;b++)if(t[b].id===a)return t[b]}return null}function Pa(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<t.length;d++)if(c)c==t[d]&&(c=null);else if(!(a!=t[d].type||b&&t[d].id.indexOf(b)))return t[d]}return null}
function y(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){p(c.message+" ("+a+")")}return b}function Qa(a,b){for(var c=z(b.parentNode,"pc8080-control"),d=0;d<c.length;d++)for(var e=c[d].childNodes,f=0;f<e.length;f++){var h=e[f];if(1===h.nodeType){var g=h.getAttribute("class");if(g)for(var l=g.split(" "),n=0;n<l.length;n++)switch(g=l[n],g){case "pc8080-binding":(g=y(h))&&g.binding&&a.S(g.type,g.binding,h,g.value),n=l.length}}}}
function z(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
r.prototype={constructor:r,parent:null,toString:function(){return this.name?this.name:this.id||this.type},S:function(a,b,c){switch(b){case "clear":return this.B[b]||(this.B[b]=c,c.onclick=function(a){return function(){a.B.print&&(a.B.print.value="")}}(this)),!0;case "print":return this.B[b]||(this.oa=this.B[b]=c,c.value="",this.aa=function(a){return function(b,c){8192<a.value.length&&(a.value=a.value.substr(a.value.length-4096));a.value+=(void 0!==c?c+": ":"")+(b||"")+"\n";a.scrollTop=a.scrollHeight}}(c),
this.L=function(a){this.aa(a,this.Ra)}),!0;default:return!1}},log:function(){},aa:function(){},status:function(a){this.aa(this.Ra+": "+a)},L:function(a,b,c){Aa(a,b,c||this.type)},da:function(){return this.l.V=!0},ha:function(a,b){b&&(this.l.V=!1);return!0}};function Ra(a,b){if(a.l.nb)return a.l.Ga&&(a.l.Ga=!1),a.l.nb=!1;if(a.l.ua)return a.aa(a.toString()+" error"),!1;a.l.Ga=b;return a.l.Ga}function A(a){if(!a.l.ua&&(a.l.ga=!0,a.l.ga)){var b=a.Ya;a.Ya=null;b&&b()}}
function Sa(a,b){b&&(a.l.ga?b():a.Ya=b);return a.l.ga}
var Ta="undefined"!==typeof ArrayBuffer,Ua=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,
0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1];function Va(a){r.call(this,"Panel",a,Va)}v(Va);k=Va.prototype;k.S=function(a,b,c,d){return this.v&&this.v.S(a,b,c,d)||this.a&&this.a.S(a,b,c,d)||this.j&&this.j.S(a,b,c,d)?!0:this.parent.S.call(this,a,b,c,d)};k.ma=function(a,b,c,d){this.v=a;this.o=b;this.a=c;this.N=d;this.j=B(a,"Keyboard")};k.da=function(a,b){b||Wa();return!0};k.ha=function(){return!0};k.xa=function(){};
function Wa(){for(var a=!1,b=z(document,"pc8080","panel"),c=0;c<b.length;c++){var d=b[c],e=y(d),f=Oa(e.id);f||(a=!0,f=new Va(e));Qa(f,d);a&&A(f)}}ya(Wa);
function Xa(a,b,c){r.call(this,"Bus",a,Xa);this.a=b;this.N=c;this.i=a.busWidth||16;this.u=Math.pow(2,this.i);this.g=this.u-1|0;this.c=16>=this.i?10:20>=this.i?12:24>=this.i?14:15;this.o=1<<this.c;this.w=this.o>>2;this.f=this.o-1;this.j=this.u/this.o|0;this.s=this.j-1;this.m=[];this.v=[];this.A=[];this.C=[];a=new C;Ya(a,this.N);this.b=Array(this.j);for(b=0;b<this.j;b++)this.b[b]=a;A(this)}v(Xa);Xa.prototype.reset=function(){};Xa.prototype.da=function(a,b){b||this.reset();return!0};
function Za(a,b,c,d){for(var e=b,f=c,h=e>>>a.c;0<f&&h<a.b.length;){var g=a.b[h],l=h*a.o,n=a.o-(e-l);n>f&&(n=f);if(g&&g.size){if(g.type==d){if(e+f<=g.Fa)return g.gb+=g.Fa-e,g.Fa=e,!0;if(e>=g.Fa+g.gb){n=g.size-(e-l);n>f&&(n=f);g.gb=e-g.Fa+n;e=l+a.o;f-=n;h++;continue}}return $a(1,e,f)}e=new C(e,n,a.o,d);Ya(e,a.N,g);a.b[h++]=e;e=l+a.o;f-=n}return 0>=f?(a.status(Math.floor(c/1024)+"Kb "+ab[d]+" at "+("0x"+m(b,4))),!0):$a(2,b,c)}
Xa.prototype.K=function(a){return this.b[(a&this.g)>>>this.c].Oa(a&this.f,a)};function bb(a,b){return a.b[(b&a.g)>>>a.c].fb(b&a.f,b)}function cb(a,b){var c=b&a.f,d=(b&a.g)>>>a.c;return c!=a.f?a.b[d].kd(c,b):a.b[d++].Oa(c,b)|a.b[d&a.s].Oa(0,b+1)<<8}Xa.prototype.W=function(a,b){this.b[(a&this.g)>>>this.c].Pa(a&this.f,b&255,a)};function eb(a,b,c){a.b[(b&a.g)>>>a.c].$b(b&a.f,c&255,b)}
function fb(a,b,c){var d=b&a.f,e=(b&a.g)>>>a.c;d!=a.f?a.b[e].ld(d,c&65535,b):(a.b[e++].Pa(d,c&255,b),a.b[e&a.s].Pa(0,c>>8&255,b+1))}function gb(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,h=+e+d,g=c[e].bind(b);if(void 0!==g)for(var l=+e+d;l<=h;l++)void 0!==f.m[l]?p("Input port 0x"+m(l,4)+" already registered"):f.m[l]=[g,!1]}}
function hb(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,h=+e+d,g=c[e].bind(b);if(void 0!==g)for(var l=+e+d;l<=h;l++)void 0!==f.v[l]?p("Output port 0x"+m(l,4)+" already registered"):f.v[l]=[g,!1]}}function $a(a,b,c){p("Memory block error ("+a+": "+m(b)+","+m(c)+")");return!1}var ib;if(Ta){var jb=new ArrayBuffer(2);(new DataView(jb)).setUint16(0,256,!0);ib=256===(new Uint16Array(jb))[0]}else ib=!1;var kb=ib;
function C(a,b,c,d){this.id=lb+=2;this.a=null;this.Fa=a;this.gb=b;this.size=c||0;this.type=d||mb;this.B=d==nb;Ya(this);this.ka=this.Mb=!1;if(c)if(Ta)this.c=new ArrayBuffer(c),this.o=new DataView(this.c,0,c),this.b=new Uint8Array(this.c,0,c),this.i=new Uint16Array(this.c,0,c>>1),this.a=new Int32Array(this.c,0,c>>2),ob(this,kb?pb:qb);else{this.a=Array(c>>2);for(a=0;a<this.a.length;a++)this.a[a]=0;ob(this,rb)}else ob(this)}var mb=0,nb=2,ab=["NONE","RAM","ROM","VID","H/W"],lb=0;
C.prototype={constructor:C,parent:null,save:function(){var a,b;if(Ta)for(a=Array(this.size>>2),b=0;b<a.length;b++)a[b]=this.o.getInt32(b<<2,!0);else a=this.a;return a},restore:function(a){if(a&&this.size==a.length<<2){var b;if(Ta)for(b=0;b<a.length;b++)this.o.setInt32(b<<2,a[b],!0);else this.a=a;return this.ka=!0}return!1},j:function(){return 255},v:function(){},m:function(a,b){return this.Oa(a++,b++)|this.Oa(a,b)<<8},s:function(a,b,c){this.Pa(a++,b&255,c++);this.Pa(a,b>>8,c)},C:function(a){return this.a[a>>
2]>>>((a&3)<<3)&255},M:function(a){var b=a>>2;a=(a&3)<<3;var c=this.a[b]>>a;return 24>a?c&65535:c&255|(this.a[b+1]&255)<<8},U:function(a,b){var c=a>>2,d=(a&3)<<3;this.a[c]=this.a[c]&~(255<<d)|b<<d;this.ka=!0},na:function(a,b){var c=a>>2,d=(a&3)<<3;24>d?this.a[c]=this.a[c]&~(65535<<d)|b<<d:(this.a[c]=this.a[c]&16777215|b<<24,c++,this.a[c]=this.a[c]&-256|b>>8);this.ka=!0},w:function(a,b){return this.fb(a,b)},H:function(a,b){return this.Yb(a,b)},O:function(a,b,c){this.B||this.$b(a,b,c)},$:function(a,
b,c){this.B||this.ba(a,b,c)},u:function(a){return this.b[a]},A:function(a){return this.b[a]},G:function(a){return this.o.getUint16(a,!0)},I:function(a){return a&1?this.b[a]|this.b[a+1]<<8:this.i[a>>1]},J:function(a,b){this.b[a]=b;this.ka=!0},T:function(a,b){this.b[a]=b;this.ka=!0},Z:function(a,b){this.o.setUint16(a,b,!0);this.ka=!0},ea:function(a,b){a&1?(this.b[a]=b,this.b[a+1]=b>>8):this.i[a>>1]=b;this.ka=!0}};
function Ya(a,b,c){a.N=b;a.f=a.g=0;c&&((a.f=c.f)&&sb(a,tb,!1),(a.g=c.g)&&ub(a,tb,!1))}function ub(a,b,c){c&&a.g||(a.Pa=!a.B&&b[2]||a.v,a.ld=!a.B&&b[3]||a.s);if(c||void 0===c)a.$b=b[2]||a.v,a.ba=b[3]||a.s}function sb(a,b,c){c&&a.f||(a.Oa=b[0]||a.j,a.kd=b[1]||a.m);if(c||void 0===c)a.fb=b[0]||a.j,a.Yb=b[1]||a.m}function ob(a,b){b||(b=vb);sb(a,b,void 0);ub(a,b,void 0)}var vb=[],rb=[C.prototype.C,C.prototype.M,C.prototype.U,C.prototype.na],tb=[C.prototype.w,C.prototype.H,C.prototype.O,C.prototype.$];
if(Ta)var qb=[C.prototype.u,C.prototype.G,C.prototype.J,C.prototype.Z],pb=[C.prototype.A,C.prototype.I,C.prototype.T,C.prototype.ea];
function wb(a,b){r.call(this,"CPU",a,wb);var c=a.cycles||b,d=a.multiplier||1;this.b={};this.b.qa=c;this.b.bb=0;this.b.pa=d;this.b.ob=Math.round(this.b.qa/1E4)/100;this.b.Aa=this.b.ob*this.b.pa;this.l.la=!1;this.l.Ob=!1;this.l.Lb=a.autoStart;this.l.Nb=!1;this.l.Wa=!1;this.b.$a=this.b.Ca=0;this.b.ab=a.csStart;this.b.Ha=a.csInterval;this.b.Ia=a.csStop;this.I=[];this.na=this.tb.bind(this);A(this)}v(wb);var xb=["power","reset"];k=wb.prototype;
k.ma=function(a,b,c,d){this.v=a;this.o=b;this.N=d;for(b=0;b<xb.length;b++)(c=this.B[xb[b]])&&this.v.S(null,xb[b],c);this.U=(b=B(a,"Video"))&&Math.max(b.Vc,b.mb)||60;this.M=B(a,"ChipSet");a=yb(a,"autoStart");null!=a&&(this.l.Lb="true"==a?!0:"false"==a?!1:!!a);A(this)};k.reset=function(){this.b.bb=0};k.save=function(){return null};k.restore=function(){return!1};
k.da=function(a,b){if(!b){if(a&&this.restore){zb(this);if(!this.restore(a))return!1;Ab(this)}else this.reset();this.aa("No debugger detected")}Bb(this);return!0};k.ha=function(a){return a?this.save():!0};function Cb(a){(a.l.Lb||void 0===a.B.run)&&a.tb(!0)}k.Rb=function(){return 0};function Ab(a){void 0===a.b.ab&&(a.b.ab=0);void 0===a.b.Ha&&(a.b.Ha=-1);void 0===a.b.Ia&&(a.b.Ia=-1);a.l.Wa=0<=a.b.ab&&0<a.b.Ha;a.l.Wa&&(a.b.$a=0,a.b.Ca=a.b.ab-a.O)}
k.S=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.B[b]=c;a=!0;break;case "run":this.B[b]=c;c.onclick=function(){var a;if(a=d.v)if(a=d.v,a.l.V)a=!0;else{var b=null,c,g=Na(a.id);for(c=0;c<g.length&&(b=g[c],b===a||b.l.ga);c++);if(c==g.length)for(c=0;c<g.length&&(b=g[c],b===a||b.l.V);c++);c==g.length&&(b=a);p("The "+b.type+" component ("+b.id+") is not "+(b.l.ga?"powered yet":"ready yet"+(b.Ya?" (waiting for notification)":""))+".");a=!1}a&&(d.l.la?Db(d):d.tb())};a=!0;break;
case "speed":this.B[b]=c;a=!0;break;case "setSpeed":this.B[b]=c,c.onclick=function(){Eb(d,d.b.pa<<1,!0)},c.textContent=this.b.Aa.toFixed(2)+"Mhz",a=!0}return a};function Fb(a,b,c){a.O+=b;c&&(a.G=a.a=0)}
function Gb(a,b){var c=30;c<a.U&&(c=a.U);2>c&&(c=2);var d=1;b&&1<a.b.pa&&a.b.va&&(d=a.b.va/a.b.ob);a.b.Ub=Math.round(1E3/30);a.b.Uc=Math.floor(a.b.qa/c*d);a.b.qb=Math.floor(a.b.qa/30*d);a.b.Wb=Math.floor(a.b.qa/a.U*d);a.b.Vb=Math.floor(a.b.qa/2*d);b||(a.b.La=a.b.qb,a.b.Ka=a.b.Wb,a.b.Ja=a.b.Vb);a.b.rb=0}function Ib(a){return a.O+a.J+a.G-a.a}function zb(a){a.b.va=0;a.O=a.J=a.G=a.a=0;Ab(a);Eb(a,1)}
function Eb(a,b,c){if(void 0!==b){.8>a.b.va/a.b.Aa&&(b=1);a.b.pa=b;b=a.b.ob*a.b.pa;if(a.b.Aa!=b){a.b.Aa=b;b=a.b.Aa.toFixed(2)+"Mhz";var d=a.B.setSpeed;d&&(d.textContent=b);a.aa("target speed: "+b)}c&&a.v&&Jb(a.v)}Fb(a,a.J);a.J=0;a.b.Ba=ka();a.b.wa=0;Gb(a)}function Kb(a,b){var c=a.I.length;a.I.push([-1,b]);return c}function Lb(a,b,c){var d=-1;0<=b&&b<a.I.length&&(d=a.b.qa*a.b.pa/1E3*c,a.I[b][0]=d)}
k.tb=function(a){if(Ra(this,!0)){if(!this.l.la){Eb(this);this.v&&this.v.start(this.b.Ba,Ib(this));this.l.la=!0;this.l.Ob=!0;this.M&&this.M.start();var b=this.B.run;b&&(b.textContent="Halt");this.v&&(this.v.xa(!0),a&&Jb(this.v,!0))}this.b.rb>=this.b.qa&&Gb(this,!0);this.b.Ma=0;this.b.Za=ka();this.b.wa&&(a=this.b.Za-this.b.wa,a>this.b.Ub&&(this.b.Ba+=a,this.b.Ba>this.b.Za&&(this.b.Ba=this.b.Za)));try{do{var c=this.l.Wa?1:this.b.Uc;a=c;for(var d=this.I.length-1;0<=d;d--){var e=this.I[d];0>e[0]||a>e[0]&&
(a=e[0])}c=a;this.Zb(c);var f=this.G-this.a;a=f;for(var h=this.I.length-1;0<=h;h--){var g=this.I[h];0>g[0]||(g[0]-=a,0>=g[0]&&(g[0]=-1,g[1]()))}this.b.Ma+=f;this.J+=f;Fb(this,0,!0);a=f;this.l.Wa&&(b=!1,this.b.$a=this.b.$a+this.Rb()|0,this.b.Ca-=a,0>=this.b.Ca&&(this.b.Ca+=this.b.Ha,b=!0),0<=this.b.Ia&&this.b.Ia<=Ib(this)&&(this.b.Ha=this.b.Ia=-1,Ab(this),Db(this),b=!0),b&&this.aa(Ib(this)+" cycles: checksum="+m(this.b.$a)));this.b.Ka-=f;0>=this.b.Ka&&(this.b.Ka+=this.b.Wb,this.v&&Mb(this.v,this.b.bb++),
this.b.bb>this.U&&(this.b.bb=0));this.b.Ja-=f;0>=this.b.Ja&&(this.b.Ja+=this.b.Vb,this.v&&this.v.xa());this.b.La-=f;if(0>=this.b.La){this.b.La+=this.b.qb;break}}while(this.l.la)}catch(l){Db(this);Bb(this);this.v&&this.v.stop(ka(),Ib(this));Ra(this,!1);c=l.stack||l.message;this.l.ua=!0;this.L(c);return}c=setTimeout;d=this.na;this.b.wa=ka();e=this.b.Ub;this.b.Ma&&(e=Math.round(e*this.b.Ma/this.b.qb));e-=this.b.wa-this.b.Za;if(f=this.b.wa-this.b.Ba)this.b.va=Math.round(this.J/(10*f))/100,864E5<=f&&(this.O=
0,Eb(this));if(0>e||this.b.va<this.b.Aa)e=0;this.b.rb+=this.b.Ma;this.b.wa+=e;c(d,e)}else Bb(this),this.v&&this.v.stop(ka(),Ib(this))};k.Zb=function(){return 0};function Db(a){a.l.Ga&&(a.l.nb=!0);a.G-=a.a;a.a=0;Fb(a,a.J);a.J=0;if(a.l.la){a.l.la=!1;a.M&&a.M.stop();var b=a.B.run;b&&(b.textContent="Run")}a.l.Xa=void 0}function Bb(a){a.v&&(Mb(a.v,-1),a.v.xa(void 0))}
function Nb(a){this.ea=+a.model||8080;wb.call(this,a,1E6);this.Z=Ob;zb(this);this.l.Xa=this.l.Gc=!1;this.ba=0;this.T=[];this.$=0;Pb(this)}v(Nb,wb);function Qb(a,b){a.T.push(b)}k=Nb.prototype;k.reset=function(){this.l.la&&Db(this);Pb(this);zb(this);this.l.ua=!1;this.parent.reset.call(this)};function Pb(a){a.c=0;a.f=0;a.D=0;a.g=0;a.F=0;a.i=0;a.j=0;a.w=0;D(a,a.$);Rb(a,0);a.C=0}function Sb(a,b){a.$=b;D(a,b)}
k.Rb=function(){var a=this.c+this.f+this.D+this.g+this.F+this.i+this.j|0;return a=a+this.w+this.s+Tb(this)|0};
k.save=function(){var a=new E(this);G(a,0,[this.c,this.f,this.D,this.g,this.F,this.i,this.j,this.w,this.s,Tb(this)]);G(a,1,[this.C,this.O,this.b.pa]);for(var b=this.o,c=0,d=[],e=0;e<b.j;e++){var f=b.b[e];if(f.ka||f.Mb){d[c++]=e;var h=c++;a:if(f=f.save()){for(var g=0,l=0,n=[];g<f.length;){for(var x=f[g],u=g+1;u<f.length&&f[u]===x;)u++;n[l++]=u-g;n[l++]=x;g=u}if(n.length<f.length){f=n;break a}}d[h]=f}}G(a,2,d);return a.data()};
k.restore=function(a){var b=a[0];this.c=b[0];this.f=b[1];this.D=b[2];this.g=b[3];this.F=b[4];this.i=b[5];this.j=b[6];this.w=b[7]&65535;D(this,b[8]);Rb(this,b[9]);b=a[1];this.C=b[0];this.O=b[1];Eb(this,b[3]);a:{b=this.o;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],e=a[c+1];if(e&&e.length<b.w){for(var f=0,h=Array(b.w),g=0;g<e.length-1;)for(var l=e[g++],n=e[g++];l--;)h[f++]=n;e=h}f=b.b[d];if(!f||!f.restore(e)){p("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
k.S=function(a,b,c){var d=!1;switch(b){case "A":case "B":case "C":case "BC":case "D":case "E":case "DE":case "H":case "L":case "HL":case "SP":case "PC":case "PS":case "IF":case "SF":case "ZF":case "AF":case "PF":case "CF":this.B[b]=c;this.ba++;d=!0;break;default:d=this.parent.S.call(this,a,b,c)}return d};function Ub(a){return a.f<<8|a.D}function Vb(a,b){a.f=b>>8&255;a.D=b&255}function Wb(a){return a.g<<8|a.F}function Xb(a,b){a.g=b>>8&255;a.F=b&255}function I(a){return a.i<<8|a.j}
function J(a,b){a.i=b>>8&255;a.j=b&255}function D(a,b){a.s=b&65535}function K(a){return a.m&256?1:0}function L(a,b){a.m=a.m&255|b}function Yb(a){return Ua[a.u&255]?4:0}function Tb(a){return a.H&-214|(a.u&128?128:0)|(a.m&255?0:64)|((a.u^a.A)&16?16:0)|Yb(a)|K(a)}function Rb(a,b){a.m=a.u=a.A=0;b&1&&(a.m|=256);b&4||(a.u|=1);b&16&&(a.A|=16);b&64||(a.m|=255);b&128&&(a.u^=192);a.H=a.H&-726|b&512|2}function M(a,b){a.A=a.c^b;return a.u=(a.m=a.c+b)&255}
function Zb(a,b){a.A=a.c^b;return a.u=(a.m=a.c+b+(a.m&256?1:0))&255}function $b(a,b){a.m=a.u=a.A=a.c&b;(a.c|b)&8&&(a.A^=16);return a.m}function ac(a,b){a.A=b^255;b=a.u=b+255&255;a.m=a.m&-256|b;return b}function bc(a,b){a.A=b;b=a.u=b+1&255;a.m=a.m&-256|b;return b}function cc(a,b){return a.u=a.m=a.A=a.c|b}function N(a,b){b^=255;a.A=a.c^b;return a.u=(a.m=a.c+b+1^256)&255}function dc(a,b){b^=255;a.A=a.c^b;return a.u=(a.m=a.c+b+(a.m&256?0:1)^256)&255}function ec(a,b){return a.u=a.m=a.A=a.c^b}k.K=function(a){return this.o.K(a)};
k.W=function(a,b){this.o.W(a,b)};function O(a){var b=a.K(a.s);D(a,a.s+1);return b}function P(a){var b=cb(a.o,a.s);D(a,a.s+2);return b}function S(a){var b=cb(a.o,a.w);a.w=a.w+2&65535;return b}function T(a,b){a.w=a.w-2&65535;fb(a.o,a.w,b)}function fc(a){if(a.a&&a.C&255&&a.H&512){for(var b=0;8>b&&!(a.C&1<<b);b++);a.C&=~(0>b?255:1<<b);a.H&=-513;a.C&=-257;a.Z[199|b<<3].call(a)}return a.C&256?(a.G-=a.a,a.a=0,!1):!0}function gc(a,b){a.C|=1<<b;a.H&512&&(a.G-=a.a,a.a=0)}
function U(a,b,c,d){d=d||2;a.B[b]&&(void 0===c&&(a.l.ua=!0,a.L("Value for "+b+" is invalid"),Db(a)),c=!a.l.la||a.l.Nb?m(c,d):"--------".substr(0,d),a.B[b].textContent!=c&&(a.B[b].textContent=c))}
k.xa=function(a){this.ba&&(a||!this.l.la||this.l.Nb)&&(U(this,"A",this.c),U(this,"B",this.f),U(this,"C",this.D),U(this,"BC",Ub(this),4),U(this,"D",this.g),U(this,"E",this.F),U(this,"DE",Wb(this),4),U(this,"H",this.i),U(this,"L",this.j),U(this,"HL",I(this),4),U(this,"SP",this.w,4),U(this,"PC",this.s,4),a=Tb(this),U(this,"PS",a,4),U(this,"IF",a&512?1:0,1),U(this,"SF",a&128?1:0,1),U(this,"ZF",a&64?1:0,1),U(this,"AF",a&16?1:0,1),U(this,"PF",a&4?1:0,1),U(this,"CF",a&1?1:0,1));if(a=this.B.speed)a.textContent=
this.l.la&&this.b.va?this.b.va.toFixed(2)+"Mhz":"Stopped"};k.Zb=function(a){this.l.Xa=!0;this.l.Gc=!1;this.l.Ob=!1;this.G=this.a=a;if(fc(this)){do this.Z[O(this)].call(this);while(0<this.a)}return this.l.Xa?this.G-this.a:void 0===this.l.Xa?0:-1};ya(function(){for(var a=z(document,"pc8080","cpu"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new Nb(d);Qa(d,c)}});function hc(){this.a-=4}function ic(){D(this,P(this));this.a-=10}function jc(){D(this,S(this));this.a-=10}
function kc(){var a=P(this);T(this,this.s);D(this,a);this.a-=17}
var Ob=[hc,function(){Vb(this,P(this));this.a-=10},function(){this.W(Ub(this),this.c);this.a-=7},function(){Vb(this,Ub(this)+1);this.a-=5},function(){this.f=bc(this,this.f);this.a-=5},function(){this.f=ac(this,this.f);this.a-=5},function(){this.f=O(this);this.a-=7},function(){var a=this.c<<1;this.c=a&255|a>>8;L(this,a&256);this.a-=4},hc,function(){var a;J(this,a=I(this)+Ub(this));L(this,a>>8&256);this.a-=10},function(){this.c=this.K(Ub(this));this.a-=7},function(){Vb(this,Ub(this)-1);this.a-=5},function(){this.D=
bc(this,this.D);this.a-=5},function(){this.D=ac(this,this.D);this.a-=5},function(){this.D=O(this);this.a-=7},function(){var a=this.c<<8&256;this.c=(a|this.c)>>1;L(this,a);this.a-=4},hc,function(){Xb(this,P(this));this.a-=10},function(){this.W(Wb(this),this.c);this.a-=7},function(){Xb(this,Wb(this)+1);this.a-=5},function(){this.g=bc(this,this.g);this.a-=5},function(){this.g=ac(this,this.g);this.a-=5},function(){this.g=O(this);this.a-=7},function(){var a=this.c<<1;this.c=a&255|K(this);L(this,a&256);
this.a-=4},hc,function(){var a;J(this,a=I(this)+Wb(this));L(this,a>>8&256);this.a-=10},function(){this.c=this.K(Wb(this));this.a-=7},function(){Xb(this,Wb(this)-1);this.a-=5},function(){this.F=bc(this,this.F);this.a-=5},function(){this.F=ac(this,this.F);this.a-=5},function(){this.F=O(this);this.a-=7},function(){var a=this.c<<8;this.c=(K(this)<<8|this.c)>>1;L(this,a&256);this.a-=4},hc,function(){J(this,P(this));this.a-=10},function(){var a=P(this);fb(this.o,a,I(this));this.a-=16},function(){J(this,
I(this)+1);this.a-=5},function(){this.i=bc(this,this.i);this.a-=5},function(){this.i=ac(this,this.i);this.a-=5},function(){this.i=O(this);this.a-=7},function(){var a=0,b=K(this);if((this.u^this.A)&16||9<(this.c&15))a|=6;if(b||154<=this.c)a|=96,b=1;this.c=M(this,a);L(this,b?256:0);this.a-=4},hc,function(){var a;J(this,a=I(this)+I(this));L(this,a>>8&256);this.a-=10},function(){var a;a=P(this);a=cb(this.o,a);J(this,a);this.a-=16},function(){J(this,I(this)-1);this.a-=5},function(){this.j=bc(this,this.j);
this.a-=5},function(){this.j=ac(this,this.j);this.a-=5},function(){this.j=O(this);this.a-=7},function(){this.c=~this.c&255;this.a-=4},hc,function(){this.w=P(this)&65535;this.a-=10},function(){this.W(P(this),this.c);this.a-=13},function(){this.w=this.w+1&65535;this.a-=5},function(){var a=I(this);this.W(a,bc(this,this.K(a)));this.a-=10},function(){var a=I(this);this.W(a,ac(this,this.K(a)));this.a-=10},function(){this.W(I(this),O(this));this.a-=10},function(){this.m|=256;this.a-=4},hc,function(){var a;
J(this,a=I(this)+this.w);L(this,a>>8&256);this.a-=10},function(){this.c=this.K(P(this));this.a-=13},function(){this.w=this.w-1&65535;this.a-=5},function(){this.c=bc(this,this.c);this.a-=5},function(){this.c=ac(this,this.c);this.a-=5},function(){this.c=O(this);this.a-=7},function(){L(this,K(this)?0:256);this.a-=4},function(){this.a-=5},function(){this.f=this.D;this.a-=5},function(){this.f=this.g;this.a-=5},function(){this.f=this.F;this.a-=5},function(){this.f=this.i;this.a-=5},function(){this.f=this.j;
this.a-=5},function(){this.f=this.K(I(this));this.a-=7},function(){this.f=this.c;this.a-=5},function(){this.D=this.f;this.a-=5},function(){this.a-=5},function(){this.D=this.g;this.a-=5},function(){this.D=this.F;this.a-=5},function(){this.D=this.i;this.a-=5},function(){this.D=this.j;this.a-=5},function(){this.D=this.K(I(this));this.a-=7},function(){this.D=this.c;this.a-=5},function(){this.g=this.f;this.a-=5},function(){this.g=this.D;this.a-=5},function(){this.a-=5},function(){this.g=this.F;this.a-=
5},function(){this.g=this.i;this.a-=5},function(){this.g=this.j;this.a-=5},function(){this.g=this.K(I(this));this.a-=7},function(){this.g=this.c;this.a-=5},function(){this.F=this.f;this.a-=5},function(){this.F=this.D;this.a-=5},function(){this.F=this.g;this.a-=5},function(){this.a-=5},function(){this.F=this.i;this.a-=5},function(){this.F=this.j;this.a-=5},function(){this.F=this.K(I(this));this.a-=7},function(){this.F=this.c;this.a-=5},function(){this.i=this.f;this.a-=5},function(){this.i=this.D;this.a-=
5},function(){this.i=this.g;this.a-=5},function(){this.i=this.F;this.a-=5},function(){this.a-=5},function(){this.i=this.j;this.a-=5},function(){this.i=this.K(I(this));this.a-=7},function(){this.i=this.c;this.a-=5},function(){this.j=this.f;this.a-=5},function(){this.j=this.D;this.a-=5},function(){this.j=this.g;this.a-=5},function(){this.j=this.F;this.a-=5},function(){this.j=this.i;this.a-=5},function(){this.a-=5},function(){this.j=this.K(I(this));this.a-=7},function(){this.j=this.c;this.a-=5},function(){this.W(I(this),
this.f);this.a-=7},function(){this.W(I(this),this.D);this.a-=7},function(){this.W(I(this),this.g);this.a-=7},function(){this.W(I(this),this.F);this.a-=7},function(){this.W(I(this),this.i);this.a-=7},function(){this.W(I(this),this.j);this.a-=7},function(){var a=this.s-1;if(this.T.length)for(var b=0;b<this.T.length;b++)if(this.T[b](a))return;this.a-=7;this.C|=256;this.G-=this.a;this.a=0;this.H&512||Db(this)},function(){this.W(I(this),this.c);this.a-=7},function(){this.c=this.f;this.a-=5},function(){this.c=
this.D;this.a-=5},function(){this.c=this.g;this.a-=5},function(){this.c=this.F;this.a-=5},function(){this.c=this.i;this.a-=5},function(){this.c=this.j;this.a-=5},function(){this.c=this.K(I(this));this.a-=7},function(){this.a-=5},function(){this.c=M(this,this.f);this.a-=4},function(){this.c=M(this,this.D);this.a-=4},function(){this.c=M(this,this.g);this.a-=4},function(){this.c=M(this,this.F);this.a-=4},function(){this.c=M(this,this.i);this.a-=4},function(){this.c=M(this,this.j);this.a-=4},function(){this.c=
M(this,this.K(I(this)));this.a-=7},function(){this.c=M(this,this.c);this.a-=4},function(){this.c=Zb(this,this.f);this.a-=4},function(){this.c=Zb(this,this.D);this.a-=4},function(){this.c=Zb(this,this.g);this.a-=4},function(){this.c=Zb(this,this.F);this.a-=4},function(){this.c=Zb(this,this.i);this.a-=4},function(){this.c=Zb(this,this.j);this.a-=4},function(){this.c=Zb(this,this.K(I(this)));this.a-=7},function(){this.c=Zb(this,this.c);this.a-=4},function(){this.c=N(this,this.f);this.a-=4},function(){this.c=
N(this,this.D);this.a-=4},function(){this.c=N(this,this.g);this.a-=4},function(){this.c=N(this,this.F);this.a-=4},function(){this.c=N(this,this.i);this.a-=4},function(){this.c=N(this,this.j);this.a-=4},function(){this.c=N(this,this.K(I(this)));this.a-=7},function(){this.c=N(this,this.c);this.a-=4},function(){this.c=dc(this,this.f);this.a-=4},function(){this.c=dc(this,this.D);this.a-=4},function(){this.c=dc(this,this.g);this.a-=4},function(){this.c=dc(this,this.F);this.a-=4},function(){this.c=dc(this,
this.i);this.a-=4},function(){this.c=dc(this,this.j);this.a-=4},function(){this.c=dc(this,this.K(I(this)));this.a-=7},function(){this.c=dc(this,this.c);this.a-=4},function(){this.c=$b(this,this.f);this.a-=4},function(){this.c=$b(this,this.D);this.a-=4},function(){this.c=$b(this,this.g);this.a-=4},function(){this.c=$b(this,this.F);this.a-=4},function(){this.c=$b(this,this.i);this.a-=4},function(){this.c=$b(this,this.j);this.a-=4},function(){this.c=$b(this,this.K(I(this)));this.a-=7},function(){this.c=
$b(this,this.c);this.a-=4},function(){this.c=ec(this,this.f);this.a-=4},function(){this.c=ec(this,this.D);this.a-=4},function(){this.c=ec(this,this.g);this.a-=4},function(){this.c=ec(this,this.F);this.a-=4},function(){this.c=ec(this,this.i);this.a-=4},function(){this.c=ec(this,this.j);this.a-=4},function(){this.c=ec(this,this.K(I(this)));this.a-=7},function(){this.c=ec(this,this.c);this.a-=4},function(){this.c=cc(this,this.f);this.a-=4},function(){this.c=cc(this,this.D);this.a-=4},function(){this.c=
cc(this,this.g);this.a-=4},function(){this.c=cc(this,this.F);this.a-=4},function(){this.c=cc(this,this.i);this.a-=4},function(){this.c=cc(this,this.j);this.a-=4},function(){this.c=cc(this,this.K(I(this)));this.a-=7},function(){this.c=cc(this,this.c);this.a-=4},function(){N(this,this.f);this.a-=4},function(){N(this,this.D);this.a-=4},function(){N(this,this.g);this.a-=4},function(){N(this,this.F);this.a-=4},function(){N(this,this.i);this.a-=4},function(){N(this,this.j);this.a-=4},function(){N(this,
this.K(I(this)));this.a-=7},function(){N(this,this.c);this.a-=4},function(){this.m&255&&(D(this,S(this)),this.a-=6);this.a-=5},function(){Vb(this,S(this));this.a-=10},function(){var a=P(this);this.m&255&&D(this,a);this.a-=10},ic,function(){var a=P(this);this.m&255&&(T(this,this.s),D(this,a),this.a-=6);this.a-=11},function(){T(this,Ub(this));this.a-=11},function(){this.c=M(this,O(this));this.a-=7},function(){T(this,this.s);D(this,0);this.a-=11},function(){this.m&255||(D(this,S(this)),this.a-=6);this.a-=
5},jc,function(){var a=P(this);this.m&255||D(this,a);this.a-=10},ic,function(){var a=P(this);this.m&255||(T(this,this.s),D(this,a),this.a-=6);this.a-=11},kc,function(){this.c=Zb(this,O(this));this.a-=7},function(){T(this,this.s);D(this,8);this.a-=11},function(){K(this)||(D(this,S(this)),this.a-=6);this.a-=5},function(){Xb(this,S(this));this.a-=10},function(){var a=P(this);K(this)||D(this,a);this.a-=10},function(){for(var a=O(this),b=this.o,c=this.c,d=this.s+-2&65535,e=1,f=0;0<e;){var h=b.v[a],g=b.C[a]||
1,l=1==g?255:2==g?65535:-1,l=(c>>>=f)&l;if(void 0!==h&&h[0])h[0](a,l,d);f+=g<<3;a+=g;e-=g}this.a-=10},function(){var a=P(this);K(this)||(T(this,this.s),D(this,a),this.a-=6);this.a-=11},function(){T(this,Wb(this));this.a-=11},function(){this.c=N(this,O(this));this.a-=7},function(){T(this,this.s);D(this,16);this.a-=11},function(){K(this)&&(D(this,S(this)),this.a-=6);this.a-=5},jc,function(){var a=P(this);K(this)&&D(this,a);this.a-=10},function(){for(var a=O(this),b=this.o,c=this.s+-2&65535,d=1,e=0,
f=0;0<d;){var h=b.m[a],g=b.A[a]||1,l=1==g?255:2==g?65535:-1,n=l;void 0!==h&&h[0]&&(n=h[0](a,c),void 0===n?n=l:n&=l);e|=n<<f;f+=g<<3;a+=g;d-=g}this.c=e&255;this.a-=10},function(){var a=P(this);K(this)&&(T(this,this.s),D(this,a),this.a-=6);this.a-=11},kc,function(){this.c=dc(this,O(this));this.a-=7},function(){T(this,this.s);D(this,24);this.a-=11},function(){Yb(this)||(D(this,S(this)),this.a-=6);this.a-=5},function(){J(this,S(this));this.a-=10},function(){var a=P(this);Yb(this)||D(this,a);this.a-=10},
function(){var a=S(this);T(this,I(this));J(this,a);this.a-=18},function(){var a=P(this);Yb(this)||(T(this,this.s),D(this,a),this.a-=6);this.a-=11},function(){T(this,I(this));this.a-=11},function(){this.c=$b(this,O(this));this.a-=7},function(){T(this,this.s);D(this,32);this.a-=11},function(){Yb(this)&&(D(this,S(this)),this.a-=6);this.a-=5},function(){D(this,I(this));this.a-=5},function(){var a=P(this);Yb(this)&&D(this,a);this.a-=10},function(){var a=I(this);J(this,Wb(this));Xb(this,a);this.a-=5},function(){var a=
P(this);Yb(this)&&(T(this,this.s),D(this,a),this.a-=6);this.a-=11},kc,function(){this.c=ec(this,O(this));this.a-=7},function(){T(this,this.s);D(this,40);this.a-=11},function(){this.u&128||(D(this,S(this)),this.a-=6);this.a-=5},function(){var a=S(this);Rb(this,a&255|this.H&-256);this.c=a>>8;this.a-=10},function(){var a=P(this);this.u&128||D(this,a);this.a-=10},function(){this.H&=-513;this.a-=4},function(){var a=P(this);this.u&128||(T(this,this.s),D(this,a),this.a-=6);this.a-=11},function(){T(this,
Tb(this)&255|this.c<<8);this.a-=11},function(){this.c=cc(this,O(this));this.a-=7},function(){T(this,this.s);D(this,48);this.a-=11},function(){this.u&128&&(D(this,S(this)),this.a-=6);this.a-=5},function(){this.w=I(this)&65535;this.a-=5},function(){var a=P(this);this.u&128&&D(this,a);this.a-=10},function(){this.H|=512;this.a-=4;fc(this)},function(){var a=P(this);this.u&128&&(T(this,this.s),D(this,a),this.a-=6);this.a-=11},kc,function(){N(this,O(this));this.a-=7},function(){T(this,this.s);D(this,56);
this.a-=11}];function W(a){r.call(this,"ChipSet",a,W);var b=a.model;b&&!lc[b]&&Aa("Unrecognized ChipSet model: "+b);this.c=lc[b]||{};a.sound&&(this.M=null,window&&(this.M=window.AudioContext||window.webkitAudioContext),this.M&&new this.M);A(this)}v(W);
var X={X:1978.1,Dc:{Y:0,qd:1,ud:16,Bd:32,Kd:64,Jd:128,Da:14},ta:{Y:1,ec:1,yc:2,uc:4,vc:16,wc:32,xc:64,Da:8},Ec:{Y:2,pd:3,Td:4,rd:8,Fd:16,Gd:32,Hd:64,sd:128,Da:0},Od:{Y:3},Md:{Y:2,Cd:7},Qd:{Y:3,Ud:1,Pd:2,Id:4,zd:8,td:16,md:32},Nd:{Y:4},Rd:{Y:5,vd:1,wd:2,xd:4,yd:8,Vd:16}},Y={X:100,ia:{Y:66,Eb:1,sc:2,tc:4,Ed:8,Dd:16,Cb:32,Bb:64,yb:128},dc:{Y:66,INIT:0},ra:{Y:194,od:0,xb:16,zc:32,Db:48,ic:0,jc:32},Qa:{Y:162,Ld:0,lc:0,hc:0,kc:0,gc:0},ja:{Ad:{Y:98},ya:{bc:0,ac:1,Bc:2,Fc:4,fc:5,Ac:6,Sd:7},Ua:16383}},lc=
{SI1978:X,VT100:Y};W.prototype.S=function(){return!1};W.prototype.ma=function(a,b,c,d){this.o=b;this.a=c;this.N=d;this.v=a;this.j=B(a,"Keyboard");this.ea=B(a,"SerialPort");this.video=B(a,"Video");gb(b,this,this.c.cb);hb(b,this,this.c.eb)};W.prototype.da=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};W.prototype.ha=function(a){return a?this.save():!0};X.INIT=[[X.Dc.Da,X.ta.Da,X.Ec.Da,0,0,0,0]];
Y.INIT=[[Y.dc.INIT,Y.ia.sc|Y.ia.tc],[Y.ra.ic,Y.ra.jc],[Y.Qa.lc,Y.Qa.hc,Y.Qa.kc,Y.Qa.gc],[0,0,0,0,[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11776,11984,11888,11776,11808,11776,12E3,12E3,11901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11808,11984,11856,11776,11808,11776,12E3,12E3,11881,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];k=W.prototype;k.reset=function(){this.c.INIT&&!this.restore(this.c.INIT)&&this.L("reset error")};
k.save=function(){var a=new E(this);switch(this.c.X){case X.X:G(a,0,[this.$,this.g,this.ba,this.C,this.I,this.U,this.Z]);break;case Y.X:G(a,0,[this.J,this.u]),G(a,1,[this.m,this.s]),G(a,2,[this.f,this.G,this.T,this.O]),G(a,3,[this.A,this.b,this.w,this.H,this.i])}return a.data()};
k.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.c.X){case X.X:return this.$=b[0],this.g=b[1],this.ba=b[2],this.C=b[3],this.I=b[4],this.U=b[5],this.Z=b[6],!0;case Y.X:return this.J=b[0],this.u=b[1],b=a[1],this.m=b[0],this.s=b[1],b=a[2],this.f=b[0],this.G=b[1],this.T=b[2],this.O=b[3],b=a[3],this.A=b[0],this.b=b[1],this.w=b[2],this.H=b[3],this.i=b[4],!0}return!1};k.start=function(){};k.stop=function(){};k.Lc=function(){return this.$};k.Mc=function(){return this.g};k.Nc=function(){return this.ba};
k.Kc=function(){return this.C>>8-this.I&255};k.$c=function(a,b){this.I=b};k.bd=function(a,b){this.U=b};k.ad=function(a,b){this.C=b<<8|this.C>>8};k.cd=function(a,b){this.Z=b};k.dd=function(){};function mc(a){var b=0,c=0,d=~a.A;for(a=0;10>a;a++)d&1&&(b=9-a),d>>=1;for(a=0;10>a;a++)d&1&&(c=9-a),d>>=1;return 10*b+c}
k.Oc=function(){var a=this.u,a=a&~Y.ia.Bb;if((Ib(this.a)&64)<<1&&(a|=Y.ia.Bb,a!=this.u)){var b,c;b=this.w&1;switch(this.w>>1&7){case Y.ja.ya.ac:this.A=this.A<<1|b;break;case Y.ja.ya.fc:b=mc(this);this.i[b]=Y.ja.Ua;break;case Y.ja.ya.bc:this.b=this.b<<1|b;break;case Y.ja.ya.Fc:b=mc(this);c=this.b&Y.ja.Ua;this.i[b]=c;break;case Y.ja.ya.Ac:b=mc(this);c=this.i[b];null==c&&(c=Y.ja.Ua);this.b=c;break;case Y.ja.ya.Bc:this.b<<=1,this.H=this.b&Y.ja.Ua+1}}a&=~Y.ia.Cb;this.H&&(a|=Y.ia.Cb);a&=~Y.ia.yb;if(b=this.j){b=
this.j;if(c=b.f)c=b.a,c=Ib(b.a)>=b.j+c.b.qa*c.b.pa/1E3*1.2731488;c&&(b.f=!1);b=!b.f}b&&(a|=Y.ia.yb);a&=~Y.ia.Eb;this.ea&&this.ea.ca&1&&(a|=Y.ia.Eb);return this.u=a};k.ed=function(a,b){this.J=b};k.hd=function(a,b){this.w=b};
k.gd=function(a,b){var c=b&3;switch(b>>2&3){case 0:this.f=this.f&-4|c;break;case 1:this.f=this.f&-13|c<<2;if(this.video){var c=this.video,d=this.f;c.hb!==d&&((c.hb=d)?nc(c,-1):c.jb=!0)}break;case 2:switch(c){case 0:this.G=~this.G;break;case 2:case 3:this.T=3-c}break;case 3:this.O=c}};
k.fd=function(a,b){if(b&Y.ra.zc)b&=Y.ra.Db,this.s!=b&&(this.s=b,this.video&&(this.video.Xb=this.s==Y.ra.Db?50:60));else if(b&=Y.ra.xb,this.m!=b&&(this.m=b,this.video)){var c=this.video,d=this.m==Y.ra.xb?132:80;c.H=d;c.R=c.Fb;80<d&&c.R--;oc(c)&&pc(c)}};X.cb={0:W.prototype.Lc,1:W.prototype.Mc,2:W.prototype.Nc,3:W.prototype.Kc};X.eb={2:W.prototype.$c,3:W.prototype.bd,4:W.prototype.ad,5:W.prototype.cd,6:W.prototype.dd};Y.cb={66:W.prototype.Oc};
Y.eb={66:W.prototype.ed,98:W.prototype.hd,162:W.prototype.gd,194:W.prototype.fd};ya(function(){for(var a=z(document,"pc8080","chipset"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new W(d);Qa(d,c)}});
function qc(a){r.call(this,"ROM",a,qc);this.b=null;this.j=a.addr;this.c=a.size;this.m=a.writable;this.f=a.alias;this.g=a.file;this.v=ca(this.g);if(this.g){a=this.g;var b=da(this.v);"json"!=b&&"hex"!=b&&(a=fa()+"/api/v1/dump?file="+this.g+"&format=bytes&decimal=true");var c=this;ma(a,null,!0,function(a,b,f){rc(c,a,b,f)})}}v(qc);var sc=[0,5];qc.prototype.ma=function(a,b,c,d){this.o=b;this.a=c;this.N=d;tc(this)};
qc.prototype.da=function(){this.i&&(this.N&&this.N.a(this.id,this.j,this.c,this.i),delete this.i);return!0};qc.prototype.ha=function(){return!0};
function rc(a,b,c,d){if(d)a.L("Unable to load system ROM (error "+d+": "+b+")");else{Ma(a.Sa,b,c);if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),f=e.bytes,h=e.data;if(f)a.b=f;else if(h)for(a.b=Array(4*h.length),d=c=0;c<h.length;c++)a.b[d++]=h[c]&255,a.b[d++]=h[c]>>8&255,a.b[d++]=h[c]>>16&255,a.b[d++]=h[c]>>24&255;else a.b=e;a.i=e.symbols;if(!a.b.length){p("Empty ROM: "+b);return}if(1==a.b.length){p(a.b[0]);return}}catch(g){a.L("ROM data error: "+g.message);return}else for(b=c.replace(/\n/gm,
" ").replace(/ +$/,"").split(" "),a.b=Array(b.length),e=0;e<b.length;e++)a.b[e]=aa(b[e]);tc(a)}}
function tc(a){if(!Sa(a))if(!a.g)A(a);else if(a.b&&a.o){a.c||(a.c=a.b.length);if(a.b.length!=a.c){var b="ROM size (0x"+m(a.b.length)+") does not match specified size ("+("0x"+m(a.c))+")";a.l.ua=!0;a.L(b)}else if(uc(a,a.j)){b=[];"number"==typeof a.f?b.push(a.f):null!=a.f&&a.f.length&&(b=a.f);for(var c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.o,h=d.c,g=[],l=d.j>>>f.c;0<h&&l<f.b.length;)g.push(f.b[l++]),h-=f.o;f=d.o;d=d.c;h=0;for(e>>>=f.c;0<d&&e<f.b.length;){l=g[h++];if(!l)break;f.b[e++]=l;d-=f.o}}delete a.b}A(a)}}
function uc(a,b){if(Za(a.o,b,a.c,a.m?1:nb)){var c;for(c=0;c<a.b.length;c++)eb(a.o,b+c,a.b[c]);if(a.m&&256==b){for(c=0;c<sc.length;c++)eb(a.o,sc[c],118);Qb(a.a,function(a){return function(b){if(0<=sc.indexOf(b)){var c=!1,h=a.a,g=a.N;if(5==b)switch(c=!0,h.D){case 2:vc(a,String.fromCharCode(h.F));break;case 9:for(var l=Wb(h),n="",x=255;x--;){var u=a.a.K(l++);if(36==u)break;n+=String.fromCharCode(u)}vc(a,n);break;default:c=!1}c?jc.call(h):g&&(a.aa("\nCP/M vector 0x"+m(b,4)),D(h,b),Db(g));b=!0}else b=
!1;return b}}(a));Sb(a.a,b)}return!0}return!1}function vc(a,b){b=b.replace(/\r/g,"");a.oa&&(a.oa.value+=b,a.oa.scrollTop=a.oa.scrollHeight)}ya(function(){for(var a=z(document,"pc8080","rom"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new qc(d);Qa(d,c)}});function wc(a){r.call(this,"RAM",a,wc);this.f=a.addr;this.c=a.size;this.b=!1}v(wc);k=wc.prototype;k.ma=function(a,b,c,d){this.o=b;this.a=c;this.N=d;A(this)};k.da=function(a,b){b||this.reset();return!0};k.ha=function(a){return a?this.save():!0};
k.reset=function(){!this.b&&this.c&&Za(this.o,this.f,this.c,1)&&(this.b=!0);this.b||p("No RAM allocated")};k.save=function(){return null};k.restore=function(){return!0};ya(function(){for(var a=z(document,"pc8080","ram"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new wc(d);Qa(d,c)}});function xc(a){r.call(this,"Keyboard",a,xc);(a=a.model)&&!yc[a]&&Aa("Unrecognized Keyboard8080 model: "+a);this.b=yc[a]||{};this.reset();A(this)}v(xc);
var zc={X:1978.1,h:{},wb:{65:37,68:39,76:32},Ea:{},sa:{"1p":49,"2p":50,coin:51,left:37,right:39,fire:32}},Z={X:100,h:{},wb:{},Ea:{},sa:{setup:120},cc:{Y:130,INIT:127},fa:{Y:130,qc:1,pc:2,oc:4,nc:8,rc:16,Ab:32,zb:63,Cc:64,nd:128,INIT:0},mc:127};Z.h[46]=3;Z.h[80]=5;Z.h[79]=6;Z.h[89]=7;Z.h[84]=8;Z.h[87]=9;Z.h[81]=10;Z.h[39]=16;Z.h[221]=20;Z.h[219]=21;Z.h[73]=22;Z.h[85]=23;Z.h[82]=24;Z.h[69]=25;Z.h[49]=26;Z.h[37]=32;Z.h[40]=34;Z.h[117]=35;Z.h[19]=35;Z.h[192]=36;Z.h[189]=37;Z.h[57]=38;Z.h[55]=39;
Z.h[52]=40;Z.h[51]=41;Z.h[27]=42;Z.h[38]=48;Z.h[114]=49;Z.h[112]=50;Z.h[8]=51;Z.h[187]=52;Z.h[48]=53;Z.h[56]=54;Z.h[54]=55;Z.h[53]=56;Z.h[50]=57;Z.h[9]=58;Z.h[103]=64;Z.h[115]=65;Z.h[113]=66;Z.h[96]=67;Z.h[118]=68;Z.h[220]=69;Z.h[76]=70;Z.h[75]=71;Z.h[71]=72;Z.h[70]=73;Z.h[65]=74;Z.h[104]=80;Z.h[2013]=81;Z.h[98]=82;Z.h[97]=83;Z.h[222]=85;Z.h[186]=86;Z.h[74]=87;Z.h[72]=88;Z.h[68]=89;Z.h[83]=90;Z.h[110]=96;Z.h[116]=97;Z.h[101]=98;Z.h[100]=99;Z.h[13]=100;Z.h[190]=101;Z.h[188]=102;Z.h[78]=103;
Z.h[66]=104;Z.h[88]=105;Z.h[119]=106;Z.h[105]=112;Z.h[99]=113;Z.h[102]=114;Z.h[109]=115;Z.h[191]=117;Z.h[77]=118;Z.h[32]=119;Z.h[86]=120;Z.h[67]=121;Z.h[90]=122;Z.h[120]=123;Z.h[17]=124;Z.h[16]=125;Z.h[20]=126;Z.Ea={l4:Z.fa.qc,l3:Z.fa.pc,l2:Z.fa.oc,l1:Z.fa.nc,locked:Z.fa.rc,local:Z.fa.Ab,online:~Z.fa.Ab};var yc={SI1978:zc,VT100:Z};
xc.prototype.S=function(a,b,c){var d=this,e=a+"-"+b;if(void 0===this.B[e]){if("led"==a&&this.b.Ea[b])return this.B[e]=c,!0;switch(b){case "kbd":return c.onkeydown=function(a){return Ac(d,a,!0)},c.onkeyup=function(a){return Ac(d,a,!1)},!0;default:if(this.b.sa&&void 0!==this.b.sa[b])return this.B[e]=c,a=function(a,b){return function(c){c.preventDefault();Cc(a,b,!0)}}(this,this.b.sa[b]),b=function(a,b){return function(){Cc(a,b,!1)}}(this,this.b.sa[b]),"ontouchstart"in window?(c.ontouchstart=a,c.ontouchend=
b):(c.onmousedown=a,c.onmouseup=c.onmouseout=b),!0}}return!1};xc.prototype.ma=function(a,b,c,d){this.v=a;this.a=c;this.N=d;this.M=B(a,"ChipSet");gb(b,this,this.b.cb);hb(b,this,this.b.eb)};xc.prototype.da=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};xc.prototype.ha=function(a){return a?this.save():!0};Z.INIT=[[Z.fa.INIT,Z.cc.INIT,!1,0,-1]];k=xc.prototype;k.reset=function(){this.c=[];this.b.INIT&&!this.restore(this.b.INIT)&&this.L("reset error")};
k.save=function(){var a=new E(this);switch(this.b.X){case Z.X:G(a,0,[this.i,this.g,this.f,this.j,-1])}return a.data()};k.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.b.X){case zc.X:return!0;case Z.X:return this.i=b[0],Dc(this,this.i&Z.fa.zb),this.g=b[1],this.f=b[2],this.j=b[3],this.o=b[4],!0}return!1};function Dc(a,b){for(var c in a.b.Ea){var d=a.B["led-"+c];if(d){var e=a.b.Ea[c],f=!!(b&e);e&e-1&&(f=!(b&~e));d.style.backgroundColor=f?"#ff0000":"#000000"}}}
function Ac(a,b,c){var d=!0,e;a:if(e=b.keyCode,e=a.b.wb[e]||e,!a.b.h[e]){for(var f in a.b.sa)if(a.b.sa[f]===e){e=f;break a}e=null}e&&(d=Cc(a,e,c),b.preventDefault());return d}
function Cc(a,b,c){var d;a:{for(d=0;d<a.c.length;d++)if(a.c[d].ub==b)break a;d=-1}if(c)0>d?a.c.push({ub:b,pb:Date.now(),Va:!1}):(a.c[d].pb=Date.now(),a.c[d].Va=!1);else if(0<=d){if(!a.c[d].Va){var e=a.c[d].pb;if(e&&100>Date.now()-e)return a.c[d].Va=!0,Ec(a),!0}a.c.splice(d,1)}if(a.M){d=0;switch(b){case "1p":d=X.ta.uc;break;case "2p":d=X.ta.yc;break;case "coin":d=X.ta.ec;break;case "left":d=X.ta.wc;break;case "right":d=X.ta.xc;break;case "fire":d=X.ta.vc}d&&(a=a.M,b=d,a.g&=~b,c&&(a.g|=b))}return!0}
function Ec(a){for(var b=0,c=-1;b<a.c.length;){if(a.c[b].Va){var d=a.c[b].ub,e=100-(Date.now()-a.c[b].pb);if(0<e){if(0>c||c>e)c=e}else{Cc(a,d,!1);b=0;continue}}b++}0<=c&&setTimeout(function(){Ec(a)},c)}k.Pc=function(){var a=this.g;0<=this.o&&(this.o<this.c.length?(a=this.c[this.o],this.o++,a=Z.h[a.ub],a&128&&(a&=127)):(this.o=-1,a=Z.mc),this.g=a,gc(this.a,1));return a};k.jd=function(a,b){this.i=b;this.f=!0;this.j=Ib(this.a);Dc(this,b&Z.fa.zb);b&Z.fa.Cc&&(this.o=0,gc(this.a,1))};Z.cb={130:xc.prototype.Pc};
Z.eb={130:xc.prototype.jd};ya(function(){for(var a=z(document,"pc8080","keyboard"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new xc(d);Qa(d,c)}});
function Fc(a,b,c,d,e){var f=this;this.Kb=sa("Gecko/");var h=["","moz","ms","webkit"];r.call(this,"Video",a,Fc);this.C=a.screenWidth;this.w=a.screenHeight;this.na=a.bufferAddr;this.Rc=a.bufferRAM;var g=a.bufferFormat;this.Z=g&&Gc[g.toUpperCase()]||Hc;this.H=a.bufferCols;this.$=a.bufferRows;this.Fb=this.R=a.cellWidth||1;this.P=a.cellHeight||1;this.ba=null;this.Ib=!1;this.Ta=a.bufferBits||1;this.Sc=a.bufferLeft||0;if(this.c=a.bufferRotate)this.c=this.c%360,0<this.c&&(this.c-=360),-90!=this.c&&(this.L("unsupported buffer rotation: "+
this.c),this.c=0);this.mb=a.interruptRate;this.Vc=a.refreshRate||60;this.u=b;this.f=c;this.T=(this.Wc=d)||b||null;this.Hc=this.C;this.Qc=this.w;this.Gb=this.C/this.H|0;this.Hb=this.w/this.$|0;1<this.P&&(this.$++,this.hb=0,this.jb=!1);b=a.smoothing;(c=Ga.smoothing)&&(b="true"==c);if(null!=b)for(c=0;c<h.length;c++)if(d=(d=h[c])?d+"ImageSmoothingEnabled":"imageSmoothingEnabled",void 0!==this.f[d]){this.f[d]=b;break}if(this.g=a.screenRotate)this.g=this.g%360,0<this.g&&(this.g-=360),-90!=this.g?(this.L("unsupported screen rotation: "+
this.g),this.g=0):(this.f.translate(0,this.w),this.f.rotate(this.g*Math.PI/180),this.f.scale(this.w/this.C,this.C/this.w));if(this.b=e)if(this.b.za=e.requestFullscreen||e.msRequestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen,this.b.za){for(c=0;c<h.length;c++)if(d=h[c]+"fullscreenchange","on"+d in document){document.addEventListener(d,function(){Ic(f,document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?!0:!1)},!1);
break}for(c=0;c<h.length;c++)if(d=h[c]+"fullscreenerror","on"+d in document){document.addEventListener(d,function(){Ic(f,null)},!1);break}}if(this.I=a.fontROM)"json"!=da(this.I)&&(this.I=fa()+"/api/v1/dump?file="+this.I+"&format=bytes"),ma(this.I,null,!0,function(a,b,c){Jc(f,a,b,c)});this.lb={}}v(Fc);var Hc=0,Gc={SI1978:1,VT100:2};
function oc(a){a.m=a.H*a.R;a.G=a.$*a.P;var b=a.m,c=a.G;a.c&&(b=a.G,c=a.m);a.A=0;if(!a.Rc&&(a.A=(a.m*a.Ta>>3)*a.G,!Za(a.o,a.na,a.A,3)))return!1;a.A?(a.Pb=a.f.createImageData(b,c),a.Sb=16/a.Ta|0,Kc(a,a.A>>1)):Kc(a,(a.H+1)*a.$);a.s=document.createElement("canvas");a.s.width=b;a.s.height=c;a.ib=a.s.getContext("2d");a.M={};a.U=1<<a.Ta;a.J=Array(a.U+2);a.J[0]=[0,0,0,255];a.J[1]=[255,255,255,255];1==a.Z&&(a.J[a.U+0]=[255,255,0,255],a.J[a.U+1]=[0,255,0,255]);2==a.Z&&(a.Xb=60,a.kb=!1,a.ea=Array(a.H));return!0}
Fc.prototype.ma=function(a,b,c,d){this.v=a;this.o=b;this.a=c;this.N=d;oc(this);if(this.j=B(a,"Keyboard")){for(var e in this.lb)this.j.S("led",e,this.lb[e]);this.u&&this.j.S(this.Wc?"textarea":"canvas","kbd",this.T)}this.I||A(this)};
function Jc(a,b,c,d){if(d)a.L("Unable to load font ROM (error "+d+": "+b+")");else{Ma(a.Sa,b,c);try{var e=eval("("+c+")"),f=e.bytes||e;if(!f||!f.length){p("Empty font ROM: "+b);return}if(1==f.length){p(f[0]);return}if(2048==f.length)a.ba=f,pc(a);else{a.L("Unrecognized font data length ("+f.length+")");return}}catch(h){a.L("Font ROM data error: "+h.message);return}(a.f||a.N)&&A(a)}}
function pc(a){a.ba&&(a.Ib=2==a.Z,a.M[96]=[Lc(a,a.R,a.P),Lc(a,a.R,a.P,a.kb)],a.M[64]=[Lc(a,2*a.R,a.P),Lc(a,2*a.R,a.P,a.kb)],a.M[32]=a.M[0]=[Lc(a,2*a.R,2*a.P),Lc(a,2*a.R,2*a.P,a.kb)])}
function Lc(a,b,c,d){var e=8>=a.Fb?8:16,f=8<e?15:0,h=a.ba.length/e,g=!1===d,l={R:b,P:c};l.canvas=document.createElement("canvas");l.canvas.width=16*b;l.canvas.height=h/16*c;l.context=l.canvas.getContext("2d");for(var n=l.context.createImageData(b,c),x=0;x<h;x++){for(var u=0,Q=u;u<a.P;u++)for(var H=x*e+(f+u&e-1),H=d&&8==u?255:a.ba[H],w=0;w<c/a.P;w++){for(var q=0,F=0,ba=F;F<a.R;F++){for(var R=H&128>>(7<F?7:F),q=a.Ib&&!R&&q?q:R,V=0;V<b/a.R;V++)g&&(q=!q),Mc(a,n,ba,Q,q?1:0),ba++;q=R}Q++}l.context.putImageData(n,
(x&15)*b,(x>>4)*c)}return l}Fc.prototype.da=function(){return!0};Fc.prototype.S=function(a,b,c){var d=this;if("led"==a||"rled"==a)return this.lb[b]=c,!0;switch(b){case "fullScreen":return this.B[b]=c,this.b&&this.b.za?c.onclick=function(){d.za()}:c.parentNode.removeChild(c),!0}return!1};
Fc.prototype.za=function(){var a=!1;if(this.b){if(this.b.za){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.C/this.w;b>c&&(a=Math.round(c/b*100)+"%")}this.Kb?(this.u.style.width=a,this.u.style.width=a,this.u.style.display="block",this.u.style.margin="auto"):(this.b.style.width=a,this.b.style.height="auto");this.b.style.backgroundColor="black";this.b.za();a=!0}this.T&&this.T.focus()}return a};
function Ic(a,b){!b&&a.b&&(a.Kb?a.u.style.width=a.u.style.height="":a.b.style.width=a.b.style.height="")}function Kc(a,b){a.Qb=b;a.O=!1;if(void 0===a.i||a.i.length!=a.Qb)a.i=Array(a.Qb)}function Mc(a,b,c,d,e){d=a.c?(b.height-c-1)*b.width+d:c+d*b.width;e&&1==a.Z&&(208<=c&&236>c?e=a.U+0:28<=c&&72>c&&(e=a.U+1));a=a.J[e];d*=a.length;b.data[d]=a[0];b.data[d+1]=a[1];b.data[d+2]=a[2];b.data[d+3]=a[3]}
function nc(a,b){var c=!0,d=!0;if(0<=b){d=!1;a.mb&&(120==a.mb?b&1?(gc(a.a,2),c=!1):gc(a.a,1):gc(a.a,4));var e;if(e=c&&a.O&&a.A){e=a.o;for(var f=a.A,h=!0,g=a.na>>>e.c;0<f&&g<e.b.length;)e.b[g].ka&&(e.b[g].ka=h=!1,e.b[g].Mb=!0),f-=e.o,g++;e=h}e&&(c=!1)}if(c)if(1<a.R)switch(a.Z){case 2:c=d;d=a.na;e=-1;for(var f=0,h=60==a.Xb?2:5,l=g=0,n=-1;f<a.$;){var x=0,u=d,Q=e,H=a.H;for(96!=Q&&(H>>=1);;){var w=bb(a.o,u++);if(127==(w&127)){var q=bb(a.o,u++);e=q&96;d=(q&15)<<8|bb(a.o,u);d+=q&16?8192:16384;break}if(x<
H)a.ea[x++]=w;else break}if(h)h--;else{for(;x<a.ea.length;)a.ea[x++]=0;if(0<=Q)for(u=a.O&&a.i[g]==H,a.i[g++]=H,H=0;H<x;H++){w=a.ea[H];if(!u||w!==a.i[g]){a.i[n=g]=w;var q=a,F=a.ib,ba=w&127;if(w=q.M[Q][w&128?1:0]){var R=(ba&15)*w.R,ba=(ba>>4)*w.P,V=void 0,Ca=void 0,Da=void 0,db=void 0,Bc=w.R,Hb=w.P;F?(V=H*q.R,Ca=f*q.P,Da=q.R,db=q.P):(V=H*q.Gb,Ca=f*q.Hb,Da=q.Gb,db=q.Hb);w.R>q.R&&(V*=2,Da*=2);w.P>q.P&&(0==Q&&(ba+=q.P),Hb=q.P);F?F.drawImage(w.canvas,R,ba,Bc,Hb,V,Ca,Da,db):(V+=0,Ca+=0,q.f.drawImage(w.canvas,
R,ba,Bc,Hb,V,Ca,Da,db))}l++}g++}f++}}a.O=!0;!c&&a.jb&&1==l&&(a.i[n]=-1,l=0);a.jb=!1;(l||c)&&a.ib&&a.f.drawImage(a.s,0,a.hb,a.m,a.G-a.P,0,0,a.Hc,a.Qc)}else{f=a.na;h=f+a.A;n=l=g=0;c=a.m;x=0;d=a.G;Q=e=0;u=a.Ta;H=(1<<u)-1;a.Sc&&(u=-u,Q=16+u);for(;f<h;){q=a.o;F=f;w=F&q.f;R=(F&q.g)>>>q.c;q=w!=q.f?q.b[R].Yb(w,F):q.b[R++].fb(w,F)|q.b[R&q.s].fb(0,F+1)<<8;if(a.O&&q===a.i[g])l+=a.Sb;else{a.i[g]=q;(F=Q)&&(q=q>>8|(q&255)<<8);l<c&&(c=l);for(w=a.Sb;w--;)R=q>>F&H,Mc(a,a.Pb,l++,n,R),F+=u;l>x&&(x=l);n<d&&(d=n);n>=
e&&(e=n+1)}f+=2;g++;if(l>=a.m&&(l=0,n++,n>a.G))break}a.O=!0;c<a.m&&(f=x-c,e-=d,a.c&&(h=c,g=f,c=d,f=e,d=a.m-(h+g),e=g),a.ib.putImageData(a.Pb,0,0,c,d,f,e),a.f.drawImage(a.s,0,0,a.s.width,a.s.height,0,0,a.C,a.w))}}
ya(function(){for(var a=z(document,"pc8080","video"),b=0;b<a.length;b++){var c=a[b],d=y(c),e=document.createElement("canvas");if(void 0===e||!e.getContext){c.innerHTML="<br/>Missing &lt;canvas&gt; support. Please try a newer web browser.";break}e.setAttribute("class","pcjs-canvas");e.setAttribute("width",d.screenWidth);e.setAttribute("height",d.screenHeight);e.style.backgroundColor=d.screenColor;e.style.height="auto";0<=(window?window.navigator.userAgent:"").indexOf("MSIE")&&(c.onresize=function(a,
b,c,d){return function(){b.style.height=(a.clientWidth*d/c|0)+"px"}}(c,e,d.screenWidth,d.screenHeight),c.onresize());var f=+(d.aspect||Ga.aspect);f&&.3<=f&&3.33>=f&&(xa("onresize",function(a,b,c){return function(){b.style.height=(a.clientWidth/c|0)+"px"}}(c,e,f)),window.onresize());c.appendChild(e);f=document.createElement("textarea");sa("iOS")&&(f.setAttribute("autocapitalize","off"),f.setAttribute("autocorrect","off"));c.appendChild(f);var h=e.getContext("2d"),d=new Fc(d,e,h,f,c);Qa(d,c)}});
function Nc(a){this.H=+a.adapter;switch(this.H){case 0:this.I=0;this.O=2;break;default:p("Unrecognized serial adapter #"+this.H);return}this.b=this.c=null;this.J=a.tabSize;this.G=a.charBOL;this.f=0;this.A=!1;r.call(this,"SerialPort",a,Nc);var b=a.binding;if("console"==b)this.c="";else{var c;a=Oc;b&&(void 0===c&&(c="Panel"),(c=Pa(c,this.id))&&(b=c.B[b])&&this.S(null,a,b))}this.g="";this.i=this.m=null;this.exports={connect:this.Tb,receiveData:this.sb}}v(Nc);
var Pc=[50,75,110,134.5,150,200,300,600,1200,1800,2E3,2400,3600,4800,9600,19200],Qc=[!1,0,0,133,142,39,238],Oc="buffer";k=Nc.prototype;
k.S=function(a,b,c,d){var e=this;switch(b){case Oc:return this.B[b]=this.b=c,c.onkeydown=function(a){a=a||window.event;var b=a.keyCode;if(8===b||a.ctrlKey&&65<=b&&90>=b)a.preventDefault&&a.preventDefault(),64<b&&(b-=64),Rc(e,b);return!0},c.onkeypress=function(a){a=a||window.event;Rc(e,a.which||a.keyCode);a.preventDefault&&a.preventDefault();return!0},c.removeAttribute("readonly"),!0;default:if(d)return this.B[b]=c,d=d.replace(/\\e/g,String.fromCharCode(27)),c.onclick=function(){e.sb(d);return!0},
!0}return!1};k.ma=function(a,b,c,d){this.v=a;this.o=b;this.a=c;this.N=d;var e=this;this.T=Kb(this.a,function(){e.sb()});this.U=Kb(this.a,function(){e.ca|=5});this.M=B(a,"ChipSet");gb(b,this,Sc,this.I);hb(b,this,Tc,this.I);A(this)};
k.Tb=function(){if(!this.i){var a=yb(this.v,"connection");if(a){var b=a.split("->");if(2==b.length){var c=ia(b[0]);if(c!=this.Ra)return;b=ia(b[1]);if(this.i=Oa(b)){var d=this.i.exports;if(d){var e=d.connect;e&&e.call(this.i);if(this.m=d.receiveData){this.status(this.Sa+"."+c+" connected to "+b);return}}}}this.status("Unable to establish connection: "+a)}}};k.da=function(a,b){if(!b)if(this.Tb(),!a||!this.restore)this.reset();else if(!this.restore(a))return!1;return!0};
k.ha=function(a){return a?this.save():!0};k.reset=function(){Uc(this)};k.save=function(){var a=new E(this),b=0,c=[];c[b++]=this.ga;c[b++]=this.w;c[b++]=this.C;c[b++]=this.ca;c[b++]=this.j;c[b++]=this.u;c[b]=this.s;G(a,0,c);return a.data()};k.restore=function(a){return Uc(this,a[0])};function Uc(a,b){var c=0;void 0===b&&(b=Qc);a.ga=b[c++];a.w=b[c++];a.C=b[c++];a.ca=b[c++];a.j=b[c++];a.u=b[c++];a.s=b[c];return!0}
function Vc(a,b){var c=a.s&b;b&15||(c>>=4);var c=Pc[c],d=((a.j&12)>>2)+6;a.j&16&&d++;d+=((a.j&192)>>6)+1>>1;return 1E3/Math.round(c/d)}function Rc(a,b){return a.A||a.ca&2?!1:(a.w=b,a.ca|=2,gc(a.a,a.O),!0)}k.sb=function(a){null!=a&&(this.g="number"!=typeof a?a:this.g+String.fromCharCode(a));this.g&&(Rc(this,this.g.charCodeAt(0))&&(this.g=this.g.substr(1)),this.g&&this.a&&Lb(this.a,this.T,Vc(this,15)));return!0};k.Jc=function(){var a=this.w;this.ca&=-3;return a};k.Ic=function(){return this.ca};
k.Zc=function(a,b){this.C=b;this.ca&=-6;if(19==b)this.A=!0;else if(17==b)this.A=!1;else if(this.m&&this.m.call(this.i,b),this.b)if(8==b)this.b.value=this.b.value.slice(0,-1),0<this.f&&this.f--;else{var c;c=(c=ja[b])?"<"+c+">":String.fromCharCode(b);var d=c.length;9==b?(d=this.J||8,d=d-this.f%d,this.J&&(c="                                        ".slice(0,d))):13==b&&(this.f=d=0,c="\n");this.G&&!this.f&&d&&(c=String.fromCharCode(this.G)+c);this.b.value+=c;this.b.scrollTop=this.b.scrollHeight;this.f+=
d}else if(null!=this.c){if(10==b||1024<=this.c.length)this.aa(this.c),this.c="";10!=b&&(this.c+=String.fromCharCode(b))}this.a&&Lb(this.a,this.U,Vc(this,240))};k.Yc=function(a,b){this.ga?(this.u=b,this.u&64&&(this.ga=!1)):(this.j=b,this.ga=!0)};k.Xc=function(a,b){this.s=b};var Sc={0:Nc.prototype.Jc,1:Nc.prototype.Ic},Tc={0:Nc.prototype.Zc,1:Nc.prototype.Yc,2:Nc.prototype.Xc};ya(function(){for(var a=z(document,"pc8080","serial"),b=0;b<a.length;b++){var c=a[b],d=y(c),d=new Nc(d);Qa(d,c)}});
function Wc(a,b,c){r.call(this,"Computer",a,Wc);this.l.V=!1;Xc(this,b);this.w=yb(this,"autoPower",a);this.f=0;this.I=a.busWidth||a.buswidth;this.b=Yc;this.s=null;this.m=this.G=!1;this.M=yb(this,"url")||"";(Math.random()+.1).toString(36);this.c=Zc(this);if(this.a=Pa("CPU",this.id)){this.N=Pa("Debugger",this.id);this.j=[];for(b=null;b=B(this,"Video",b);)this.j.push(b);this.o=new Xa({id:this.Sa+".bus",busWidth:this.I},this.a,this.N);var d,e=Na(this.id);if((this.g=Pa("Panel",this.id))&&this.g.oa)for(b=
0;b<e.length;b++)d=e[b],d.L=this.g.L,d.aa=this.g.aa,d.oa=this.g.oa;this.aa("PC8080 v1.24.1\nCopyright \u00a9 2012-2016 Jeff Parsons <Jeff@pcjs.org>\nLicense: GPL version 3 or later <http://gnu.org/licenses/gpl.html>");for(b=0;b<e.length;b++)d=e[b],d.ma&&d.ma(this,this.o,this.a,this.N);b=null;d=a.resume;void 0!==d&&(1<d.length?b=this.v=d:this.b=parseInt(d,10));var f;if(a=yb(this,"state")||(f=!0,a.state))b=this.A=a,f||(this.m=!0,this.b=Yc),this.b&&(this.u=new E(this,"1.24.1"),$c(this.u)?b=null:delete this.u);
!b&&this.b&&(b=ad(this))&&(this.m=!0);if(b){var h=this;ma(b,null,!0,function(a,b,c){c?(h.v=null,h.m=!1,h.L("Unable to load machine state from server (error "+c+(b?": "+ia(b):"")+")")):(h.s=b,h.G=!0);A(h)})}else A(this);this.B.power||(this.w=!0);!c&&this.w&&bd(this,this.Na)}else p("Unable to find CPU component")}v(Wc);var Yc=0;function Xc(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){p(d.message+" ("+c+")")}}a.H=b}
function yb(a,b,c){var d=b.toLowerCase(),d=Ga[b]||Ga[d];void 0===d&&a.H&&(d=a.H[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}function bd(a,b,c){for(var d=Na(a.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:a;if(!Sa(f)){Sa(f,function(){bd(a,b,c)});return}}b.call(a,c)}
function cd(a,b){var c=new E(a,"1.24.1","validate");if($c(c)&&dd(c)){var d=ed(c,"timestamp"),e=b?ed(b,"timestamp"):"unknown";d!=e&&(a.L("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}k=Wc.prototype;
k.Na=function(a){void 0===a&&(a=this.b||(this.s?1:Yc));if(!this.f){this.f++;var b=!1,c=!1;this.C=!1;var d=this.u||new E(this,"1.24.1");if(-1==a)b=!0;else if(a>Yc){if($c(d,this.s)){this.i=new E(this,"1.24.1","failsafe");$c(this.i)&&(fd(this,d),a=2,gd(this.i));G(this.i,"timestamp",la());hd(this.i);var e=this.b&&!this.m;if(1==a||na("Click OK to restore the previous PC8080 machine state, or CANCEL to reset the machine.")){if(c=dd(d)){var f=ed(d,"code"),h=ed(d,"data");f&&("ok"==f?$c(d,h):("error"==f&&
"no machine state"!=h?(this.L("Error: "+h),"unable to verify user"==h&&(ra("user",""),this.c=null)):this.aa(f+": "+h),gd(d),$c(d)?(c=dd(d),e=!0):c=!1))}e&&cd(this,c?d:null)}else 2==a&&d.clear()}else cd(this);delete this.s;delete this.u}e=Na(this.id);for(f=0;f<e.length;f++)h=e[f],h!==this&&h!=this.a&&(c=id(this,h,d,b,c));b=[d,a,c];-1!=a?bd(this,this.Jb,b):this.Jb(b)}};
function id(a,b,c,d,e){if(!b.l.V){b.l.V=!0;if(b.da){var f=null;e&&((f=ed(c,b.id))||(f=ed(c,b.id.replace(/[a-z0-9]\./i,"."))));"string"===typeof f&&(f=null);!b.da(f,d)&&f&&(p("Unable to restore state for "+b.type),a.A&&!a.G?(c.clear(),a.b=Yc,window&&window.location.reload()):a.C=!0,b.da(null),e=!1)}if(!d&&b.vb)for(a=b.vb.split("|"),c=0;c<a.length;c++)b.status(a[c])}return e}
k.Jb=function(a){var b=a[0],c=0>a[1];a=a[2];this.J=!0;this.l.V=!0;var d=this.B.power;d&&(d.textContent="Shutdown");this.a&&(id(this,this.a,b,c,a),Cb(this.a));this.C&&(fd(this,b),b.clear());!c&&this.i&&(this.i.clear(),delete this.i);this.f=0};
function fd(a,b){if(na("There may be a problem with your PC8080 machine.\n\nTo help us diagnose it, click OK to send this PC8080 machine state to http://www.pcjs.org.")){var c=a.c||"",d=b.toString(),e={app:"PC8080",ver:"1.24.1"};e.url=a.M;e.user=c;e.type="bug";e.data=d;ma("http://www.pcjs.org/api/v1/report",e,!0)}}
function jd(a,b,c){var d,e="none";if(a.f)return null;a.f--;var f=new E(a,"1.24.1"),h=new E(a,"1.24.1","validate"),g=la();G(h,"timestamp",g);G(f,"timestamp",g);G(f,"version","1.24.1");G(f,"url",window?window.location.href:null);G(f,"browser",window?window.navigator.userAgent:"");a.a&&a.a.ha&&(c&&Db(a.a),d=a.a.ha(b,c),"object"===typeof d&&G(f,a.a.id,d),c&&(a.a.l.V=!1,!1===d&&(e=null)));for(var g=Na(a.id),l=0;l<g.length;l++){var n=g[l];n.l.V&&(n.ha&&(d=n.ha(b,c),"object"===typeof d&&G(f,n.id,d)),c&&
(n.l.V=!1,!1===d&&(e=null)))}e&&(c?(g=d=!1,b?(a.c&&kd(a,a.c,f.toString()),hd(h)&&hd(f)||(e=null,d=g=!0)):a.b&&(d=!0,g=3==a.b),d&&f.clear(g)):e=f.toString());c&&(a.l.V=!1,b=a.B.power)&&(b.textContent="Power");a.f=0;return e}k.reset=function(){this.o&&this.o.reset&&this.o.reset();for(var a=Na(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.o&&c.reset&&c.reset()}};k.start=function(a,b){for(var c=Na(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}};
k.stop=function(a,b){for(var c=Na(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}};
k.S=function(a,b,c){var d=this;switch(b){case "power":return this.B[b]=c,c.onclick=function(){d.f||(d.l.V?jd(d,!1,!0):bd(d,d.Na))},!0;case "reset":return this.B[b]=c,c.onclick=function(){if(d.l.V&&!d.f)if(d.b&&!d.v){var a=na("Click OK to save changes to this PC8080 machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");jd(d,a,!0);!a&&d.A?window&&window.location.reload():d.Na(Yc)}else d.reset(),d.a&&Cb(d.a)},!0;case "save":if(ea()){c.parentNode.removeChild(c);break}this.B[b]=c;c.onclick=
function(){var a=Zc(d,!0);if(a){var b=!!(d.b&&!d.v||d.A),c=jd(d,b);b?kd(d,a,c):d.L("Resume disabled, machine state not saved")}};return!0}return!1};function Zc(a,b){var c=a.c;c||(c=qa("user"),void 0!==c?!c&&b&&(c=null,window&&(c=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c&&((c=ld(a,c))||a.L("The user ID is invalid."))):b&&a.L("Browser local storage is not available"));return c}
function ld(a,b){a.c=null;var c=ma(fa()+"/api/v1/user?req=verify&user="+b),d=c[1];if(!c[0]&&d)try{c=eval("("+d+")"),c.code&&"ok"==c.code&&(ra("user",c.data),a.c=c.data)}catch(e){p(e.message+" ("+d+")")}return a.c}function ad(a){var b=null;a.c&&(b=fa()+"/api/v1/user?req=load&user="+a.c+"&state="+md(a,"1.24.1"));return b}
function kd(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=md(a,"1.24.1");d.data=c;b=ma(fa()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.L("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.L(c),ra("user",""),a.c=null)}}
function B(a,b,c){a=Na(a.id);for(var d=0;d<a.length;d++){var e=a[d];if(c)c==e&&(c=null);else if(e.type==b)return e}return null}function Jb(a,b){if(a.j.length){var c=0,d=0;!b&&window&&(c=window.scrollX,d=window.scrollY);var e=a.j[0];e.T&&e.T.focus();!b&&window&&window.scrollTo(c,d)}}k.xa=function(a){this.a&&this.a.xa(a);this.g&&this.g.xa(a)};function Mb(a,b){for(var c=0;c<a.j.length;c++)nc(a.j[c],b)}
ya(function(){for(var a=z(document,"pc8080-machine"),b=0;b<a.length;b++)for(var c=a[b],d=y(c),c=z(c,"pc8080","computer"),e=0;e<c.length;e++){var f=c[e],h=y(f),h=new Wc(h,d,!0);Qa(h,f);h.w&&bd(h,h.Na)}});ta.show.push(function(){for(var a=z(document,"pc8080","computer"),b=0;b<a.length;b++){var c=y(a[b]);(c=Pa("Computer",c.id))&&c.J&&!c.l.V&&c.Na(-1)}});
ta.exit.push(function(){for(var a=z(document,"pc8080","computer"),b=0;b<a.length;b++){var c=y(a[b]);(c=Pa("Computer",c.id))&&c.l.V&&jd(c,!(!c.b||c.v),!0)}});function E(a,b,c){this.id=a.id;this.key=md(a,b,c);this.N=a.N;gd(this,a.Tc)}function md(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}
E.prototype={constructor:E,value:function(){return this[this.id]},data:function(){return this[this.id]},toString:function(){var a=this[this.id];return"string"==typeof a?a:JSON.stringify(a)},clear:function(a){gd(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(e){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(e){}b.splice(c,1);c=0}}};
function gd(a,b){a[a.id]={};b&&G(a,"parms",b);a.a=!1}function hd(a){var b=!0;if(pa()){var c=JSON.stringify(a[a.id]);ra(a.key,c)||(p("Unable to store "+c.length+" bytes in browser local storage"),b=!1)}return b}function dd(a){var b=!0;try{a[a.id]=JSON.parse(a[a.id])}catch(c){p(c.message||c),b=!1}return b}function $c(a,b){return b?(a[a.id]=b,a.a=!0):a.a?!0:pa()&&(b=qa(a.key))?(a[a.id]=b,a.a=!0):!1}function ed(a,b){return a[a.id][b]||null}function G(a,b,c){try{a[a.id][b]=c}catch(d){}}var nd=0;
function od(a,b,c,d,e,f){e("Loading "+a+"...");ma(a,null,!0,function(h,g,l){l?(g||(g="unable to load "+a+" ("+l+")"),f(g,null)):pd(g,a,b,c,d,e,f)})}
function pd(a,b,c,d,e,f,h){function g(a,f){if(f)h(f,null);else{if(c){Ma(c,b,a);var g=b;g&&0>g.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(g=window.location.pathname+g);d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{";d+='url:"'+g+'"}';"object"==typeof resources&&(g=null);a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(d?" parms='"+d+"'":"")+(g?' url="'+g+'"':""))}e||(a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pc8080$2"));
g=null;if("<"==a.charAt(0))try{e||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(g=new window.ActiveXObject("Microsoft.XMLDOM"),g.async=!1,g.loadXML(a)):g=(new window.DOMParser).parseFromString(a,"text/xml")}catch(u){g=null,a=u.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);h(a,g)}}a?e?qd(a,f,g):g(a,null):h("no data"+(b?" for file: "+b:""),null)}
function qd(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var e=d[2];b("Loading "+e+"...");ma(e,null,!0,function(f,h,g){if(g||!h)c(a,"unable to resolve XML reference: "+d[0]+" ("+g+")");else{if(f=d[3])if(g=h.match(new RegExp("<"+d[1]+"[^>]*>"))){for(var l=g[0],n,x=/( [a-z]+=)(['"])(.*?)\2/g;n=x.exec(f);)l=0>l.indexOf(n[1])?l.replace(">",n[0]+">"):l.replace(new RegExp(n[1]+"(['\"])(.*?)\\1"),n[0]);g[0]!=l&&(h=h.replace(g[0],l))}else{c(a,"missing <"+d[1]+"> in "+e);return}h=h.replace(/<\?xml[^>]*>[\r\n]*/,
"");a=a.replace(d[0],h);qd(a,b,c)}})}else c(a,null)}
function rd(a,b,c,d){function e(a){if(void 0===g){var b=h&&z(h,"machine-warning");g=b&&b[0]||h}g&&(g.innerHTML=ha(a))}function f(a){e("Error: "+a);l&&(--nd||Ba(!0));l=!1}var h,g,l=!0;nd++;La[a]={};try{if(h=document.getElementById(a)){var n;if("object"==typeof resources&&(n=resources.css)){var x=document.head||document.getElementsByTagName("head")[0],u=document.createElement("style");u.type="text/css";u.styleSheet?u.styleSheet.cssText=n:u.appendChild(document.createTextNode(n));x.appendChild(u)}c||
(c="/versions/pc8080/1.24.1/components.xsl");n=function(d,g){g?od(c,null,null,!1,e,function(d,l){if(l)if(Ma(a,c,d),e("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window){var n=g.transformNode(l);n?(h.outerHTML=n,--nd||Ba(!0)):f("transformNodeToObject failed")}else document.implementation&&document.implementation.createDocument?(n=new XSLTProcessor,n.importStylesheet(l),(n=n.transformToFragment(g,document))?h.parentNode?(h.parentNode.replaceChild(n,h),--nd||Ba(!0)):f("invalid machine element: "+
a):f("transformToFragment failed")):f("unable to transform XML: unsupported browser");else f(d)}):f(d)};"<"!=b.charAt(0)?od(b,a,d,!0,e,n):pd(b,null,a,d,!1,e,n)}else f("missing machine element: "+a)}catch(Q){f(Q.message)}return l}window.embedPC8080=function(a,b,c,d){Ba(!1);return rd(a,b,c,d)};window.enableEvents=Ba;window.sendEvent=Ea;})();
