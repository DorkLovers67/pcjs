(function(){var m;function ca(a,b){var c;if(a){b||(b=16);if("$"==a.charAt(0))b=16,a=a.substr(1);else if("0x"==a.substr(0,2))b=16,a=a.substr(2);else{var d=a.charAt(a.length-1).toLowerCase();"h"==d?(b=16,d=null):"."==d&&(b=10,d=null);null==d&&(a=a.substr(0,a.length-1))}var e,d=a,f=b;(f&&10!=f?16==f?null!==d.match(/^[0-9a-f]+$/i):2==f&&null!==d.match(/^[01]+$/i):null!==d.match(/^[0-9]+$/))&&!isNaN(e=parseInt(a,b))&&(c=e|0)}return c}
function n(a,b){var c="";void 0===b?b=8:8<b&&(b=8);if(null==a||isNaN(a))for(;0<b--;)c="?"+c;else for(;0<b--;){var d=a&15,d=d+(0<=d&&9>=d?48:55),c=String.fromCharCode(d)+c;a>>=4}return c}function da(a){return"0x"+n(a,2)}function t(a){return"0x"+n(a,4)}function ea(a){var b=a,c=a.lastIndexOf("/");0<=c&&(b=a.substr(c+1));c=b.indexOf("&");0<c&&(b=b.substr(0,c));return b}function fa(a){var b="",c=a.lastIndexOf(".");0<=c&&(b=a.substr(c+1).toLowerCase());return b}
function ga(){var a=ha();return-1!==a.indexOf("pcjs.org",a.length-8)}var ja={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function ka(a){return a.replace(/[&<>"']/g,function(a){return ja[a]})}function la(a,b){return(a+"                                        ").slice(0,b)}function ma(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}
var na={0:"NUL",1:"SOH",2:"STX",3:"ETX",4:"EOT",5:"ENQ",6:"ACK",7:"BEL",8:"BS",9:"TAB",11:"VT",12:"FF",13:"CR",14:"SO",15:"SI",16:"DLE",17:"XON",18:"DC2",19:"XOFF",20:"DC4",21:"NAK",22:"SYN",23:"ETB",24:"CAN",25:"EM",26:"SUB",27:"ESC",28:"FS",29:"GS",30:"RS",31:"US"};function oa(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(a,b){return a>b?1:a<b?-1:0});d<e;){var h=d+e>>1,g;g=c(b,a[h]);0<g?d=h+1:(e=h,f=!g)}return f?d:~d}var pa=Date.now||function(){return+new Date};
function qa(){function a(a){return(10>a?"0":"")+a}var b=new Date;return b.getFullYear()+"-"+a(b.getMonth()+1)+"-"+a(b.getDate())+" "+a(b.getHours())+":"+a(b.getMinutes())+":"+a(b.getSeconds())}function ra(a,b){var c;if(Array.prototype.indexOf)return a.indexOf(b,c);c=c||0;0>c&&(c+=a.length);0>c&&(c=0);for(var d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1}
function sa(a,b,c,d){var e=0,f=null,h=null;if("object"==typeof resources&&(f=resources[a]))return d&&d(a,f,e),[f,e];if(c&&"function"==typeof resources)return resources(a,function(b,c){d&&d(a,b,c)}),h;var g=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");c&&(g.onreadystatechange=function(){4===g.readyState&&(f=g.responseText,200==g.status||!g.status&&f.length&&"file:"==(window?window.location.protocol:"file:")||(e=g.status||-1),d&&d(a,f,e))});if(b&&"object"==
typeof b){var k="",l;for(l in b)b.hasOwnProperty(l)&&(k&&(k+="&"),k+=l+"="+encodeURIComponent(b[l]));k=k.replace(/%20/g,"+");g.open("POST",a,!!c);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.send(k)}else g.open("GET",a,!!c),"bytes"==b&&g.overrideMimeType("text/plain; charset=x-user-defined"),g.send();c||(f=g.responseText,200!=g.status&&(e=g.status||-1),d&&d(a,f,e),h=[f,e]);return h}function ha(){return"http://"+(window?window.location.host:"www.pcjs.org")}
function ta(){return window?window.navigator.userAgent:""}function v(a){window&&window.alert(a)}function va(a){var b=!1;window&&(b=window.confirm(a));return b}var wa=null;function xa(){if(null==wa){var a=!1;if(window)try{window.localStorage.setItem("PCjs.localStorage","PCjs.localStorage"),a="PCjs.localStorage"==window.localStorage.getItem("PCjs.localStorage"),window.localStorage.removeItem("PCjs.localStorage")}catch(b){a=!1}wa=a}return wa}
function ya(a){var b;if(window)try{b=window.localStorage.getItem(a)}catch(c){}return b}function za(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){}return!1}function Aa(a){if(window){var b=ta();return"iOS"==a&&b.match(/(iPod|iPhone|iPad)/)&&b.match(/AppleWebKit/)||"MSIE"==a&&b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)?!0:!1}return!1}function Ba(a,b,c){function d(){--a;0<=a&&(b()||(a=0));0<a?setTimeout(d,0):c()}d()}
function Ca(a,b){function c(){b(100===d)&&(e=setTimeout(c,d),d=100)}var d=0,e=null,f=!1;a.onmousedown=function(){f||e||(d=500,c())};a.ontouchstart=function(){e||(d=500,c())};a.onmouseup=a.onmouseout=function(){e&&(clearTimeout(e),e=null)};a.ontouchend=a.ontouchcancel=function(){e&&(clearTimeout(e),e=null);f=!0}}var Da={init:[],show:[],exit:[]},Ea=!1,Ja=!1,Ka=!0;function La(a,b){if(window){var c=window[a];window[a]="function"!==typeof c?b:function(){c&&c();b()}}}function Ma(a){Da.init.push(a)}
function Na(a){if(Ka)try{for(var b=0;b<a.length;b++)a[b]()}catch(c){Oa("An unexpected exception occurred:\n\n"+c.message+"\n\nPlease send this information to support@pcjs.org. Thanks.",void 0,void 0)}}function Pa(a){!Ka&&a?(Ka=!0,Ea&&Qa("init"),Ja&&Qa("show")):Ka=a}function Qa(a){Da[a]&&Na(Da[a])}La("onload",function(){Ea=!0;Na(Da.init)});La("onpageshow",function(){Ja=!0;Na(Da.show)});La(Aa("Opera")||Aa("iOS")?"onunload":"onbeforeunload",function(){Na(Da.exit)});
function w(a,b,c,d){this.type=a;b||(b={id:"",name:""});this.id=b.id||"";this.name=b.name;this.tc=b.comment;this.Xd=b;b=this.id.indexOf(".");0>b?this.Za=this.id:(this.Kb=this.id.substr(0,b),this.Za=this.id.substr(b+1));this[a]=c;this.D={Ma:!1,jb:!1,Ub:!1,va:!1,lb:!1};this.Nb=null;this.D.lb=!1;this.M={};this.I=null;this.ra=d||0;Ta.push(this)}var Ua=void 0,Va={};
if(window){Ua||(Ua=window.location.search.substr(1));for(var Wa,Za=/\+/g,$a=/([^&=]+)=?([^&]*)/g;Wa=$a.exec(Ua);)Va[decodeURIComponent(Wa[1].replace(Za," "))]=decodeURIComponent(Wa[2].replace(Za," "))}function ab(a){function b(){}if(window){if(!a)throw new TypeError;if(Object.create)return Object.create(a);var c=typeof a;if("object"!==c&&"function"!==c)throw new TypeError;}b.prototype=a;return new b}
function bb(a,b){b||(b=w);a.prototype=ab(b.prototype);a.prototype.constructor=a;a.prototype.parent=b.prototype}if(window){window.PCjs||(window.PCjs={});var cb=window.PCjs.Machines||(window.PCjs.Machines={}),Ta=window.PCjs.Components||(window.PCjs.Components=[])}else cb={},Ta=[];function db(a,b,c){cb[a]&&b&&(cb[a][b]=c)}function Oa(a,b,c){b||v((c?c+": ":"")+a)}
function eb(a){var b,c=[];a&&(a=0<(b=a.indexOf("."))?a.substr(0,b+1):"");for(b=0;b<Ta.length;b++){var d=Ta[b];a&&d.id.indexOf(a)||c.push(d)}return c}function fb(a){if(void 0!==a){var b;for(b=0;b<Ta.length;b++)if(Ta[b].id===a)return Ta[b]}return null}function gb(a,b){var c;if(void 0!==a){var d;b&&(b=0<(d=b.indexOf("."))?b.substr(0,d+1):"");for(d=0;d<Ta.length;d++)if(c)c==Ta[d]&&(c=null);else if(!(a!=Ta[d].type||b&&Ta[d].id.indexOf(b)))return Ta[d]}return null}
function z(a){var b=null;if(a=a.getAttribute("data-value"))try{b=eval("("+a+")")}catch(c){v(c.message+" ("+a+")")}return b}function hb(a,b){for(var c=C(b.parentNode,"pc8080-control"),d=0;d<c.length;d++)for(var e=c[d].childNodes,f=0;f<e.length;f++){var h=e[f];if(1===h.nodeType){var g=h.getAttribute("class");if(g)for(var k=g.split(" "),l=0;l<k.length;l++)switch(g=k[l],g){case "pc8080-binding":(g=z(h))&&g.binding&&a.la(g.type,g.binding,h,g.value),l=k.length}}}}
function C(a,b,c){c&&(b+="-"+c+"-object");if(a.getElementsByClassName)return a.getElementsByClassName(b);var d;c=[];a=a.getElementsByTagName("*");var e=new RegExp("(^| )"+b+"( |$)");b=0;for(d=a.length;b<d;b++)e.test(a[b].className)&&c.push(a[b]);return c}
w.prototype={constructor:w,parent:null,toString:function(){return this.name?this.name:this.id||this.type},la:function(a,b,c){switch(b){case "clear":return this.M[b]||(this.M[b]=c,c.onclick=function(a){return function(){a.M.print&&(a.M.print.value="")}}(this)),!0;case "print":return this.M[b]||(this.Fa=this.M[b]=c,c.value="",this.g=function(a){return function(b,c){8192<a.value.length&&(a.value=a.value.substr(a.value.length-4096));a.value+=(void 0!==c?c+": ":"")+(b||"")+"\n";a.scrollTop=a.scrollHeight}}(c),
this.ia=function(a){this.g(a,this.Za)}),!0;default:return!1}},log:function(){},g:function(){},status:function(a){this.g(this.Za+": "+a)},ia:function(a,b,c){Oa(a,b,c||this.type)},Ea:function(){return this.D.va=!0},Ha:function(a,b){b&&(this.D.va=!1);return!0}};function D(a,b,c,d,e,f,h){a.I&&(!0===h?h=0:null==h&&(h=a.ra),ib(a.I,a,b,c,d,e,f,h))}function jb(a,b){a.I&&kb(a,0)&&a.I.message(b,void 0)}function kb(a,b){if(a.I){a===a.I?b|=0:b=b||a.ra;var c=a.I.ra&b;return!!b&&c===b||!!(c&a.I.vd)}return!1}
function lb(a,b){if(a.D.Ub)return a.D.jb&&(a.D.jb=!1),a.D.Ub=!1;if(a.D.lb)return a.g(a.toString()+" error"),!1;a.D.jb=b;return a.D.jb}function mb(a,b){a.D.jb&&(b?a.D.Ub=!0:void 0===b&&a.g(a.toString()+" busy"));return a.D.jb}function E(a){if(!a.D.lb&&(a.D.Ma=!0,a.D.Ma)){var b=a.Nb;a.Nb=null;b&&b()}}function pb(a,b){b&&(a.D.Ma?b():a.Nb=b);return a.D.Ma}function qb(a,b){a.D.lb=!0;a.ia(b)}
var rb="undefined"!==typeof ArrayBuffer,sb=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,
0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1],tb={cpu:1,bus:64,mem:128,port:256,nvr:16384,chipset:32768,keyboard:65536,key:131072,video:262144,fdc:524288,disk:2097152,serial:8388608,speaker:33554432,computer:67108864,log:268435456,warn:536870912,buffer:1073741824,halt:-2147483648};function ub(a){w.call(this,"Panel",a,ub)}bb(ub);m=ub.prototype;
m.la=function(a,b,c,d){return this.C&&this.C.la(a,b,c,d)||this.b&&this.b.la(a,b,c,d)||this.K&&this.K.la(a,b,c,d)||this.I&&this.I.la(a,b,c,d)?!0:this.parent.la.call(this,a,b,c,d)};m.Qa=function(a,b,c,d){this.C=a;this.w=b;this.b=c;this.I=d;this.K=vb(a,"Keyboard")};m.Ea=function(a,b){b||wb();return!0};m.Ha=function(){return!0};m.Ia=function(){};function wb(){for(var a=!1,b=C(document,"pc8080","panel"),c=0;c<b.length;c++){var d=b[c],e=z(d),f=fb(e.id);f||(a=!0,f=new ub(e));hb(f,d);a&&E(f)}}Ma(wb);
function xb(a,b,c){w.call(this,"Bus",a,xb);this.b=b;this.I=c;this.H=a.busWidth||16;this.N=Math.pow(2,this.H);this.A=this.N-1|0;this.oa=16>=this.H?10:20>=this.H?12:24>=this.H?14:15;this.Ga=1<<this.oa;this.O=this.Ga>>2;this.w=this.Ga-1;this.L=this.N/this.Ga|0;this.K=this.L-1;this.C=[];this.j=[];this.F=this.J=!1;this.R=[];this.X=[];a=new F;yb(a,this.I);this.Y=Array(this.L);for(b=0;b<this.L;b++)this.Y[b]=a;E(this)}bb(xb);m=xb.prototype;m.reset=function(){};m.Ea=function(a,b){b||this.reset();return!0};
function zb(a,b,c,d){for(var e=b,f=c,h=e>>>a.oa;0<f&&h<a.Y.length;){var g=a.Y[h],k=h*a.Ga,l=a.Ga-(e-k);l>f&&(l=f);if(g&&g.size){if(g.type==d){if(e+f<=g.G)return g.Gb+=g.G-e,g.G=e,!0;if(e>=g.G+g.Gb){l=g.size-(e-k);l>f&&(l=f);g.Gb=e-g.G+l;e=k+a.Ga;f-=l;h++;continue}}return Ab(1,e,f)}e=new F(e,l,a.Ga,d);yb(e,a.I,g);a.Y[h++]=e;e=k+a.Ga;f-=l}return 0>=f?(a.status(Math.floor(c/1024)+"Kb "+Bb[d]+" at "+t(b)),!0):Ab(2,b,c)}m.$=function(a){return this.Y[(a&this.A)>>>this.oa].rb(a&this.w,a)};
function Cb(a,b){return a.Y[(b&a.A)>>>a.oa].Eb(b&a.w,b)}m.Ta=function(a){var b=a&this.w,c=(a&this.A)>>>this.oa;return b!=this.w?this.Y[c].Hc(b,a):this.Y[c++].rb(b,a)|this.Y[c&this.K].rb(0,a+1)<<8};function Db(a,b){var c=b&a.w,d=(b&a.A)>>>a.oa;return c!=a.w?a.Y[d].$b(c,b):a.Y[d++].Eb(c,b)|a.Y[d&a.K].Eb(0,b+1)<<8}m.ta=function(a,b){this.Y[(a&this.A)>>>this.oa].tb(a&this.w,b&255,a)};function Fb(a,b,c){a.Y[(b&a.A)>>>a.oa].Hb(b&a.w,c&255,b)}
m.Sb=function(a,b){var c=a&this.w,d=(a&this.A)>>>this.oa;c!=this.w?this.Y[d].Mc(c,b&65535,a):(this.Y[d++].tb(c,b&255,a),this.Y[d&this.K].tb(0,b>>8&255,a+1))};function Gb(a,b){if(void 0===b)return a.F=!a.F,a.F;void 0===a.C[b]&&(a.C[b]=[null,!1]);a.C[b][1]=!a.C[b][1];return a.C[b][1]}function Hb(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,h=+e+d,g=c[e].bind(b);if(void 0!==g)for(var k=+e+d;k<=h;k++)void 0!==f.C[k]?v("Input port "+t(k)+" already registered"):f.C[k]=[g,!1]}}
function Ib(a,b,c){for(var d=1,e=0,f=0;0<d;){var h=a.C[b],g=a.R[b]||1,k=1==g?255:2==g?65535:-1,l=k;void 0!==h?(h[0]&&(l=h[0](b,c),void 0===l?l=k:l&=k),a.I&&a.F!=h[1]&&Rb(a.I,b,l)):a.I&&(ib(a.I,a,b,null,c),a.F&&Rb(a.I,b,l));e|=l<<f;f+=g<<3;b+=g;d-=g}return e}function Sb(a,b){if(void 0===b)return a.J=!a.J,a.J;void 0===a.j[b]&&(a.j[b]=[null,!1]);a.j[b][1]=!a.j[b][1];return a.j[b][1]}
function Tb(a,b,c,d){void 0===d&&(d=0);if(c)for(var e in c){var f=a,h=+e+d,g=c[e].bind(b);if(void 0!==g)for(var k=+e+d;k<=h;k++)void 0!==f.j[k]?v("Output port "+t(k)+" already registered"):f.j[k]=[g,!1]}}function Ub(a,b,c,d){for(var e=1,f=0;0<e;){var h=a.j[b],g=a.X[b]||1,k=1==g?255:2==g?65535:-1,k=(c>>>=f)&k;if(void 0!==h){if(h[0])h[0](b,k,d);a.I&&a.J!=h[1]&&Vb(a.I,b,k)}else a.I&&(ib(a.I,a,b,k,d),a.J&&Vb(a.I,b,k));f+=g<<3;b+=g;e-=g}}
function Ab(a,b,c){v("Memory block error ("+a+": "+n(b)+","+n(c)+")");return!1}var Wb;if(rb){var Xb=new ArrayBuffer(2);(new DataView(Xb)).setUint16(0,256,!0);Wb=256===(new Uint16Array(Xb))[0]}else Wb=!1;var Yb=Wb;
function F(a,b,c,d){this.id=Zb+=2;this.b=null;this.G=a;this.Gb=b;this.size=c||0;this.type=d||$b;this.M=d==ac;yb(this);this.Oa=this.qc=!1;if(c)if(rb)this.F=new ArrayBuffer(c),this.J=new DataView(this.F,0,c),this.w=new Uint8Array(this.F,0,c),this.K=new Uint16Array(this.F,0,c>>1),this.b=new Int32Array(this.F,0,c>>2),bc(this,Yb?cc:dc);else{this.b=Array(c>>2);for(a=0;a<this.b.length;a++)this.b[a]=0;bc(this,ec)}else bc(this)}var $b=0,ac=2,Bb=["NONE","RAM","ROM","VID","H/W"],Zb=0;
F.prototype={constructor:F,parent:null,save:function(){var a,b;if(rb)for(a=Array(this.size>>2),b=0;b<a.length;b++)a[b]=this.J.getInt32(b<<2,!0);else a=this.b;return a},restore:function(a){if(a&&this.size==a.length<<2){var b;if(rb)for(b=0;b<a.length;b++)this.J.setInt32(b<<2,a[b],!0);else this.b=a;return this.Oa=!0}return!1},$a:function(a,b){b?0===this.j++&&fc(this,gc,!1):0===this.C++&&hc(this,gc,!1)},L:function(){this.I&&kb(this.I,129)&&this.I.message("attempt to read invalid block %"+n(this.G),!0);
return 255},A:function(a,b){this.I&&kb(this.I,129)&&this.I.message("attempt to write "+t(b)+" to invalid block %"+n(this.G),!0)},N:function(a,b){return this.rb(a++,b++)|this.rb(a,b)<<8},H:function(a,b,c){this.tb(a++,b&255,c++);this.tb(a,b>>8,c)},ba:function(a){return this.b[a>>2]>>>((a&3)<<3)&255},ga:function(a){var b=a>>2;a=(a&3)<<3;var c=this.b[b]>>a;return 24>a?c&65535:c&255|(this.b[b+1]&255)<<8},qa:function(a,b){var c=a>>2,d=(a&3)<<3;this.b[c]=this.b[c]&~(255<<d)|b<<d;this.Oa=!0},Ca:function(a,
b){var c=a>>2,d=(a&3)<<3;24>d?this.b[c]=this.b[c]&~(65535<<d)|b<<d:(this.b[c]=this.b[c]&16777215|b<<24,c++,this.b[c]=this.b[c]&-256|b>>8);this.Oa=!0},R:function(a,b){if(this.I&&null!=this.G){var c=this.I;ic(c,this.G+a,1,c.R)&&c.ma(!0)}return this.Eb(a,b)},da:function(a,b){if(this.I&&null!=this.G){var c=this.I;ic(c,this.G+a,2,c.R)&&c.ma(!0)}return this.$b(a,b)},pa:function(a,b,c){if(this.I&&null!=this.G){var d=this.I;ic(d,this.G+a,1,d.J)&&d.ma(!0)}this.M?this.A(a,b,c):this.Hb(a,b,c)},ya:function(a,
b,c){if(this.I&&null!=this.G){var d=this.I;ic(d,this.G+a,2,d.J)&&d.ma(!0)}this.M?this.A(a,b,c):this.cc(a,b,c)},O:function(a){return this.w[a]},X:function(a){return this.w[a]},ca:function(a){return this.J.getUint16(a,!0)},fa:function(a){return a&1?this.w[a]|this.w[a+1]<<8:this.K[a>>1]},ha:function(a,b){this.w[a]=b;this.Oa=!0},Za:function(a,b){this.w[a]=b;this.Oa=!0},ua:function(a,b){this.J.setUint16(a,b,!0);this.Oa=!0},Ba:function(a,b){a&1?(this.w[a]=b,this.w[a+1]=b>>8):this.K[a>>1]=b;this.Oa=!0}};
function yb(a,b,c){a.I=b;a.C=a.j=0;c&&((a.C=c.C)&&hc(a,gc,!1),(a.j=c.j)&&fc(a,gc,!1))}function jc(a,b){b?0===--a.j&&(a.tb=a.M?a.A:a.Hb,a.Mc=a.M?a.H:a.cc):0===--a.C&&(a.rb=a.Eb,a.Hc=a.$b)}function fc(a,b,c){c&&a.j||(a.tb=!a.M&&b[2]||a.A,a.Mc=!a.M&&b[3]||a.H);if(c||void 0===c)a.Hb=b[2]||a.A,a.cc=b[3]||a.H}function hc(a,b,c){c&&a.C||(a.rb=b[0]||a.L,a.Hc=b[1]||a.N);if(c||void 0===c)a.Eb=b[0]||a.L,a.$b=b[1]||a.N}function bc(a,b){b||(b=kc);hc(a,b,void 0);fc(a,b,void 0)}
var kc=[],ec=[F.prototype.ba,F.prototype.ga,F.prototype.qa,F.prototype.Ca],gc=[F.prototype.R,F.prototype.da,F.prototype.pa,F.prototype.ya];if(rb)var dc=[F.prototype.O,F.prototype.ca,F.prototype.ha,F.prototype.ua],cc=[F.prototype.X,F.prototype.fa,F.prototype.Za,F.prototype.Ba];
function lc(a,b){w.call(this,"CPU",a,lc,1);var c=a.cycles||b,d=a.multiplier||1;this.u={};this.u.Bb=c;this.u.Sa=d;this.u.Xb=Math.round(this.u.Bb/1E4)/100;this.u.eb=this.u.Xb*this.u.Sa;this.D.xa=!1;this.D.Vb=!1;this.D.pc=a.autoStart;this.D.rc=!1;this.D.kb=!1;this.u.zb=this.u.ob=0;this.u.Ab=a.csStart;this.u.nb=a.csInterval;this.u.pb=a.csStop;this.F=[];this.X=this.gb.bind(this);E(this)}bb(lc);var mc=["power","reset"];m=lc.prototype;
m.Qa=function(a,b,c,d){this.C=a;this.w=b;this.I=d;for(b=0;b<mc.length;b++)(c=this.M[mc[b]])&&this.C.la(null,mc[b],c);this.J=vb(a,"ChipSet");a=nc(a,"autoStart");null!=a&&(this.D.pc="true"==a?!0:"false"==a?!1:!!a);E(this)};m.reset=function(){};m.save=function(){return null};m.restore=function(){return!1};
m.Ea=function(a,b){if(!b){if(a&&this.restore){oc(this);if(!this.restore(a))return!1;Bc(this)}else this.reset();if(this.I){var c=this.I;c.g("Type ? for help with PC8080 Debugger commands");c.Ia();if(c.Ca){var d=c.Ca;c.Ca=null;Cc(c,d)}}else this.g("No debugger detected")}Dc(this);return!0};m.Ha=function(a){return a?this.save():!0};function Ec(a){(a.D.pc||!a.I&&void 0===a.M.run)&&a.gb(!0)}m.sc=function(){return 0};
function Bc(a){void 0===a.u.Ab&&(a.u.Ab=0);void 0===a.u.nb&&(a.u.nb=-1);void 0===a.u.pb&&(a.u.pb=-1);a.D.kb=0<=a.u.Ab&&0<a.u.nb;a.D.kb&&(a.u.zb=0,a.u.ob=a.u.Ab-a.K)}function Fc(a,b){if(a.D.kb){var c=!1;a.u.zb=a.u.zb+a.sc()|0;a.u.ob-=b;0>=a.u.ob&&(a.u.ob+=a.u.nb,c=!0);0<=a.u.pb&&a.u.pb<=Gc(a)&&(a.u.nb=a.u.pb=-1,Bc(a),a.ma(),c=!0);c&&a.g(Gc(a)+" cycles: checksum="+n(a.u.zb))}}
m.la=function(a,b,c){var d=this;a=!1;switch(b){case "power":case "reset":this.M[b]=c;a=!0;break;case "run":this.M[b]=c;c.onclick=function(){var a;if(a=d.C)if(a=d.C,a.D.va)a=!0;else{var b=null,c,g=eb(a.id);for(c=0;c<g.length&&(b=g[c],b===a||b.D.Ma);c++);if(c==g.length)for(c=0;c<g.length&&(b=g[c],b===a||b.D.va);c++);c==g.length&&(b=a);v("The "+b.type+" component ("+b.id+") is not "+(b.D.Ma?"powered yet":"ready yet"+(b.Nb?" (waiting for notification)":""))+".");a=!1}a&&(d.D.xa?d.ma():d.gb())};a=!0;break;
case "speed":this.M[b]=c;a=!0;break;case "setSpeed":this.M[b]=c,c.onclick=function(){Hc(d,d.u.Sa<<1,!0)},c.textContent=this.u.eb.toFixed(2)+"Mhz",a=!0}return a};function Ic(a,b,c){a.K+=b;c&&(a.j=a.b=0)}function Jc(a,b){var c=1;b&&1<a.u.Sa&&a.u.cb&&(c=a.u.cb/a.u.Xb);a.u.Ac=Math.round(1E3/30);a.u.Pb=Math.floor(a.u.Bb/30*c);b||(a.u.qb=a.u.Pb);a.u.Zb=0}function Gc(a){return a.K+a.H+a.j-a.b}function oc(a){a.u.cb=0;a.u.Bc=0;a.K=a.H=a.j=a.b=0;Bc(a);Hc(a,1)}
function Hc(a,b,c){var d=!1;if(void 0!==b){.8>a.u.cb/a.u.eb?b=1:d=!0;a.u.Sa=b;b=a.u.Xb*a.u.Sa;if(a.u.eb!=b){a.u.eb=b;b=a.u.eb.toFixed(2)+"Mhz";var e=a.M.setSpeed;e&&(e.textContent=b);a.g("target speed: "+b)}c&&a.C&&a.C.Fb()}Ic(a,a.H);a.H=0;a.u.mb=pa();a.u.fb=0;Jc(a);return d}function Kc(a,b){var c=a.F.length;a.F.push([-1,b]);return c}function Lc(a,b,c){var d=-1;0<=b&&b<a.F.length&&(d=a.u.Bb*a.u.Sa/1E3*c,a.F[b][0]=d)}
m.gb=function(a){if(lb(this,!0)){if(!this.D.xa){Hc(this);this.C&&this.C.start(this.u.mb,Gc(this));this.D.xa=!0;this.D.Vb=!0;this.J&&this.J.start();var b=this.M.run;b&&(b.textContent="Halt");this.C&&(this.C.Ia(!0),a&&this.C.Fb(!0))}this.u.Zb>=this.u.Bb&&Jc(this,!0);this.u.Cb=0;this.u.Ob=pa();this.u.fb&&(a=this.u.Ob-this.u.fb,a>this.u.Ac&&(this.u.mb+=a,this.u.mb>this.u.Ob&&(this.u.mb=this.u.Ob)));try{do{for(var c=this.D.kb?1:this.u.Pb,d=this.F.length-1;0<=d;d--){var e=this.F[d];0>e[0]||c>e[0]&&(c=e[0])}this.sb(c);
var f=this.j-this.b;a=f;for(var h=this.F.length-1;0<=h;h--){var g=this.F[h];0>g[0]||(g[0]-=a,0>=g[0]&&(g[0]=-1,g[1]()))}this.u.Cb+=f;this.H+=f;Ic(this,0,!0);Fc(this,f);this.u.qb-=f;if(0>=this.u.qb){this.u.qb+=this.u.Pb;15<=++this.u.Bc&&(this.C&&this.C.Ia(),this.u.Bc=0);break}}while(this.D.xa)}catch(k){this.ma();Dc(this);this.C&&this.C.stop(pa(),Gc(this));lb(this,!1);qb(this,k.stack||k.message);return}c=setTimeout;d=this.X;this.u.fb=pa();e=this.u.Ac;this.u.Cb&&(e=Math.round(e*this.u.Cb/this.u.Pb));
e-=this.u.fb-this.u.Ob;if(f=this.u.fb-this.u.mb)this.u.cb=Math.round(this.H/(10*f))/100,864E5<=f&&(this.K=0,Hc(this));if(0>e||this.u.cb<this.u.eb)e=0;this.u.Zb+=this.u.Cb;this.u.fb+=e;c(d,e)}else Dc(this),this.C&&this.C.stop(pa(),Gc(this))};m.sb=function(){return 0};m.ma=function(a){mb(this,!0);this.j-=this.b;this.b=0;Ic(this,this.H);this.H=0;if(this.D.xa){this.D.xa=!1;this.J&&this.J.stop();var b=this.M.run;b&&(b.textContent="Run")}this.D.Mb=a};
function Dc(a,b){if(a.C){for(var c=a.C,d=0;d<c.H.length;d++)Mc(c.H[d],b);a.C.Ia(b)}}function Nc(a){this.zc=+a.model||8080;lc.call(this,a,1E6);this.N=Oc;oc(this);this.D.Mb=this.D.wd=!1;this.R=0;this.L=[];this.O=0;Pc(this)}bb(Nc,lc);function Qc(a,b){a.L.push(b)}m=Nc.prototype;m.reset=function(){this.D.xa&&this.ma();Pc(this);oc(this);this.D.lb=!1;this.parent.reset.call(this)};function Pc(a){a.i=0;a.S=0;a.T=0;a.U=0;a.V=0;a.W=0;a.Z=0;a.ka=0;G(a,a.O);Rc(a,0);a.A=0}function Sc(a,b){a.O=b;G(a,b)}
m.sc=function(){var a=this.i+this.S+this.T+this.U+this.V+this.W+this.Z|0;return a=a+this.ka+this.P+Tc(this)|0};
m.save=function(){var a=new H(this);I(a,0,[this.i,this.S,this.T,this.U,this.V,this.W,this.Z,this.ka,this.P,Tc(this)]);I(a,1,[this.A,this.K,this.u.Sa]);for(var b=this.w,c=0,d=[],e=0;e<b.L;e++){var f=b.Y[e];if(f.Oa||f.qc){d[c++]=e;var h=c++;a:if(f=f.save()){for(var g=0,k=0,l=[];g<f.length;){for(var p=f[g],q=g+1;q<f.length&&f[q]===p;)q++;l[k++]=q-g;l[k++]=p;g=q}if(l.length<f.length){f=l;break a}}d[h]=f}}I(a,2,d);return a.data()};
m.restore=function(a){var b=a[0];this.i=b[0];this.S=b[1];this.T=b[2];this.U=b[3];this.V=b[4];this.W=b[5];this.Z=b[6];this.ka=b[7]&65535;G(this,b[8]);Rc(this,b[9]);b=a[1];this.A=b[0];this.K=b[1];Hc(this,b[3]);a:{b=this.w;a=a[2];var c;for(c=0;c<a.length-1;c+=2){var d=a[c],e=a[c+1];if(e&&e.length<b.O){for(var f=0,h=Array(b.O),g=0;g<e.length-1;)for(var k=e[g++],l=e[g++];k--;)h[f++]=l;e=h}f=b.Y[d];if(!f||!f.restore(e)){v("Unable to restore memory block "+d);b=!1;break a}}b=!0}return b};
m.la=function(a,b,c){var d=!1;switch(b){case "A":case "B":case "C":case "BC":case "D":case "E":case "DE":case "H":case "L":case "HL":case "SP":case "PC":case "PS":case "IF":case "SF":case "ZF":case "AF":case "PF":case "CF":this.M[b]=c;this.R++;d=!0;break;default:d=this.parent.la.call(this,a,b,c)}return d};function Uc(a){return a.S<<8|a.T}function Vc(a,b){a.S=b>>8&255;a.T=b&255}function Wc(a){return a.U<<8|a.V}function Xc(a,b){a.U=b>>8&255;a.V=b&255}function J(a){return a.W<<8|a.Z}
function Yc(a,b){a.W=b>>8&255;a.Z=b&255}function G(a,b){a.P=b&65535}function Zc(a){return a.aa&256?1:0}function $c(a,b){a.aa=a.aa&255|b}function ad(a){return sb[a.ea&255]?4:0}function bd(a){return(a.ea^a.wa)&16?16:0}function cd(a){return a.aa&255?0:64}function dd(a){return a.ea&128?128:0}function Tc(a){return a.sa&-214|dd(a)|cd(a)|bd(a)|ad(a)|Zc(a)}function Rc(a,b){a.aa=a.ea=a.wa=0;b&1&&(a.aa|=256);b&4||(a.ea|=1);b&16&&(a.wa|=16);b&64||(a.aa|=255);b&128&&(a.ea^=192);a.sa=a.sa&-726|b&512|2}
function ed(a,b){a.wa=a.i^b;return a.ea=(a.aa=a.i+b)&255}function fd(a,b){a.wa=a.i^b;return a.ea=(a.aa=a.i+b+(a.aa&256?1:0))&255}function gd(a,b){a.aa=a.ea=a.wa=a.i&b;(a.i|b)&8&&(a.wa^=16);return a.aa}function hd(a,b){a.wa=b^255;b=a.ea=b+255&255;a.aa=a.aa&-256|b;return b}function id(a,b){a.wa=b;b=a.ea=b+1&255;a.aa=a.aa&-256|b;return b}function jd(a,b){return a.ea=a.aa=a.wa=a.i|b}function K(a,b){b^=255;a.wa=a.i^b;return a.ea=(a.aa=a.i+b+1^256)&255}
function Dd(a,b){b^=255;a.wa=a.i^b;return a.ea=(a.aa=a.i+b+(a.aa&256?0:1)^256)&255}function Ed(a,b){return a.ea=a.aa=a.wa=a.i^b}m.$=function(a){return this.w.$(a)};m.ta=function(a,b){this.w.ta(a,b)};function L(a){var b=a.$(a.P);G(a,a.P+1);return b}function M(a){var b=a.w.Ta(a.P);G(a,a.P+2);return b}function O(a){var b=a.w.Ta(a.ka);a.ka=a.ka+2&65535;return b}function P(a,b){a.ka=a.ka-2&65535;a.w.Sb(a.ka,b)}
function Fd(a){if(a.b&&a.A&255&&a.sa&512){for(var b=0;8>b&&!(a.A&1<<b);b++);a.A&=~(0>b?255:1<<b);a.sa&=-513;a.A&=-257;a.N[199|b<<3].call(a)}return a.A&256?(a.j-=a.b,a.b=0,!1):!0}function Gd(a,b){a.A|=1<<b;a.sa&512&&(a.j-=a.b,a.b=0)}function R(a,b,c,d){d=d||2;a.M[b]&&(void 0===c&&(qb(a,"Value for "+b+" is invalid"),a.ma()),c=!a.D.xa||a.D.rc?n(c,d):"--------".substr(0,d),a.M[b].textContent!=c&&(a.M[b].textContent=c))}
m.Ia=function(a){this.R&&(a||!this.D.xa||this.D.rc)&&(R(this,"A",this.i),R(this,"B",this.S),R(this,"C",this.T),R(this,"BC",Uc(this),4),R(this,"D",this.U),R(this,"E",this.V),R(this,"DE",Wc(this),4),R(this,"H",this.W),R(this,"L",this.Z),R(this,"HL",J(this),4),R(this,"SP",this.ka,4),R(this,"PC",this.P,4),a=Tc(this),R(this,"PS",a,4),R(this,"IF",a&512?1:0,1),R(this,"SF",a&128?1:0,1),R(this,"ZF",a&64?1:0,1),R(this,"AF",a&16?1:0,1),R(this,"PF",a&4?1:0,1),R(this,"CF",a&1?1:0,1));if(a=this.M.speed)a.textContent=
this.D.xa&&this.u.cb?this.u.cb.toFixed(2)+"Mhz":"Stopped"};m.sb=function(a){this.D.Mb=!0;var b=this.D.wd=this.I&&Hd(this.I),c=a?this.D.Vb?0:1:-1;this.D.Vb=!1;this.j=this.b=a;if(Fd(this)){do{if(b){if(Id(this.I,this.P,c)){this.ma();break}c=1}this.N[L(this)].call(this)}while(0<this.b)}return this.D.Mb?this.j-this.b:void 0===this.D.Mb?0:-1};Ma(function(){for(var a=C(document,"pc8080","cpu"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new Nc(d);hb(d,c)}});function Jd(){this.b-=4}
function Kd(){G(this,M(this));this.b-=10}function Ld(){G(this,O(this));this.b-=10}function Md(){var a=M(this);P(this,this.P);G(this,a);this.b-=17}
var Oc=[Jd,function(){Vc(this,M(this));this.b-=10},function(){this.ta(Uc(this),this.i);this.b-=7},function(){Vc(this,Uc(this)+1);this.b-=5},function(){this.S=id(this,this.S);this.b-=5},function(){this.S=hd(this,this.S);this.b-=5},function(){this.S=L(this);this.b-=7},function(){var a=this.i<<1;this.i=a&255|a>>8;$c(this,a&256);this.b-=4},Jd,function(){var a;Yc(this,a=J(this)+Uc(this));$c(this,a>>8&256);this.b-=10},function(){this.i=this.$(Uc(this));this.b-=7},function(){Vc(this,Uc(this)-1);this.b-=
5},function(){this.T=id(this,this.T);this.b-=5},function(){this.T=hd(this,this.T);this.b-=5},function(){this.T=L(this);this.b-=7},function(){var a=this.i<<8&256;this.i=(a|this.i)>>1;$c(this,a);this.b-=4},Jd,function(){Xc(this,M(this));this.b-=10},function(){this.ta(Wc(this),this.i);this.b-=7},function(){Xc(this,Wc(this)+1);this.b-=5},function(){this.U=id(this,this.U);this.b-=5},function(){this.U=hd(this,this.U);this.b-=5},function(){this.U=L(this);this.b-=7},function(){var a=this.i<<1;this.i=a&255|
Zc(this);$c(this,a&256);this.b-=4},Jd,function(){var a;Yc(this,a=J(this)+Wc(this));$c(this,a>>8&256);this.b-=10},function(){this.i=this.$(Wc(this));this.b-=7},function(){Xc(this,Wc(this)-1);this.b-=5},function(){this.V=id(this,this.V);this.b-=5},function(){this.V=hd(this,this.V);this.b-=5},function(){this.V=L(this);this.b-=7},function(){var a=this.i<<8;this.i=(Zc(this)<<8|this.i)>>1;$c(this,a&256);this.b-=4},Jd,function(){Yc(this,M(this));this.b-=10},function(){var a=M(this);this.w.Sb(a,J(this));
this.b-=16},function(){Yc(this,J(this)+1);this.b-=5},function(){this.W=id(this,this.W);this.b-=5},function(){this.W=hd(this,this.W);this.b-=5},function(){this.W=L(this);this.b-=7},function(){var a=0,b=Zc(this);if(bd(this)||9<(this.i&15))a|=6;if(b||154<=this.i)a|=96,b=1;this.i=ed(this,a);$c(this,b?256:0);this.b-=4},Jd,function(){var a;Yc(this,a=J(this)+J(this));$c(this,a>>8&256);this.b-=10},function(){var a;a=M(this);a=this.w.Ta(a);Yc(this,a);this.b-=16},function(){Yc(this,J(this)-1);this.b-=5},function(){this.Z=
id(this,this.Z);this.b-=5},function(){this.Z=hd(this,this.Z);this.b-=5},function(){this.Z=L(this);this.b-=7},function(){this.i=~this.i&255;this.b-=4},Jd,function(){this.ka=M(this)&65535;this.b-=10},function(){this.ta(M(this),this.i);this.b-=13},function(){this.ka=this.ka+1&65535;this.b-=5},function(){var a=J(this);this.ta(a,id(this,this.$(a)));this.b-=10},function(){var a=J(this);this.ta(a,hd(this,this.$(a)));this.b-=10},function(){this.ta(J(this),L(this));this.b-=10},function(){this.aa|=256;this.b-=
4},Jd,function(){var a;Yc(this,a=J(this)+this.ka);$c(this,a>>8&256);this.b-=10},function(){this.i=this.$(M(this));this.b-=13},function(){this.ka=this.ka-1&65535;this.b-=5},function(){this.i=id(this,this.i);this.b-=5},function(){this.i=hd(this,this.i);this.b-=5},function(){this.i=L(this);this.b-=7},function(){$c(this,Zc(this)?0:256);this.b-=4},function(){this.b-=5},function(){this.S=this.T;this.b-=5},function(){this.S=this.U;this.b-=5},function(){this.S=this.V;this.b-=5},function(){this.S=this.W;this.b-=
5},function(){this.S=this.Z;this.b-=5},function(){this.S=this.$(J(this));this.b-=7},function(){this.S=this.i;this.b-=5},function(){this.T=this.S;this.b-=5},function(){this.b-=5},function(){this.T=this.U;this.b-=5},function(){this.T=this.V;this.b-=5},function(){this.T=this.W;this.b-=5},function(){this.T=this.Z;this.b-=5},function(){this.T=this.$(J(this));this.b-=7},function(){this.T=this.i;this.b-=5},function(){this.U=this.S;this.b-=5},function(){this.U=this.T;this.b-=5},function(){this.b-=5},function(){this.U=
this.V;this.b-=5},function(){this.U=this.W;this.b-=5},function(){this.U=this.Z;this.b-=5},function(){this.U=this.$(J(this));this.b-=7},function(){this.U=this.i;this.b-=5},function(){this.V=this.S;this.b-=5},function(){this.V=this.T;this.b-=5},function(){this.V=this.U;this.b-=5},function(){this.b-=5},function(){this.V=this.W;this.b-=5},function(){this.V=this.Z;this.b-=5},function(){this.V=this.$(J(this));this.b-=7},function(){this.V=this.i;this.b-=5},function(){this.W=this.S;this.b-=5},function(){this.W=
this.T;this.b-=5},function(){this.W=this.U;this.b-=5},function(){this.W=this.V;this.b-=5},function(){this.b-=5},function(){this.W=this.Z;this.b-=5},function(){this.W=this.$(J(this));this.b-=7},function(){this.W=this.i;this.b-=5},function(){this.Z=this.S;this.b-=5},function(){this.Z=this.T;this.b-=5},function(){this.Z=this.U;this.b-=5},function(){this.Z=this.V;this.b-=5},function(){this.Z=this.W;this.b-=5},function(){this.b-=5},function(){this.Z=this.$(J(this));this.b-=7},function(){this.Z=this.i;
this.b-=5},function(){this.ta(J(this),this.S);this.b-=7},function(){this.ta(J(this),this.T);this.b-=7},function(){this.ta(J(this),this.U);this.b-=7},function(){this.ta(J(this),this.V);this.b-=7},function(){this.ta(J(this),this.W);this.b-=7},function(){this.ta(J(this),this.Z);this.b-=7},function(){var a=this.P-1;if(this.L.length)for(var b=0;b<this.L.length;b++)if(this.L[b](a))return;this.b-=7;this.A|=256;this.j-=this.b;this.b=0;this.I&&kb(this,-2147483648)?(G(this,a),this.I.ma()):this.sa&512||(this.I&&
G(this,a),this.ma())},function(){this.ta(J(this),this.i);this.b-=7},function(){this.i=this.S;this.b-=5},function(){this.i=this.T;this.b-=5},function(){this.i=this.U;this.b-=5},function(){this.i=this.V;this.b-=5},function(){this.i=this.W;this.b-=5},function(){this.i=this.Z;this.b-=5},function(){this.i=this.$(J(this));this.b-=7},function(){this.b-=5},function(){this.i=ed(this,this.S);this.b-=4},function(){this.i=ed(this,this.T);this.b-=4},function(){this.i=ed(this,this.U);this.b-=4},function(){this.i=
ed(this,this.V);this.b-=4},function(){this.i=ed(this,this.W);this.b-=4},function(){this.i=ed(this,this.Z);this.b-=4},function(){this.i=ed(this,this.$(J(this)));this.b-=7},function(){this.i=ed(this,this.i);this.b-=4},function(){this.i=fd(this,this.S);this.b-=4},function(){this.i=fd(this,this.T);this.b-=4},function(){this.i=fd(this,this.U);this.b-=4},function(){this.i=fd(this,this.V);this.b-=4},function(){this.i=fd(this,this.W);this.b-=4},function(){this.i=fd(this,this.Z);this.b-=4},function(){this.i=
fd(this,this.$(J(this)));this.b-=7},function(){this.i=fd(this,this.i);this.b-=4},function(){this.i=K(this,this.S);this.b-=4},function(){this.i=K(this,this.T);this.b-=4},function(){this.i=K(this,this.U);this.b-=4},function(){this.i=K(this,this.V);this.b-=4},function(){this.i=K(this,this.W);this.b-=4},function(){this.i=K(this,this.Z);this.b-=4},function(){this.i=K(this,this.$(J(this)));this.b-=7},function(){this.i=K(this,this.i);this.b-=4},function(){this.i=Dd(this,this.S);this.b-=4},function(){this.i=
Dd(this,this.T);this.b-=4},function(){this.i=Dd(this,this.U);this.b-=4},function(){this.i=Dd(this,this.V);this.b-=4},function(){this.i=Dd(this,this.W);this.b-=4},function(){this.i=Dd(this,this.Z);this.b-=4},function(){this.i=Dd(this,this.$(J(this)));this.b-=7},function(){this.i=Dd(this,this.i);this.b-=4},function(){this.i=gd(this,this.S);this.b-=4},function(){this.i=gd(this,this.T);this.b-=4},function(){this.i=gd(this,this.U);this.b-=4},function(){this.i=gd(this,this.V);this.b-=4},function(){this.i=
gd(this,this.W);this.b-=4},function(){this.i=gd(this,this.Z);this.b-=4},function(){this.i=gd(this,this.$(J(this)));this.b-=7},function(){this.i=gd(this,this.i);this.b-=4},function(){this.i=Ed(this,this.S);this.b-=4},function(){this.i=Ed(this,this.T);this.b-=4},function(){this.i=Ed(this,this.U);this.b-=4},function(){this.i=Ed(this,this.V);this.b-=4},function(){this.i=Ed(this,this.W);this.b-=4},function(){this.i=Ed(this,this.Z);this.b-=4},function(){this.i=Ed(this,this.$(J(this)));this.b-=7},function(){this.i=
Ed(this,this.i);this.b-=4},function(){this.i=jd(this,this.S);this.b-=4},function(){this.i=jd(this,this.T);this.b-=4},function(){this.i=jd(this,this.U);this.b-=4},function(){this.i=jd(this,this.V);this.b-=4},function(){this.i=jd(this,this.W);this.b-=4},function(){this.i=jd(this,this.Z);this.b-=4},function(){this.i=jd(this,this.$(J(this)));this.b-=7},function(){this.i=jd(this,this.i);this.b-=4},function(){K(this,this.S);this.b-=4},function(){K(this,this.T);this.b-=4},function(){K(this,this.U);this.b-=
4},function(){K(this,this.V);this.b-=4},function(){K(this,this.W);this.b-=4},function(){K(this,this.Z);this.b-=4},function(){K(this,this.$(J(this)));this.b-=7},function(){K(this,this.i);this.b-=4},function(){cd(this)||(G(this,O(this)),this.b-=6);this.b-=5},function(){Vc(this,O(this));this.b-=10},function(){var a=M(this);cd(this)||G(this,a);this.b-=10},Kd,function(){var a=M(this);cd(this)||(P(this,this.P),G(this,a),this.b-=6);this.b-=11},function(){P(this,Uc(this));this.b-=11},function(){this.i=ed(this,
L(this));this.b-=7},function(){P(this,this.P);G(this,0);this.b-=11},function(){cd(this)&&(G(this,O(this)),this.b-=6);this.b-=5},Ld,function(){var a=M(this);cd(this)&&G(this,a);this.b-=10},Kd,function(){var a=M(this);cd(this)&&(P(this,this.P),G(this,a),this.b-=6);this.b-=11},Md,function(){this.i=fd(this,L(this));this.b-=7},function(){P(this,this.P);G(this,8);this.b-=11},function(){Zc(this)||(G(this,O(this)),this.b-=6);this.b-=5},function(){Xc(this,O(this));this.b-=10},function(){var a=M(this);Zc(this)||
G(this,a);this.b-=10},function(){var a=L(this);Ub(this.w,a,this.i,this.P+-2&65535);this.b-=10},function(){var a=M(this);Zc(this)||(P(this,this.P),G(this,a),this.b-=6);this.b-=11},function(){P(this,Wc(this));this.b-=11},function(){this.i=K(this,L(this));this.b-=7},function(){P(this,this.P);G(this,16);this.b-=11},function(){Zc(this)&&(G(this,O(this)),this.b-=6);this.b-=5},Ld,function(){var a=M(this);Zc(this)&&G(this,a);this.b-=10},function(){var a=L(this);this.i=Ib(this.w,a,this.P+-2&65535)&255;this.b-=
10},function(){var a=M(this);Zc(this)&&(P(this,this.P),G(this,a),this.b-=6);this.b-=11},Md,function(){this.i=Dd(this,L(this));this.b-=7},function(){P(this,this.P);G(this,24);this.b-=11},function(){ad(this)||(G(this,O(this)),this.b-=6);this.b-=5},function(){Yc(this,O(this));this.b-=10},function(){var a=M(this);ad(this)||G(this,a);this.b-=10},function(){var a=O(this);P(this,J(this));Yc(this,a);this.b-=18},function(){var a=M(this);ad(this)||(P(this,this.P),G(this,a),this.b-=6);this.b-=11},function(){P(this,
J(this));this.b-=11},function(){this.i=gd(this,L(this));this.b-=7},function(){P(this,this.P);G(this,32);this.b-=11},function(){ad(this)&&(G(this,O(this)),this.b-=6);this.b-=5},function(){G(this,J(this));this.b-=5},function(){var a=M(this);ad(this)&&G(this,a);this.b-=10},function(){var a=J(this);Yc(this,Wc(this));Xc(this,a);this.b-=5},function(){var a=M(this);ad(this)&&(P(this,this.P),G(this,a),this.b-=6);this.b-=11},Md,function(){this.i=Ed(this,L(this));this.b-=7},function(){P(this,this.P);G(this,
40);this.b-=11},function(){dd(this)||(G(this,O(this)),this.b-=6);this.b-=5},function(){var a=O(this);Rc(this,a&255|this.sa&-256);this.i=a>>8;this.b-=10},function(){var a=M(this);dd(this)||G(this,a);this.b-=10},function(){this.sa&=-513;this.b-=4},function(){var a=M(this);dd(this)||(P(this,this.P),G(this,a),this.b-=6);this.b-=11},function(){P(this,Tc(this)&255|this.i<<8);this.b-=11},function(){this.i=jd(this,L(this));this.b-=7},function(){P(this,this.P);G(this,48);this.b-=11},function(){dd(this)&&(G(this,
O(this)),this.b-=6);this.b-=5},function(){this.ka=J(this)&65535;this.b-=5},function(){var a=M(this);dd(this)&&G(this,a);this.b-=10},function(){this.sa|=512;this.b-=4;Fd(this)},function(){var a=M(this);dd(this)&&(P(this,this.P),G(this,a),this.b-=6);this.b-=11},Md,function(){K(this,L(this));this.b-=7},function(){P(this,this.P);G(this,56);this.b-=11}];
function S(a){w.call(this,"ChipSet",a,S,32768);var b=a.model;b&&!Nd[b]&&Oa("Unrecognized ChipSet model: "+b);this.A=Nd[b]||{};a.sound&&(this.ga=null,window&&(this.ga=window.AudioContext||window.webkitAudioContext),this.ga&&new this.ga);E(this)}bb(S);
var T={za:1978.1,rd:{Aa:0,be:1,fe:16,me:32,ve:64,ue:128,ub:14},Ya:{Aa:1,Sc:1,ld:2,gd:4,hd:16,jd:32,kd:64,ub:8},sd:{Aa:2,ae:3,De:4,ce:8,qe:16,re:32,se:64,de:128,ub:0},ze:{Aa:3},xe:{Aa:2,ne:7},Be:{Aa:3,Ee:1,Ae:2,te:4,ke:8,ee:16,Yd:32},ye:{Aa:4},Ce:{Aa:5,ge:1,he:2,ie:4,je:8,Fe:16}},U={za:100,Ja:{Aa:66,mc:1,ic:2,fd:4,pe:8,oe:16,kc:32,jc:64,fc:128},Rc:{Aa:66,INIT:0},Wa:{Aa:194,$d:0,ec:16,md:32,lc:48,Wc:0,Xc:32},Ib:{Aa:162,we:0,Zc:0,Vc:0,Yc:0,Uc:0},Ka:{le:{Aa:98},Va:{Oc:0,Nc:1,od:2,td:4,Tc:5,nd:6,pd:7},
Jb:16383}},Nd={SI1978:T,VT100:U};S.prototype.la=function(){return!1};S.prototype.Qa=function(a,b,c,d){this.w=b;this.b=c;this.I=d;this.C=a;this.K=vb(a,"Keyboard");this.Na=vb(a,"SerialPort");this.video=vb(a,"Video");Hb(b,this,this.A.Qb);Tb(b,this,this.A.Rb);if(d){var e=this;Od(d,16384,function(){for(var a="",b=0;b<e.F.length;b++)a&&(a+=b&&b%10?", ":",\n"),a+=t(e.F[b]);e.I.g(a)})}};S.prototype.Ea=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};
S.prototype.Ha=function(a){return a?this.save():!0};T.INIT=[[T.rd.ub,T.Ya.ub,T.sd.ub,0,0,0,0]];
U.INIT=[[U.Rc.INIT,U.Ja.ic|U.Ja.fd],[U.Wa.Wc,U.Wa.Xc],[U.Ib.Zc,U.Ib.Vc,U.Ib.Yc,U.Ib.Uc],[0,0,0,0,[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11776,11984,11888,11776,11808,11776,12E3,12E3,11901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11904,11776,11784,11918,11808,11984,11856,11776,11808,11776,12E3,12E3,11881,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]];m=S.prototype;m.reset=function(){this.A.INIT&&!this.restore(this.A.INIT)&&this.ia("reset error")};
m.save=function(){var a=new H(this);switch(this.A.za){case T.za:I(a,0,[this.Ba,this.H,this.Ca,this.ba,this.fa,this.ua,this.ya]);break;case U.za:I(a,0,[this.ha,this.L]),I(a,1,[this.N,this.O]),I(a,2,[this.J,this.ca,this.qa,this.pa]),I(a,3,[this.X,this.j,this.R,this.da,this.F])}return a.data()};
m.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.A.za){case T.za:return this.Ba=b[0],this.H=b[1],this.Ca=b[2],this.ba=b[3],this.fa=b[4],this.ua=b[5],this.ya=b[6],!0;case U.za:return this.ha=b[0],this.L=b[1],b=a[1],this.N=b[0],this.O=b[1],b=a[2],this.J=b[0],this.ca=b[1],this.qa=b[2],this.pa=b[3],b=a[3],this.X=b[0],this.j=b[1],this.R=b[2],this.da=b[3],this.F=b[4],!0}return!1};m.start=function(){};m.stop=function(){};m.Ad=function(a,b){var c=this.Ba;D(this,a,null,b,"STATUS0",c,!0);return c};
m.Bd=function(a,b){var c=this.H;D(this,a,null,b,"STATUS1",c,!0);return c};m.Cd=function(a,b){var c=this.Ca;D(this,a,null,b,"STATUS2",c,!0);return c};m.zd=function(a,b){var c=this.ba>>8-this.fa&255;D(this,a,null,b,"SHIFT.RESULT",c,!0);return c};m.Jd=function(a,b,c){D(this,a,b,c,"SHIFT.COUNT",null,!0);this.fa=b};m.Ld=function(a,b,c){D(this,a,b,c,"SOUND1",null,!0);this.ua=b};m.Kd=function(a,b,c){D(this,a,b,c,"SHIFT.DATA",null,!0);this.ba=b<<8|this.ba>>8};
m.Md=function(a,b,c){D(this,a,b,c,"SOUND2",null,!0);this.ya=b};m.Nd=function(a,b,c){D(this,a,b,c,"WATCHDOG",null,!0)};function Pd(a){var b=0,c=0,d=~a.X;for(a=0;10>a;a++)d&1&&(b=9-a),d>>=1;for(a=0;10>a;a++)d&1&&(c=9-a),d>>=1;return 10*b+c}
m.Dd=function(a,b){var c=this.L,c=c&~U.Ja.jc;if((Gc(this.b)&64)<<1&&(c|=U.Ja.jc,c!=this.L)){var d,e;d=this.R&1;e=this.R>>1&7;switch(e){case U.Ka.Va.pd:break;case U.Ka.Va.Nc:this.X=this.X<<1|d;break;case U.Ka.Va.Tc:d=Pd(this);this.F[d]=U.Ka.Jb;jb(this,"doNVRCommand(): erase data at addr "+t(d));break;case U.Ka.Va.Oc:this.j=this.j<<1|d;break;case U.Ka.Va.td:d=Pd(this);e=this.j&U.Ka.Jb;this.F[d]=e;jb(this,"doNVRCommand(): write data "+t(e)+" to addr "+t(d));break;case U.Ka.Va.nd:d=Pd(this);e=this.F[d];
null==e&&(e=U.Ka.Jb);this.j=e;jb(this,"doNVRCommand():  read data "+t(e)+" from addr "+t(d));break;case U.Ka.Va.od:this.j<<=1;this.da=this.j&U.Ka.Jb+1;break;default:jb(this,"doNVRCommand(): unrecognized command "+da(e))}}c&=~U.Ja.kc;this.da&&(c|=U.Ja.kc);c&=~U.Ja.fc;if(d=this.K){d=this.K;if(e=d.F)e=d.b,e=Gc(d.b)>=d.L+e.u.Bb*e.u.Sa/1E3*1.2731488;e&&(d.F=!1);d=!d.F}d&&(c|=U.Ja.fc);c&=~U.Ja.mc;this.Na&&this.Na.Da&1&&(c|=U.Ja.mc);this.L=c;D(this,a,null,b,"FLAGS",c);return c};
m.Od=function(a,b,c){D(this,a,b,c,"BRIGHTNESS");this.ha=b};m.Rd=function(a,b,c){D(this,a,b,c,"NVR.LATCH");this.R=b};m.Qd=function(a,b,c){D(this,a,b,c,"DC012");a=b&3;switch(b>>2&3){case 0:this.J=this.J&-4|a;break;case 1:this.J=this.J&-13|a<<2;this.video&&(b=this.video,a=this.J,jb(b,"updateScrollOffset("+a+")"),b.hb!==a&&((b.hb=a)?Mc(b,!0):b.xb=!0));break;case 2:switch(a){case 0:this.ca=~this.ca;break;case 2:case 3:this.qa=3-a}break;case 3:this.pa=a}};
m.Pd=function(a,b,c){D(this,a,b,c,"DC011");b&U.Wa.md?(b&=U.Wa.lc,this.O!=b&&(this.O=b,this.video&&(a=this.video,b=this.O==U.Wa.lc?50:60,jb(a,"updateRate("+b+")"),a.Jc=b))):(b&=U.Wa.ec,this.N!=b&&(this.N=b,this.video&&(a=this.N==U.Wa.ec?132:80,b=this.video,jb(b,"updateDimensions("+a+","+(80<a&&this.L&U.Ja.ic?14:24)+")"),b.da=a,b.na=b.vc,80<a&&b.na--,Qd(b)&&Rd(b))))};T.Qb={0:S.prototype.Ad,1:S.prototype.Bd,2:S.prototype.Cd,3:S.prototype.zd};
T.Rb={2:S.prototype.Jd,3:S.prototype.Ld,4:S.prototype.Kd,5:S.prototype.Md,6:S.prototype.Nd};U.Qb={66:S.prototype.Dd};U.Rb={66:S.prototype.Od,98:S.prototype.Rd,162:S.prototype.Qd,194:S.prototype.Pd};Ma(function(){for(var a=C(document,"pc8080","chipset"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new S(d);hb(d,c)}});
function Sd(a){w.call(this,"ROM",a,Sd);this.C=null;this.J=a.addr;this.j=a.size;this.H=a.writable;this.A=a.alias;this.F=a.file;this.K=ea(this.F);if(this.F){a=this.F;var b=fa(this.K);"json"!=b&&"hex"!=b&&(a=ha()+"/api/v1/dump?file="+this.F+"&format=bytes&decimal=true");var c=this;sa(a,null,!0,function(a,b,f){Td(c,a,b,f)})}}bb(Sd);var Ud=[0,5];Sd.prototype.Qa=function(a,b,c,d){this.w=b;this.b=c;this.I=d;Vd(this)};
Sd.prototype.Ea=function(){if(this.Ra){if(this.I){var a=this.I,b=this.id,c=this.J,d=this.j,e=this.Ra,f=[],h;for(h in e){var g=e[h];"number"==typeof g&&(e[h]=g={o:g});var k=g.o,l=g.a;if(void 0!==k){var p=f,k=[k>>>0,h],q=oa(p,k,a.Ua);0>q&&p.splice(-(q+1),0,k)}l&&(g.a=l.replace(/''/g,'"'))}a.H.push({Ge:b,G:c,Fd:d,Ra:e,nc:f})}delete this.Ra}return!0};Sd.prototype.Ha=function(){return!0};
function Td(a,b,c,d){if(d)a.ia("Unable to load system ROM (error "+d+": "+b+")");else{db(a.Kb,b,c);if("["==c.charAt(0)||"{"==c.charAt(0))try{var e=eval("("+c+")"),f=e.bytes,h=e.data;if(f)a.C=f;else if(h)for(a.C=Array(4*h.length),d=c=0;c<h.length;c++)a.C[d++]=h[c]&255,a.C[d++]=h[c]>>8&255,a.C[d++]=h[c]>>16&255,a.C[d++]=h[c]>>24&255;else a.C=e;a.Ra=e.symbols;if(!a.C.length){v("Empty ROM: "+b);return}if(1==a.C.length){v(a.C[0]);return}}catch(g){a.ia("ROM data error: "+g.message);return}else for(b=c.replace(/\n/gm,
" ").replace(/ +$/,"").split(" "),a.C=Array(b.length),e=0;e<b.length;e++)a.C[e]=ca(b[e],16);Vd(a)}}
function Vd(a){if(!pb(a))if(!a.F)E(a);else if(a.C&&a.w){a.j||(a.j=a.C.length);if(a.C.length!=a.j)qb(a,"ROM size (0x"+n(a.C.length)+") does not match specified size ("+("0x"+n(a.j))+")");else if(Wd(a,a.J)){var b=[];"number"==typeof a.A?b.push(a.A):null!=a.A&&a.A.length&&(b=a.A);for(var c=0;c<b.length;c++){for(var d=a,e=b[c],f=d.w,h=d.j,g=[],k=d.J>>>f.oa;0<h&&k<f.Y.length;)g.push(f.Y[k++]),h-=f.Ga;f=d.w;d=d.j;h=0;for(e>>>=f.oa;0<d&&e<f.Y.length;){k=g[h++];if(!k)break;f.Y[e++]=k;d-=f.Ga}}delete a.C}E(a)}}
function Wd(a,b){if(zb(a.w,b,a.j,a.H?1:ac)){var c;for(c=0;c<a.C.length;c++)Fb(a.w,b+c,a.C[c]);if(a.H&&256==b){for(c=0;c<Ud.length;c++)Fb(a.w,Ud[c],118);Qc(a.b,function(a){return function(b){if(0<=Ud.indexOf(b)){var c=!1,h=a.b,g=a.I;if(5==b)switch(c=!0,h.T){case 2:Xd(a,String.fromCharCode(h.V));break;case 9:for(var k=Wc(h),l="",p=255;p--;){var q=a.b.$(k++);if(36==q)break;l+=String.fromCharCode(q)}Xd(a,l);break;default:c=!1}c?Ld.call(h):g&&(a.g("\nCP/M vector "+t(b)),G(h,b),g.ma());b=!0}else b=!1;return b}}(a));
Sc(a.b,b)}return!0}return!1}function Xd(a,b){b=b.replace(/\r/g,"");a.Fa&&(a.Fa.value+=b,a.Fa.scrollTop=a.Fa.scrollHeight)}Ma(function(){for(var a=C(document,"pc8080","rom"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new Sd(d);hb(d,c)}});function Yd(a){w.call(this,"RAM",a,Yd);this.A=a.addr;this.j=a.size;this.C=!1}bb(Yd);m=Yd.prototype;m.Qa=function(a,b,c,d){this.w=b;this.b=c;this.I=d;E(this)};m.Ea=function(a,b){b||this.reset();return!0};m.Ha=function(a){return a?this.save():!0};
m.reset=function(){!this.C&&this.j&&zb(this.w,this.A,this.j,1)&&(this.C=!0);this.C||v("No RAM allocated")};m.save=function(){return null};m.restore=function(){return!0};Ma(function(){for(var a=C(document,"pc8080","ram"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new Yd(d);hb(d,c)}});function Zd(a){w.call(this,"Keyboard",a,Zd,65536);(a=a.model)&&!$d[a]&&Oa("Unrecognized Keyboard8080 model: "+a);this.w=$d[a]||{};this.reset();E(this)}bb(Zd);
var ae={za:1978.1,B:{},dc:{65:37,68:39,76:32},vb:{},Xa:{"1p":49,"2p":50,coin:51,left:37,right:39,fire:32}},V={za:100,B:{},dc:{},vb:{},Xa:{setup:120},Pc:{Aa:130,INIT:127},La:{Aa:130,dd:1,cd:2,bd:4,ad:8,ed:16,hc:32,gc:63,qd:64,Zd:128,INIT:0},$c:127};V.B[46]=3;V.B[80]=5;V.B[79]=6;V.B[89]=7;V.B[84]=8;V.B[87]=9;V.B[81]=10;V.B[39]=16;V.B[221]=20;V.B[219]=21;V.B[73]=22;V.B[85]=23;V.B[82]=24;V.B[69]=25;V.B[49]=26;V.B[37]=32;V.B[40]=34;V.B[117]=35;V.B[19]=35;V.B[192]=36;V.B[189]=37;V.B[57]=38;V.B[55]=39;
V.B[52]=40;V.B[51]=41;V.B[27]=42;V.B[38]=48;V.B[114]=49;V.B[112]=50;V.B[8]=51;V.B[187]=52;V.B[48]=53;V.B[56]=54;V.B[54]=55;V.B[53]=56;V.B[50]=57;V.B[9]=58;V.B[103]=64;V.B[115]=65;V.B[113]=66;V.B[96]=67;V.B[118]=68;V.B[220]=69;V.B[76]=70;V.B[75]=71;V.B[71]=72;V.B[70]=73;V.B[65]=74;V.B[104]=80;V.B[2013]=81;V.B[98]=82;V.B[97]=83;V.B[222]=85;V.B[186]=86;V.B[74]=87;V.B[72]=88;V.B[68]=89;V.B[83]=90;V.B[110]=96;V.B[116]=97;V.B[101]=98;V.B[100]=99;V.B[13]=100;V.B[190]=101;V.B[188]=102;V.B[78]=103;
V.B[66]=104;V.B[88]=105;V.B[119]=106;V.B[105]=112;V.B[99]=113;V.B[102]=114;V.B[109]=115;V.B[191]=117;V.B[77]=118;V.B[32]=119;V.B[86]=120;V.B[67]=121;V.B[90]=122;V.B[120]=123;V.B[17]=124;V.B[16]=125;V.B[20]=126;V.vb={l4:V.La.dd,l3:V.La.cd,l2:V.La.bd,l1:V.La.ad,locked:V.La.ed,local:V.La.hc,online:~V.La.hc};var $d={SI1978:ae,VT100:V};
Zd.prototype.la=function(a,b,c){var d=this,e=a+"-"+b;if(void 0===this.M[e]){if("led"==a&&this.w.vb[b])return this.M[e]=c,!0;switch(b){case "kbd":return c.onkeydown=function(a){return be(d,a,!0)},c.onkeyup=function(a){return be(d,a,!1)},!0;default:if(this.w.Xa&&void 0!==this.w.Xa[b])return this.M[e]=c,a=function(a,b){return function(c){c.preventDefault();ce(a,b,!0)}}(this,this.w.Xa[b]),b=function(a,b){return function(){ce(a,b,!1)}}(this,this.w.Xa[b]),"ontouchstart"in window?(c.ontouchstart=a,c.ontouchend=
b):(c.onmousedown=a,c.onmouseup=c.onmouseout=b),!0}}return!1};Zd.prototype.Qa=function(a,b,c,d){this.C=a;this.b=c;this.I=d;this.J=vb(a,"ChipSet");Hb(b,this,this.w.Qb);Tb(b,this,this.w.Rb)};Zd.prototype.Ea=function(a,b){if(!b)if(!a)this.reset();else if(!this.restore(a))return!1;return!0};Zd.prototype.Ha=function(a){return a?this.save():!0};V.INIT=[[V.La.INIT,V.Pc.INIT,!1,0,-1]];m=Zd.prototype;m.reset=function(){this.j=[];this.w.INIT&&!this.restore(this.w.INIT)&&this.ia("reset error")};
m.save=function(){var a=new H(this);switch(this.w.za){case V.za:I(a,0,[this.K,this.H,this.F,this.L,-1])}return a.data()};m.restore=function(a){var b;if(a&&(b=a[0])&&b.length)switch(this.w.za){case ae.za:return!0;case V.za:return this.K=b[0],de(this,this.K&V.La.gc),this.H=b[1],this.F=b[2],this.L=b[3],this.A=b[4],!0}return!1};function de(a,b){for(var c in a.w.vb){var d=a.M["led-"+c];if(d){var e=a.w.vb[c],f=!!(b&e);e&e-1&&(f=!(b&~e));d.style.backgroundColor=f?"#ff0000":"#000000"}}}
function be(a,b,c){var d=!0,e;a:if(e=b.keyCode,e=a.w.dc[e]||e,!a.w.B[e]){for(var f in a.w.Xa)if(a.w.Xa[f]===e){e=f;break a}e=null}e&&(d=ce(a,e,c),b.preventDefault());return d}
function ce(a,b,c){var d;a:{for(d=0;d<a.j.length;d++)if(a.j[d].bc==b)break a;d=-1}if(c)0>d?a.j.push({bc:b,Yb:Date.now(),Lb:!1}):(a.j[d].Yb=Date.now(),a.j[d].Lb=!1);else if(0<=d){if(!a.j[d].Lb){var e=a.j[d].Yb;if(e&&100>Date.now()-e)return a.j[d].Lb=!0,ee(a),!0}a.j.splice(d,1)}if(a.J){d=0;switch(b){case "1p":d=T.Ya.gd;break;case "2p":d=T.Ya.ld;break;case "coin":d=T.Ya.Sc;break;case "left":d=T.Ya.jd;break;case "right":d=T.Ya.kd;break;case "fire":d=T.Ya.hd}d&&(a=a.J,b=d,a.H&=~b,c&&(a.H|=b))}return!0}
function ee(a){for(var b=0,c=-1;b<a.j.length;){if(a.j[b].Lb){var d=a.j[b].bc,e=100-(Date.now()-a.j[b].Yb);if(0<e){if(0>c||c>e)c=e}else{ce(a,d,!1);b=0;continue}}b++}0<=c&&setTimeout(function(){ee(a)},c)}m.Ed=function(a,b){var c=this.H;0<=this.A&&(this.A<this.j.length?(c=this.j[this.A],this.A++,c=V.B[c.bc],c&128&&(c&=127)):(this.A=-1,c=V.$c),this.H=c,Gd(this.b,1));D(this,a,null,b,"KBDUART.ADDRESS",c);return c};
m.Sd=function(a,b,c){D(this,a,b,c,"KBDUART.STATUS");this.K=b;this.F=!0;this.L=Gc(this.b);de(this,b&V.La.gc);b&V.La.qd&&(this.A=0,Gd(this.b,1))};V.Qb={130:Zd.prototype.Ed};V.Rb={130:Zd.prototype.Sd};Ma(function(){for(var a=C(document,"pc8080","keyboard"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new Zd(d);hb(d,c)}});
function fe(a,b,c,d,e){var f=this;this.Cc=Aa("Gecko/");var h=["","moz","ms","webkit"];w.call(this,"Video",a,fe,262144);this.ba=a.screenWidth;this.R=a.screenHeight;this.Ua=a.bufferAddr;this.Vd=a.bufferRAM;var g=a.bufferFormat;this.ya=g&&ge[g.toUpperCase()]||he;this.da=a.bufferCols;this.Ba=a.bufferRows;this.vc=this.na=a.cellWidth||1;this.ja=a.cellHeight||1;this.Ca=null;this.yc=!1;this.ab=a.bufferBits||1;this.Wd=a.bufferLeft||0;if(this.A=a.bufferRotate)this.A=this.A%360,0<this.A&&(this.A-=360),-90!=
this.A&&(this.ia("unsupported buffer rotation: "+this.A),this.A=0);this.bb=a.interruptRate;this.Kc=a.refreshRate||60;this.O=b;this.F=c;this.qa=(this.Qc=d)||b||null;this.Td=this.ba;this.Ud=this.R;this.wc=this.ba/this.da|0;this.xc=this.R/this.Ba|0;1<this.ja&&(this.Ba++,this.hb=0,this.xb=!1);b=a.smoothing;(c=Va.smoothing)&&(b="true"==c);if(null!=b)for(c=0;c<h.length;c++)if(d=(d=h[c])?d+"ImageSmoothingEnabled":"imageSmoothingEnabled",void 0!==this.F[d]){this.F[d]=b;break}if(this.J=a.screenRotate)this.J=
this.J%360,0<this.J&&(this.J-=360),-90!=this.J?(this.ia("unsupported screen rotation: "+this.J),this.J=0):(this.F.translate(0,this.R),this.F.rotate(this.J*Math.PI/180),this.F.scale(this.R/this.ba,this.ba/this.R));if(this.j=e)if(this.j.ib=e.requestFullscreen||e.msRequestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen,this.j.ib){for(c=0;c<h.length;c++)if(d=h[c]+"fullscreenchange","on"+d in document){document.addEventListener(d,function(){ie(f,document.fullscreenElement||document.msFullscreenElement||
document.mozFullScreenElement||document.webkitFullscreenElement?!0:!1)},!1);break}for(c=0;c<h.length;c++)if(d=h[c]+"fullscreenerror","on"+d in document){document.addEventListener(d,function(){ie(f,null)},!1);break}}if(this.fa=a.fontROM)"json"!=fa(this.fa)&&(this.fa=ha()+"/api/v1/dump?file="+this.fa+"&format=bytes"),sa(this.fa,null,!0,function(a,b,c){je(f,a,b,c)});this.Wb={}}bb(fe);var he=0,ge={SI1978:1,VT100:2};
function Qd(a){a.L=a.da*a.na;a.ca=a.Ba*a.ja;var b=a.L,c=a.ca;a.A&&(b=a.ca,c=a.L);a.X=0;if(!a.Vd&&(a.X=(a.L*a.ab>>3)*a.ca,!zb(a.w,a.Ua,a.X,3)))return!1;a.X?(a.Dc=a.F.createImageData(b,c),a.Fc=16/a.ab|0,ke(a,a.X>>1)):ke(a,(a.da+1)*a.Ba);a.N=document.createElement("canvas");a.N.width=b;a.N.height=c;a.wb=a.N.getContext("2d");a.ga={};a.ua=1<<a.ab;a.ha=Array(a.ua+2);a.ha[0]=[0,0,0,255];a.ha[1]=[255,255,255,255];1==a.ya&&(a.ha[a.ua+0]=[255,255,0,255],a.ha[a.ua+1]=[0,255,0,255]);2==a.ya&&(a.Jc=60,a.yb=!1,
a.Na=Array(a.da));return!0}fe.prototype.Qa=function(a,b,c,d){this.C=a;this.w=b;this.b=c;this.I=d;Qd(this);if(this.K=vb(a,"Keyboard")){for(var e in this.Wb)this.K.la("led",e,this.Wb[e]);this.O&&this.K.la(this.Qc?"textarea":"canvas","kbd",this.qa)}var f=this;this.Lc=Kc(this.b,function(){Mc(f)});Lc(this.b,this.Lc,1E3/Math.max(this.Kc,this.bb));this.Gc=0;this.fa||E(this)};
function je(a,b,c,d){if(d)a.ia("Unable to load font ROM (error "+d+": "+b+")");else{db(a.Kb,b,c);try{var e=eval("("+c+")"),f=e.bytes||e;if(!f||!f.length){v("Empty font ROM: "+b);return}if(1==f.length){v(f[0]);return}if(2048==f.length)a.Ca=f,Rd(a);else{a.ia("Unrecognized font data length ("+f.length+")");return}}catch(h){a.ia("Font ROM data error: "+h.message);return}(a.F||a.I)&&E(a)}}
function Rd(a){a.Ca&&(a.yc=2==a.ya,a.ga[96]=[le(a,a.na,a.ja),le(a,a.na,a.ja,a.yb)],a.ga[64]=[le(a,2*a.na,a.ja),le(a,2*a.na,a.ja,a.yb)],a.ga[32]=a.ga[0]=[le(a,2*a.na,2*a.ja),le(a,2*a.na,2*a.ja,a.yb)])}
function le(a,b,c,d){var e=8>=a.vc?8:16,f=8<e?15:0,h=a.Ca.length/e,g=!1===d,k={na:b,ja:c};k.canvas=document.createElement("canvas");k.canvas.width=16*b;k.canvas.height=h/16*c;k.context=k.canvas.getContext("2d");for(var l=k.context.createImageData(b,c),p=0;p<h;p++){for(var q=0,x=q;q<a.ja;q++)for(var u=p*e+(f+q&e-1),u=d&&8==q?255:a.Ca[u],r=0;r<c/a.ja;r++){for(var B=0,y=0,X=y;y<a.na;y++){for(var A=u&128>>(7<y?7:y),B=a.yc&&!A&&B?B:A,Q=0;Q<b/a.na;Q++)g&&(B=!B),me(a,l,X,x,B?1:0),X++;B=A}x++}k.context.putImageData(l,
(p&15)*b,(p>>4)*c)}return k}fe.prototype.Ea=function(){return!0};fe.prototype.la=function(a,b,c){var d=this;if("led"==a||"rled"==a)return this.Wb[b]=c,!0;switch(b){case "fullScreen":return this.M[b]=c,this.j&&this.j.ib?c.onclick=function(){d.ib()}:c.parentNode.removeChild(c),!0}return!1};
fe.prototype.ib=function(){var a=!1;if(this.j){if(this.j.ib){a="100%";if(screen&&screen.width&&screen.height){var b=screen.width/screen.height,c=this.ba/this.R;b>c&&(a=Math.round(c/b*100)+"%")}this.Cc?(this.O.style.width=a,this.O.style.width=a,this.O.style.display="block",this.O.style.margin="auto"):(this.j.style.width=a,this.j.style.height="auto");this.j.style.backgroundColor="black";this.j.ib();a=!0}this.qa&&this.qa.focus()}return a};
function ie(a,b){!b&&a.j&&(a.Cc?a.O.style.width=a.O.style.height="":a.j.style.width=a.j.style.height="");jb(a,"notifyFullScreen("+b+")")}function ke(a,b){a.Ec=b;a.pa=!1;if(void 0===a.H||a.H.length!=a.Ec)a.H=Array(a.Ec)}function me(a,b,c,d,e){d=a.A?(b.height-c-1)*b.width+d:c+d*b.width;e&&1==a.ya&&(208<=c&&236>c?e=a.ua+0:28<=c&&72>c&&(e=a.ua+1));a=a.ha[e];d*=a.length;b.data[d]=a[0];b.data[d+1]=a[1];b.data[d+2]=a[2];b.data[d+3]=a[3]}
function Mc(a,b){var c=!0;if(!b){a.bb&&(120==a.bb?a.Gc&1?(Gd(a.b,2),c=!1):Gd(a.b,1):Gd(a.b,4));if(c&&a.pa&&a.X){for(var d=a.w,e=a.X,f=!0,h=a.Ua>>>d.oa;0<e&&h<d.Y.length;)d.Y[h].Oa&&(d.Y[h].Oa=f=!1,d.Y[h].qc=!0),e-=d.Ga,h++;f&&(c=!1)}Lc(a.b,a.Lc,1E3/Math.max(a.Kc,a.bb));a.Gc++}if(c)if(1<a.na)switch(a.ya){case 2:for(var c=a.Ua,d=-1,e=0,f=60==a.Jc?2:5,g=h=0,k=-1;e<a.Ba;){var l=0,p=c,q=d,x=a.da;for(96!=q&&(x>>=1);;){var u=Cb(a.w,p++);if(127==(u&127)){var r=Cb(a.w,p++),d=r&96,c=(r&15)<<8|Cb(a.w,p),c=c+
(r&16?8192:16384);break}if(l<x)a.Na[l++]=u;else break}if(f)f--;else{for(;l<a.Na.length;)a.Na[l++]=0;if(0<=q)for(p=a.pa&&a.H[h]==x,a.H[h++]=x,x=0;x<l;x++){u=a.Na[x];if(!p||u!==a.H[h]){a.H[k=h]=u;var r=a,B=a.wb,y=u&127;if(u=r.ga[q][u&128?1:0]){var X=(y&15)*u.na,y=(y>>4)*u.ja,A=void 0,Q=void 0,aa=void 0,Y=void 0,ua=u.na,Eb=u.ja;B?(A=x*r.na,Q=e*r.ja,aa=r.na,Y=r.ja):(A=x*r.wc,Q=e*r.xc,aa=r.wc,Y=r.xc);u.na>r.na&&(A*=2,aa*=2);u.ja>r.ja&&(0==q&&(y+=r.ja),Eb=r.ja);B?B.drawImage(u.canvas,X,y,ua,Eb,A,Q,aa,Y):
(A+=0,Q+=0,r.F.drawImage(u.canvas,X,y,ua,Eb,A,Q,aa,Y))}g++}h++}e++}}a.pa=!0;!b&&a.xb&&1==g&&(a.H[k]=-1,g=0);a.xb=!1;(g||b)&&a.wb&&a.F.drawImage(a.N,0,a.hb,a.L,a.ca-a.ja,0,0,a.Td,a.Ud)}else{f=a.Ua;h=f+a.X;l=k=g=0;c=a.L;q=0;d=a.ca;p=e=0;x=a.ab;r=(1<<x)-1;a.Wd&&(x=-x,p=16+x);for(;f<h;){B=Db(a.w,f);if(a.pa&&B===a.H[g])k+=a.Fc;else{a.H[g]=B;(u=p)&&(B=B>>8|(B&255)<<8);k<c&&(c=k);for(X=a.Fc;X--;)y=B>>u&r,me(a,a.Dc,k++,l,y),u+=x;k>q&&(q=k);l<d&&(d=l);l>=e&&(e=l+1)}f+=2;g++;if(k>=a.L&&(k=0,l++,l>a.ca))break}a.pa=
!0;c<a.L&&(f=q-c,e-=d,a.A&&(h=c,g=f,c=d,f=e,d=a.L-(h+g),e=g),a.wb.putImageData(a.Dc,0,0,c,d,f,e),a.F.drawImage(a.N,0,0,a.N.width,a.N.height,0,0,a.ba,a.R))}}
Ma(function(){for(var a=C(document,"pc8080","video"),b=0;b<a.length;b++){var c=a[b],d=z(c),e=document.createElement("canvas");if(void 0===e||!e.getContext){c.innerHTML="<br/>Missing &lt;canvas&gt; support. Please try a newer web browser.";break}e.setAttribute("class","pcjs-canvas");e.setAttribute("width",d.screenWidth);e.setAttribute("height",d.screenHeight);e.style.backgroundColor=d.screenColor;e.style.height="auto";0<=ta().indexOf("MSIE")&&(c.onresize=function(a,b,c,d){return function(){b.style.height=
(a.clientWidth*d/c|0)+"px"}}(c,e,d.screenWidth,d.screenHeight),c.onresize());var f=+(d.aspect||Va.aspect);f&&.3<=f&&3.33>=f&&(La("onresize",function(a,b,c){return function(){b.style.height=(a.clientWidth/c|0)+"px"}}(c,e,f)),window.onresize());c.appendChild(e);f=document.createElement("textarea");Aa("iOS")&&(f.setAttribute("autocapitalize","off"),f.setAttribute("autocorrect","off"));c.appendChild(f);var h=e.getContext("2d"),d=new fe(d,e,h,f,c);hb(d,c)}});
function ne(a){this.fa=+a.adapter;switch(this.fa){case 0:this.ga=0;this.pa=2;break;default:v("Unrecognized serial adapter #"+this.fa);return}this.j=this.A=null;this.ha=a.tabSize;this.da=a.charBOL;this.F=0;this.ba=!1;w.call(this,"SerialPort",a,ne,8388608);var b=a.binding;if("console"==b)this.A="";else{var c;a=oe;b&&(void 0===c&&(c="Panel"),(c=gb(c,this.id))&&(b=c.M[b])&&this.la(null,a,b))}this.H="";this.K=this.N=null;this.exports={connect:this.uc,receiveData:this.ac}}bb(ne);
var pe=[50,75,110,134.5,150,200,300,600,1200,1800,2E3,2400,3600,4800,9600,19200],qe=[!1,0,0,133,142,39,238],oe="buffer";m=ne.prototype;
m.la=function(a,b,c,d){var e=this;switch(b){case oe:return this.M[b]=this.j=c,c.onkeydown=function(a){a=a||window.event;var b=a.keyCode;if(8===b||a.ctrlKey&&65<=b&&90>=b)a.preventDefault&&a.preventDefault(),64<b&&(b-=64),re(e,b);return!0},c.onkeypress=function(a){a=a||window.event;re(e,a.which||a.keyCode);a.preventDefault&&a.preventDefault();return!0},c.removeAttribute("readonly"),!0;default:if(d)return this.M[b]=c,d=d.replace(/\\e/g,String.fromCharCode(27)),c.onclick=function(){e.ac(d);return!0},
!0}return!1};m.Qa=function(a,b,c,d){this.C=a;this.w=b;this.b=c;this.I=d;var e=this;this.qa=Kc(this.b,function(){e.ac()});this.ua=Kc(this.b,function(){e.Da|=5});this.J=vb(a,"ChipSet");Hb(b,this,se,this.ga);Tb(b,this,te,this.ga);E(this)};
m.uc=function(){if(!this.K){var a=nc(this.C,"connection");if(a){var b=a.split("->");if(2==b.length){var c=ma(b[0]);if(c!=this.Za)return;b=ma(b[1]);if(this.K=fb(b)){var d=this.K.exports;if(d){var e=d.connect;e&&e.call(this.K);if(this.N=d.receiveData){this.status(this.Kb+"."+c+" connected to "+b);return}}}}this.status("Unable to establish connection: "+a)}}};m.Ea=function(a,b){if(!b)if(this.uc(),!a||!this.restore)this.reset();else if(!this.restore(a))return!1;return!0};
m.Ha=function(a){return a?this.save():!0};m.reset=function(){ue(this)};m.save=function(){var a=new H(this),b=0,c=[];c[b++]=this.Ma;c[b++]=this.X;c[b++]=this.ca;c[b++]=this.Da;c[b++]=this.L;c[b++]=this.R;c[b]=this.O;I(a,0,c);return a.data()};m.restore=function(a){return ue(this,a[0])};function ue(a,b){var c=0;void 0===b&&(b=qe);a.Ma=b[c++];a.X=b[c++];a.ca=b[c++];a.Da=b[c++];a.L=b[c++];a.R=b[c++];a.O=b[c];return!0}
function ve(a,b){var c=a.O&b;b&15||(c>>=4);var c=pe[c],d=((a.L&12)>>2)+6;a.L&16&&d++;d+=((a.L&192)>>6)+1>>1;return 1E3/Math.round(c/d)}function re(a,b){jb(a,"receiveByte("+da(b)+"), status="+da(a.Da));return a.ba||a.Da&2?!1:(a.X=b,a.Da|=2,Gd(a.b,a.pa),!0)}m.ac=function(a){null!=a&&(this.H="number"!=typeof a?a:this.H+String.fromCharCode(a));this.H&&(re(this,this.H.charCodeAt(0))&&(this.H=this.H.substr(1)),this.H&&this.b&&Lc(this.b,this.qa,ve(this,15)));return!0};
m.yd=function(a,b){var c=this.X;D(this,a,null,b,"DATA",c);this.Da&=-3;return c};m.xd=function(a,b){var c=this.Da;D(this,a,null,b,"STATUS",c);return c};
m.Id=function(a,b,c){D(this,a,b,c,"DATA");this.ca=b;this.Da&=-6;jb(this,"transmitByte("+da(b)+")");if(19==b)this.ba=!0;else if(17==b)this.ba=!1;else if(this.N&&this.N.call(this.K,b),this.j)8==b?(this.j.value=this.j.value.slice(0,-1),0<this.F&&this.F--):(a=(a=na[b])?"<"+a+">":String.fromCharCode(b),c=a.length,9==b?(b=this.ha||8,c=b-this.F%b,this.ha&&(a=la("",c))):13==b&&(this.F=c=0,a="\n"),this.da&&!this.F&&c&&(a=String.fromCharCode(this.da)+a),this.j.value+=a,this.j.scrollTop=this.j.scrollHeight,
this.F+=c);else if(null!=this.A){if(10==b||1024<=this.A.length)this.g(this.A),this.A="";10!=b&&(this.A+=String.fromCharCode(b))}this.b&&Lc(this.b,this.ua,ve(this,240))};m.Hd=function(a,b,c){D(this,a,b,c,"CONTROL");this.Ma?(this.R=b,this.R&64&&(this.Ma=!1)):(this.L=b,this.Ma=!0)};m.Gd=function(a,b,c){D(this,a,b,c,"BAUDRATES");this.O=b};var se={0:ne.prototype.yd,1:ne.prototype.xd},te={0:ne.prototype.Id,1:ne.prototype.Hd,2:ne.prototype.Gd};
Ma(function(){for(var a=C(document,"pc8080","serial"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new ne(d);hb(d,c)}});
function we(a){w.call(this,"Debugger",a,we);this.style=xe;this.ba=this.ya=this.L=0;this.O=W();this.ab=W();this.F=-1;this.A=[];this.da=!1;this.ca=W();this.H=[];this.fa={};this.j=this.R=this.J=[];ye(this);this.pa=0;ze(this);this.Ba=[];Ae(this,a.messages);this.Ca=a.commands;var b=this;window?void 0===window.pc8080&&(window.pc8080=function(a){return Cc(b,a)}):void 0===global.pc8080&&(global.pc8080=function(a){return Cc(b,a)})}bb(we);
var Be={"?":"help/print","a [#]":"assemble","b [#]":"breakpoint",c:"clear output","d [#]":"dump memory","e [#]":"edit memory",f:"frequencies","g [#]":"go [to #]",h:"halt","i [#]":"input port #","if":"eval expression","int [#]":"request interrupt",k:"stack trace",ln:"list nearest symbol(s)",m:"messages","o [#]":"output port #",p:"step over",print:"print expression",r:"dump/set registers",reset:"reset machine",s:"set options","t [#]":"trace","u [#]":"unassemble",v:"print version","var":"assign variable"},
xe=8080,Ce="NONE ACI ADC ADD ADI ANA ANI CALL CC CM CNC CNZ CP CPE CPO CZ CMA CMC CMP CPI DAA DAD DCR DCX DI EI HLT IN INR INX JMP JC JM JNC JNZ JP JPE JPO JZ LDA LDAX LHLD LXI MOV MVI NOP ORA ORI OUT PCHL POP PUSH RAL RAR RET RC RM RNC RNZ RP RPE RPO RZ RLC RRC RST SBB SBI SHLD SPHL STA STAX STC SUB SUI XCHG XRA XRI XTHL".split(" "),De="NONE ADC ADC ADD ADD AND AND CALL CALLC CALLS CALLNC CALLNZ CALLNS CALLP CALLNP CALLZ NOT CMC CMP CMP DAA ADD DEC DEC CLI STI HLT IN INC INC JMP JC JS JNC JNZ JNS JP JNP JZ MOV MOV MOV MOV MOV MOV NOP OR OR OUT JMP POP PUSH RCL RCR RET RETC RETS RETNC RETNZ RETNS RETP RETNP RETZ ROL ROR RST SBB SBB MOV MOV MOV MOV STC SUB SUB XCHG XOR XOR XCHG".split(" "),
Ee="B C D E H L M A BC DE HL SP PC PS PSW".split(" "),Fe=[[45],[42,2067,32],[71,2131,18193],[29,2067],[28,17],[22,17],[44,17,32],[63],[45,32768],[21,18963,2067],[40,18193,2131],[23,2067],[28,273],[22,273],[44,273,32],[64],[45,32768],[42,2323,32],[71,2387,18193],[29,2323],[28,529],[22,529],[44,529,32],[52],[45,32768],[21,18963,2323],[40,18193,2387],[23,2323],[28,785],[22,785],[44,785,32],[53],[45,32768],[42,2579,32],[68,115,18963],[29,2579],[28,1041],[22,1041],[44,1041,32],[20],[45,32768],[21,18963,
2579],[41,18963,115],[23,2579],[28,1297],[22,1297],[44,1297,32],[16,18193],[45,32768],[42,2835,32],[70,115,18193],[29,2835],[28,1617],[22,1617],[44,1617,32],[72],[45,32768],[21,18963,2835],[39,18193,115],[23,2835],[28,1809],[22,1809],[44,1809,32],[17],[43,17,17],[43,17,273],[43,17,529],[43,17,785],[43,17,1041],[43,17,1297],[43,17,1617],[43,17,1809],[43,273,17],[43,273,273],[43,273,529],[43,273,785],[43,273,1041],[43,273,1297],[43,273,1617],[43,273,1809],[43,529,17],[43,529,273],[43,529,529],[43,529,
785],[43,529,1041],[43,529,1297],[43,529,1617],[43,529,1809],[43,785,17],[43,785,273],[43,785,529],[43,785,785],[43,785,1041],[43,785,1297],[43,785,1617],[43,785,1809],[43,1041,17],[43,1041,273],[43,1041,529],[43,1041,785],[43,1041,1041],[43,1041,1297],[43,1041,1617],[43,1041,1809],[43,1297,17],[43,1297,273],[43,1297,529],[43,1297,785],[43,1297,1041],[43,1297,1297],[43,1297,1617],[43,1297,1809],[43,1617,17],[43,1617,273],[43,1617,529],[43,1617,785],[43,1617,1041],[43,1617,1297],[26],[43,1617,1809],
[43,1809,17],[43,1809,273],[43,1809,529],[43,1809,785],[43,1809,1041],[43,1809,1297],[43,1809,1617],[43,1809,1809],[3,18193,17],[3,18193,273],[3,18193,529],[3,18193,785],[3,18193,1041],[3,18193,1297],[3,18193,1617],[3,18193,1809],[2,18193,17],[2,18193,273],[2,18193,529],[2,18193,785],[2,18193,1041],[2,18193,1297],[2,18193,1617],[2,18193,1809],[73,18193,17],[73,18193,273],[73,18193,529],[73,18193,785],[73,18193,1041],[73,18193,1297],[73,18193,1617],[73,18193,1809],[66,18193,17],[66,18193,273],[66,
18193,529],[66,18193,785],[66,18193,1041],[66,18193,1297],[66,18193,1617],[66,18193,1809],[5,18193,17],[5,18193,273],[5,18193,529],[5,18193,785],[5,18193,1041],[5,18193,1297],[5,18193,1617],[5,18193,1809],[76,18193,17],[76,18193,273],[76,18193,529],[76,18193,785],[76,18193,1041],[76,18193,1297],[76,18193,1617],[76,18193,1809],[46,18193,17],[46,18193,273],[46,18193,529],[46,18193,785],[46,18193,1041],[46,18193,1297],[46,18193,1617],[46,18193,1809],[18,18193,17],[18,18193,273],[18,18193,529],[18,18193,
785],[18,18193,1041],[18,18193,1297],[18,18193,1617],[18,18193,1809],[58],[50,2067],[34,51],[30,51],[11,51],[51,2067],[4,18193,33],[65,128],[62],[54],[38,51],[30,32819],[15,51],[7,51],[1,18193,33],[65,128],[57],[50,2323],[33,51],[48,33,18193],[10,51],[51,2323],[74,18193,33],[65,128],[55],[54,32768],[31,51],[27,18193,33],[8,51],[7,32819],[67,18193,33],[65,128],[61],[50,2579],[37,51],[78,19283,18963],[14,51],[51,2579],[6,18193,33],[65,128],[60],[49,2579],[36,51],[75,18963,18707],[13,51],[7,32819],[77,
18193,33],[65,128],[59],[50,3603],[35,51],[24],[12,51],[51,3603],[47,18193,33],[65,128],[56],[69,19219,18963],[32,51],[25],[9,51],[7,32819],[19,18193,33],[65,128]];m=we.prototype;
m.Qa=function(a,b,c,d){this.w=b;this.b=c;this.C=a;(a=nc(a,"messages"))&&Ae(this,a);this.Na=Fe;Od(this,64,function(a){a:{var b=d.w.Y,c=a[0],g=a=0,k=b.length;if(c){a=Ge(He(d,c));if(-1===a){d.g("invalid address: "+c);break a}g=a>>>d.w.oa;k=1}d.g("blockid   physical   blockaddr   used    size    type");d.g("--------  ---------  ----------  ------  ------  ----");for(var c=-1,l=0;k--;){var p=b[g];p.type==c?l++||d.g("..."):(c=p.type,l=Bb[c],p&&d.g(n(p.id)+"  %"+n(g<<d.w.oa)+"  %%"+n(p.G)+"  "+t(p.Gb)+"  "+
t(p.size)+"  "+l),c!=$b&&(c=-1),l=0);a+=d.w.Ga;g++}}});E(this)};
m.la=function(a,b,c){var d=this;switch(b){case "debugInput":return this.ha=this.M[b]=c,c.onkeydown=function(a){var b;if(13==a.keyCode)b=c.value,c.value="",Cc(d,b,!0);else if(27==a.keyCode)c.value=b="";else if(38==a.keyCode?d.F<d.A.length-1&&(b=d.A[++d.F]):40==a.keyCode&&(0<d.F?b=d.A[--d.F]:(b="",d.F=-1)),null!=b){var h=b.length;c.value=b;c.setSelectionRange(h,h)}null!=b&&a.preventDefault&&a.preventDefault()},!0;case "debugEnter":return this.M[b]=c,Ca(c,function(){if(d.ha){var a=d.ha.value;d.ha.value=
"";Cc(d,a,!0);return!0}return!1}),!0;case "step":return this.M[b]=c,Ca(c,function(a){var b=!1;mb(d,!0)||(lb(d,!0),b=d.sb(a?1:0),lb(d,!1));return b}),!0}return!1};m.Fb=function(){this.ha&&this.ha.focus()};function Ge(a){a=a&&a.G;null==a&&(a=-1);return a}m.$=function(a,b){var c=255,d=Ge(a);-1!==d&&(c=Cb(this.w,d),b&&Ie(a,b));return c};m.Ta=function(a,b){var c=65535,d=Ge(a);-1!==d&&(c=Db(this.w,d),b&&Ie(a,b));return c};m.ta=function(a,b,c){var d=Ge(a);-1!==d&&(Fb(this.w,d,b),c&&Ie(a,c),Dc(this.b,!0))};
m.Sb=function(a,b,c){var d=Ge(a);if(-1!==d){var e=this.w,f=d&e.w,h=(d&e.A)>>>e.oa;f!=e.w?e.Y[h].cc(f,b&65535,d):(e.Y[h++].Hb(f,b&255,d),e.Y[h&e.K].Hb(0,b>>8&255,d+1));c&&Ie(a,c);Dc(this.b,!0)}};function W(a){return{G:a,Pa:!1}}function Je(a){return[a.G,a.Pa]}function Ke(a){return{G:a[0],Pa:a[1]}}
function He(a,b,c){var d;c=(c?a.O:a.ab).G;if(void 0!==b){d=b=Le(a,b);var e;if(d.match(/^[a-z_][a-z0-9_]*$/i))for(d=d.toUpperCase(),c=0;c<a.H.length;c++){var f=a.H[c].Ra[d];if(void 0!==f){d=f.o;void 0!==d&&(e=W(d));break}}if(d=e)return d;c=Me(a,b,void 0)}null!=c&&(d=W(c));return d}function Ne(a,b,c){c&&(c=c.match(/(['"])(.*?)\1/))&&(b.ud=Oe(a,b.Ic=c[2]))}function Ie(a,b){null!=a.G&&(a.G+=b||1)}function Z(a){return n(a,4)}
function Pe(a,b,c){var d="";for(c=c||256;d.length<c;){var e=a.$(b,1);if(!e||36==e||127<=e)break;d+=32<=e?String.fromCharCode(e):"."}return d}function Ae(a,b){a.I=a;a.ra=a.vd=536870912;a.qa=null;a.ua=[];var c=Oe(a,b.replace("keys","key").replace("kbd","keyboard"),!1,"|");if(c.length)for(var d in tb)0<=ra(c,d)&&(a.ra|=tb[d],a.g(d+" messages enabled"))}function Od(a,b,c){for(var d in tb)if(b==tb[d]){a.Ba[d]=c;break}}
function Qe(a,b){var c;a=a.toUpperCase();null==b?c=ra(Ee,a):(c=ra(Ee,a.substr(b,2)),0>c&&(c=ra(Ee,a.substr(b,1))));return c}function Re(a,b){var c=0,d=Se(a,b);if(void 0!==d)switch(b){case 7:case 0:case 1:case 2:case 3:case 4:case 5:case 6:c=2;break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:c=4}return c?n(d,c):"??"}
function Se(a,b){var c;if(0<=b){var d=a.b;switch(b){case 7:c=d.i;break;case 0:c=d.S;break;case 1:c=d.T;break;case 8:c=Uc(d);break;case 2:c=d.U;break;case 3:c=d.V;break;case 9:c=Wc(d);break;case 4:c=d.W;break;case 5:c=d.Z;break;case 10:c=J(d);break;case 6:c=d.$(J(d));break;case 11:c=d.ka;break;case 12:c=d.P;break;case 13:c=Tc(d);break;case 14:c=Tc(d)&255|d.i<<8}}return c}
function Te(a,b){b=Le(a,b);for(var c=0,d,e;0<=(c=b.indexOf("@",c));)e=Qe(b,c+1),0<=e&&(b=b.substr(0,c)+Re(a,e)+b.substr(c+1+Ee[e].length)),c++;for(c=0;0<=(c=b.indexOf("#",c));)e=b.substr(c+1,2),d=ca(e,16),null!=d&&32<=d&&128>d?(d=e+" '"+String.fromCharCode(d)+"'",b=b.replace("#"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("$",c));)e=b.substr(c+1,9),(d=He(a,e))?(d=e+' "'+Pe(a,d)+'"',b=b.replace("$"+e,d),c+=d.length):c++;for(c=0;0<=(c=b.indexOf("^",c));)e=b.substr(c+1,9),(d=He(a,e))?(Ie(d),d=e+' "'+
Pe(a,d,11)+'"',b=b.replace("^"+e,d),c+=d.length):c++;return b}m.message=function(a,b){b&&(a+=" at "+Z(W(this.b.P).G));if(this.ra&1073741824)this.ua.push(a);else if(!this.qa||a!=this.qa)if(this.qa=a,this.ra&-2147483648&&(this.ma(),a+=" (cpu halted)"),this.g(a),this.b){var c=this.b;c.u.qb=0;c.j-=c.b;c.b=0;Dc(c)}};
function ib(a,b,c,d,e,f,h,g){g|=256;null!=f&&(a.ra&g)!=g||a.message(b.Za+"."+(null!=d?"outPort":"inPort")+"("+t(c)+","+(f?f:"unknown")+(null!=d?","+da(d):"")+")"+(null!=h?": "+da(h):"")+(null!=e?" at "+Z(e):""))}
function ze(a){var b;if(Hd(a)){if(!a.N||!a.N.length){a.N=Array(1E3);for(b=0;b<a.N.length;b++)a.N[b]=W();a.ga=0;a.g("instruction history buffer allocated")}if(!a.K||!a.K.length)for(a.K=Array(256),b=0;b<a.K.length;b++)a.K[b]=[b,0]}else a.N&&a.N.length&&a.g("instruction history buffer freed"),a.ga=0,a.N=[],a.K=[]}m.gb=function(a){if(!Ue(this))return!1;this.b.gb(a);return!0};
m.sb=function(a,b,c){if(!Ue(this))return!1;this.L=0;a||Hd(this)&&Id(this,this.b.P,0);try{var d=this.b.sb(a);0<d&&(this.L+=d,Ic(this.b,d,!0),Fc(this.b,d),this.ba++)}catch(e){"number"!=typeof e&&(this.L=0,qb(this.b,e.stack||e.message))}!1!==c&&Dc(this.b);this.Ia(b||!1);return 0<this.L};m.ma=function(a){this.b&&this.b.ma(a)};m.Ia=function(a){void 0===a&&(a=!0);this.O=W(this.b.P);a&&1!=this.X?Ve(this):uf(this)};
function Ue(a){var b;if(b=a.b&&pb(a.b))b=a.b,b.D.va?b=!0:(b.g(b.toString()+" not powered"),b=!1);b&&!mb(a.b)?(a=a.b,a.D.lb?(a.g(a.toString()+" error"),a=!0):a=!1,a=!a):a=!1;return a}m.Ea=function(a,b){return!b&&(this.reset(!0),a&&this.restore&&!this.restore(a))?!1:!0};m.Ha=function(a,b){b&&this.g(a?"suspending":"shutting down");return a?this.save():!0};m.reset=function(a){ze(this);this.ba=this.ya=0;this.qa=null;this.L=0;this.O=W(this.b.P);this.D.xa=!1;vf(this);a||this.Ia()};
m.save=function(){var a=new H(this);I(a,0,Je(this.O));I(a,1,Je(this.ca));I(a,2,[this.A,this.da,this.ra]);I(a,3,this.H);return a.data()};m.restore=function(a){var b=0;void 0!==a[2]&&(this.O=Ke(a[b++]),this.ca=Ke(a[b++]),this.A=a[b][0],"string"==typeof this.A&&(this.A=[this.A]),this.da=a[b][1],this.ra|=a[b][2]);a[3]&&(this.H=a[3]);return!0};m.start=function(a,b){this.X||this.g("running");this.D.xa=!0;this.wb=a;this.xb=b};
m.stop=function(a,b){if(this.D.xa){this.D.xa=!1;this.L=b-this.xb;if(!this.X){var c="stopped";if(this.L){var d=a-this.wb,e=0<d?Math.round(1E3*this.L/d):0,c=c+" (";Hd(this)&&(c+=this.ba+" opcodes, ",this.ya-=this.ba,this.ba=0);c+=this.L+" cycles, "+d+" ms, "+e+" hz)"}else kb(this,-2147483648)&&(c+=" (use the 't' command to execute blocked faults)");this.g(c)}this.Ia(!0);this.Fb();vf(this,this.b.P)}};function Hd(a){return 1<a.j.length||!!a.pa}
function Id(a,b,c){var d=a.b;if(0<c&&(a.pa&&!--a.pa||ic(a,b,1,a.j)))return!0;0<=c&&a.K.length&&(a.ba++,b=Cb(a.w,b),null!=b&&(a.K[b][1]++,b=a.N[a.ga],b.G=d.P,b.Pa=!1,++a.ga==a.N.length&&(a.ga=0)));return!1}function Rb(a,b,c){a.g("break on input from port "+t(b)+": "+n(c));a.ma(!0)}function Vb(a,b,c){a.g("break on output to port "+t(b)+": "+n(c));a.ma(!0)}
function ye(a){var b,c;a.j=["bp"];if(void 0!==a.R)for(b=1;b<a.R.length;b++){c=a.R[b];var d=a.w;jc(d.Y[Ge(c)>>>d.oa],!1)}a.R=["br"];if(void 0!==a.J)for(b=1;b<a.J.length;b++)c=a.J[b],d=a.w,jc(d.Y[Ge(c)>>>d.oa],!0);a.J=["bw"];a.bb=0}m.$a=function(a,b,c){var d=!0;c||wf(this,a,b,!1,!0);if(a!=this.j){var e=Ge(b);if(-1===e)this.g("invalid address: "+Z(b.G)),d=!1;else{var f=this.w;f.Y[e>>>f.oa].$a(e&f.w,a==this.J)}}d&&(a.push(b),c?b.Pa=!0:(xf(this,a,a.length-1,"set"),ze(this)));return d};
function wf(a,b,c,d,e){var f=!1;c=Ge(c);for(var h=1;h<b.length;h++){var g=b[h];if(c==Ge(g)&&(!d||g.Pa)){f=!0;g.Pa||e||xf(a,b,h,"cleared");b.splice(h,1);b!=a.j&&(d=a.w,jc(d.Y[c>>>d.oa],b==a.J));g.Pa||ze(a);break}}return f}function yf(a,b){for(var c=1;c<b.length;c++)xf(a,b,c);return b.length-1}function xf(a,b,c,d){c=b[c];a.g(b[0]+" "+Z(c.G)+(d?" "+d:c.Ic?' "'+c.Ic+'"':""))}
function vf(a,b){if(void 0!==b)ic(a,b,1,a.j,!0),a.X=0;else for(var c=1;c<a.j.length;c++){var d=a.j[c];if(d.Pa){if(!wf(a,a.j,d,!0))break;c=0}}}
function ic(a,b,c,d,e){var f=!1;if(!a.bb++)for(var h=1;!f&&h<d.length;h++){var g=d[h];if(!e||g.Pa)for(var k=Ge(g),l=0;l<c;l++)if(b+l==k){var p,f=!0;g.Pa&&(wf(a,d,g,!0),e=!0);if(p=g.ud){for(var f=!1,q=0;q<p.length;q++)if(!zf(a,p[q],!0)){if(p[q].indexOf("if")){f=!0;break}for(var x=q+1;x<p.length&&p[x].indexOf("else");x++)q++;if(x==p.length){f=!0;break}}a.b.D.xa||(f=!0)}if(f){e||xf(a,d,h,"hit");break}}}a.bb--;return f}
function Af(a,b,c,d){for(var e=W(b.G),f=a.$(b,1),h=a.Na[f],g="",k=(8086!=a.style?Ce:De)[h[0]],l=h.length-1,p=0,q,x=1;x<=l;x++){var u="";q=h[x];if(void 0!==q&&!(q&16384&&a.style==xe)){var r=q&240;if(r){var B=q&15;B?p=B:q|=p;q&61440||(q|=1==x?8192:4096);if(r&32)a:{var u=a,r=q,B=b,y=" ";switch(r&15){case 1:y=n(u.$(B,1),2);break;case 2:y=n(u.$(B,1)<<24>>24,4);break;case 3:y=n(u.Ta(B,2),4);break;default:u="imm("+t(r)+")";break a}8086==u.style&&r&64?y="["+y+"]":r&16||(y=(u.style==xe?"$":"0x")+y);u=y}else r&
16?(u=(q&3840)>>8,r=Ee[u],8086==a.style&&q&64&&(6==u&&(r="HL"),r="["+r+"]"),u=r):r&128&&(u=(f>>3&7).toString());if(!u||!u.length){g="INVALID";break}0<g.length&&(g+=",");g+=u||"???"}}}f="";h=Z(e.G)+" ";if(-1!==e.G&&-1!==b.G){do if(f+=n(a.$(e,1),2),null==e.G)break;while(e.G!=b.G)}h+=la(f,10);h=h+(q&32768?"*":" ")+la(k,7);g&&(h+=" "+g);c&&(h=la(h,40)+";"+c,h=a.b.D.kb?h+("cycles="+Gc(a.b).toString()+" cs="+n(a.b.u.zb)):h+(null!=d?"="+d.toString():""));return h}
function Bf(a,b){var c;switch(b){case "IF":c=a.b.sa&512;break;case "SF":c=dd(a.b);break;case "ZF":c=cd(a.b);break;case "AF":c=bd(a.b);break;case "PF":c=ad(a.b);break;case "CF":c=Zc(a.b);break;default:c=0}return b.charAt(0)+(c?"1":"0")+" "}function Cf(a,b){return Ee[b]+"="+Re(a,b)+" "}function Df(a){return Cf(a,7)+Cf(a,8)+Cf(a,9)+Cf(a,10)+Cf(a,11)+Bf(a,"IF")+Bf(a,"SF")+Bf(a,"ZF")+Bf(a,"AF")+Bf(a,"PF")+Bf(a,"CF")}
var Ef={"||":0,"&&":1,"|":2,"^":3,"&":4,"!=":5,"==":5,">=":6,">":6,"<=":6,"<":6,">>>":7,">>":7,"<<":7,"-":8,"+":8,"%":9,"/":9,"*":9};
function Ff(a,b,c){for(c=c||-1;c--&&b.length;){var d=b.pop();if(2>a.length)return!1;var e=a.pop(),f=a.pop();switch(d){case "*":d=f*e;break;case "/":if(!e)return!1;d=f/e;break;case "%":if(!e)return!1;d=f%e;break;case "+":d=f+e;break;case "-":d=f-e;break;case "<<":d=f<<e;break;case ">>":d=f>>e;break;case ">>>":d=f>>>e;break;case "<":d=f<e?1:0;break;case "<=":d=f<=e?1:0;break;case ">":d=f>e?1:0;break;case ">=":d=f>=e?1:0;break;case "==":d=f==e?1:0;break;case "!=":d=f!=e?1:0;break;case "&":d=f&e;break;
case "^":d=f^e;break;case "|":d=f|e;break;case "&&":d=f&&e?1:0;break;case "||":d=f||e?1:0;break;default:return!1}a.push(d|0)}return!0}
function Me(a,b,c){var d;if(b){b=Le(a,b);for(var e=0,f=!1,h=b,g=[],k=[],l=b.split(/(\|\||&&|\||^|&|!=|==|>=|>>>|>>|>|<=|<<|<|-|\+|%|\/|\*)/);e<l.length;){var p=l[e++],q=p.length,p=ma(p);if(!p){f=!0;break}p=Gf(a,p,null,!1===c);if(void 0===p){f=!0;c=!1;break}g.push(p);if(e==l.length)break;var p=l[e++],x=p.length;k.length&&Ef[p]<Ef[k[k.length-1]]&&Ff(g,k,1);k.push(p);b=b.substr(q+x)}Ff(g,k)&&1==g.length||(f=!0);f?c&&a.g("error parsing '"+h+"' at character "+(h.length-b.length)):(d=g.pop(),c&&Hf(a,null,
d))}return d}function Le(a,b){for(var c;(c=b.match(/\{(.*?)}/))&&!(0<=c[1].indexOf("{"));){var d=Me(a,c[1]);b=b.replace("{"+c[1]+"}",null!=d?n(d):"undefined")}for(;(c=b.match(/\[(.*?)]/))&&!(0<=c[1].indexOf("["));)d=He(a,c[1]),b=b.replace("["+c[1]+"]",d?n(a.Ta(d,0),4):"undefined");for(c=b;d=c.match(/\$([a-z]+)/i);){var e=null;switch(d[1].toLowerCase()){case "ops":e=a.ba-a.ya}if(null==e)break;c=c.replace(d[0],e.toString())}return c}
function Gf(a,b,c,d){var e;void 0!==b?(e=Qe(b),0<=e?e=Se(a,e):(e=a.fa[b],void 0===e&&(e=ca(b))),void 0!==e||d||a.g("invalid "+(c?c:"value")+": "+b)):d||a.g("missing "+(c||"value"));return e}
function Hf(a,b,c){var d,e=!1;if(void 0!==c){e=!0;d=c;var f,h="";if(!f||4<f)f=4;for(var g=0;g<f;g++){h&&(h=","+h);var k=d&255,l=8,p="";void 0===l?l=32:32<l&&(l=32);if(null==k||isNaN(k))for(;0<l--;)p="?"+p;else for(;0<l--;)p=(k&1?"1":"0")+p,k>>=1;h=p+"b"+h;d>>=8}d="0x"+n(c)+" "+c+". ("+h+")"}a.g((null!=b?b+": ":"")+d);return e}function If(a,b){if(b)return Hf(a,b,a.fa[b]);var c=0;for(b in a.fa)Hf(a,b,a.fa[b]),c++;return 0<c}we.prototype.Ua=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0};
function Jf(a,b,c){var d=[],e=Ge(b)>>>0;for(b=0;b<a.H.length;b++){var f=a.H[b],h=f.G>>>0,g=f.Fd;if(e>=h&&e<h+g){e=oa(f.nc,[e-h],a.Ua);0<=e?Kf(a,b,e,d):c&&(e=~e,Kf(a,b,e-1,d),Kf(a,b,e,d));break}}return d}function Kf(a,b,c,d){var e={},f=a.H[b].nc,h=0,g=null;0<=c&&c<f.length&&(h=f[c][0],g=f[c][1]);g&&(e=a.H[b].Ra[g],g="."==g.charAt(0)?null:e.l||g);d.push(g);d.push(h);d.push(e.a);d.push(e.c)}
function Lf(a,b){if("?"==b)a.g("frequency commands:"),a.g("\tclear\tclear all frequency counts");else{var c,d=0;if(a.K)if("clear"==b){for(c=0;c<a.K.length;c++)a.K[c]=[c,0];a.g("frequency data cleared");d++}else if(void 0!==b)a.g("unknown frequency command: "+b),d++;else{var e=a.K.slice();e.sort(function(a,b){return b[1]-a[1]});var f=8086!=a.style?Ce:De;for(c=0;c<e.length;c++){var h=e[c][0],g=e[c][1];g&&(a.g((f[a.Na[h][0]]+"  ").substr(0,5)+" ("+da(h)+"): "+g+" times"),d++)}}d||a.g("no frequency data available")}}
function Mf(a,b){var c=b.match(/^\s*([A-Z_]?[A-Z0-9_]*)\s*(=?)\s*(.*)$/i);if(c){if(!c[1])return If(a)||a.g("no variables"),!0;if(!c[2])return If(a,c[1]);if(!c[3])return delete a.fa[c[1]],!0;var d=Me(a,c[3]);return void 0!==d?(a.fa[c[1]]=d,!0):!1}a.g("invalid assignment:"+b);return!1}
function Nf(a,b,c){var d=null;if(b=He(a,b,!0)){var e=Jf(a,b,!0);if(e.length){var f,h;e[0]&&(h="",(f=b.G-e[1])&&(h=" + "+t(f)),f=e[0]+" ("+Z(e[1])+")"+h,c&&a.g(f),d=f);4<e.length&&e[4]&&(h="",(f=e[5]-b.G)&&(h=" - "+t(f)),f=e[4]+" ("+Z(e[5])+")"+h,c&&a.g(f),d||(d=f))}else c&&a.g("no symbols")}return d}
function Of(a,b){switch(b[1]){case "8080":a.style=xe;break;case "8086":a.style=8086;break;case "cs":var c;void 0!==b[3]&&(c=+b[3]);switch(b[2]){case "int":a.b.u.nb=c;break;case "start":a.b.u.Ab=c;break;case "stop":a.b.u.pb=c;break;default:a.g("unknown cs option");return}void 0!==c&&Bc(a.b);a.g("checksums "+(a.b.D.kb?"enabled":"disabled"));return;case "sp":void 0!==b[2]&&(Hc(a.b,+b[2])||a.g("warning: using 1x multiplier, previous target not reached"));a.g("target speed: "+(a.b.u.eb.toFixed(2)+"Mhz")+
" ("+a.b.u.Sa+"x)");return;case "?":a.g("debugger options:");a.g("\t8080\t\tselect 8080-style mnemonics");a.g("\t8086\t\tselect 8086-style mnemonics");a.g("\tcs int #\tset checksum cycle interval to #");a.g("\tcs start #\tset checksum cycle start count to #");a.g("\tcs stop #\tset checksum cycle stop count to #");a.g("\tsp #\t\tset speed multiplier to #");break;default:if(b[1]){a.g("unknown option: "+b[1]);return}}a.g(a.style+"-style mnemonics enabled")}
function Ve(a,b){var c;if(b&&"?"==b[1])a.g("register commands:"),a.g("\tr\tdump registers"),a.g("\trx [#]\tset flag or register x to [#]");else{var d=a.b;null==c&&(c=!0);if(null!=b&&1<b.length){var e=b[1],f=null,h=e.indexOf("=");if(0<h)f=e.substr(h+1),e=e.substr(0,h);else if(2<b.length)f=b[2];else{a.g("missing value for "+b[1]);return}var h=!1,g=Me(a,f);if(void 0!==g)switch(h=!0,e.toUpperCase()){case "A":d.i=g&255;break;case "B":d.S=g&255;break;case "BC":d.S=g>>8&255;case "C":d.T=g&255;break;case "D":d.U=
g&255;break;case "DE":d.U=g>>8&255;case "E":d.V=g&255;break;case "H":d.W=g&255;break;case "HL":d.W=g>>8&255;case "L":d.Z=g&255;break;case "SP":d.ka=g&65535;break;case "PC":G(d,g);a.O=W(d.P);break;case "PS":Rc(d,g);break;case "PSW":Rc(d,g&255|d.sa&-256);d.i=g>>8;break;case "CF":d.aa=g?d.aa|256:d.aa&255;break;case "PF":g?ad(d)||(d.ea^=1):ad(d)&&(d.ea^=1);break;case "AF":d.wa=g?~d.ea&16|d.wa&-17:d.ea&16|d.wa&-17;break;case "ZF":d.aa=g?d.aa&-256:d.aa|255;break;case "SF":g?dd(d)||(d.ea^=192):dd(d)&&(d.ea^=
192);break;case "IF":d.sa=g?d.sa|512:d.sa&-513;break;default:a.g("unknown register: "+e);return}if(!h){a.g("invalid value: "+f);return}Dc(d);a.g("updated registers:")}a.g(Df(a));c&&(a.O=W(d.P),uf(a,Z(a.O.G)))}}function Pf(a,b){b=ma(b);var c=b.match(/^(['"])(.*?)\1$/);c?a.g(Te(a,c[2])):Me(a,b,!0)}function Qf(a,b,c){var d="t"!=b;c=Gf(a,c,null,!0)||1;var e=1==c?0:1;"tc"==b&&(e=c,c=1);Ba(c,function(){return lb(a,!0)&&a.sb(e,d,!1)},function(){Dc(a.b);lb(a,!1)})}
function uf(a,b,c,d){if(b=He(a,b,!0)){void 0===d&&(d=1);var e=256;if(void 0!==c){d=He(a,c,!0);if(!d||d.G<b.G)return;e=d.G-b.G;if(256<e){a.g("range too large");return}d=-1}c=0;for(var f;0<e&&d--;){f=mb(a,!1)||a.X?a.L:null;var h=null!=f?"cycles":null,g=Jf(a,b),k=b.G;if(g[0]&&d&&(!c&&d||0>g[0].indexOf("+"))){var l=g[0]+":";g[2]&&(l+=" "+g[2]);a.g(l)}g[3]&&(h=g[3],f=null);f=Af(a,b,h,f);a.g(f);a.O=b;e-=b.G-k;c++}}}
function Oe(a,b,c,d){if(c)if(b){0>a.F&&a.A.length&&(a.F=0);if(0>a.F||b!=a.A[a.F])a.A.splice(0,0,b),a.F=0;a.F--}else a.da?b="end":b=a.A[a.F+1];a=[];if(b){b=b.toLowerCase().replace(/""/g,"'");c=0;var e=null;d=d||";";for(var f=0;f<=b.length;f++){var h=b.charAt(f);if('"'==h||"'"==h)e?h==e&&(e=null):e=h;else if(h==d&&!e||!h)a.push(ma(b.substring(c,f))),c=f+1}}return a}
function zf(a,b,c){var d=!0;try{b.length&&"end"!=b?c||a.g(">> "+b):(a.da&&(a.g("ended assemble at "+Z(a.ca.G)),a.O=a.ca,a.da=!1),b="");var e=b.charAt(0);if('"'==e||"'"==e)return!0;a.qa=null;if(pb(a)&&0<b.length){a.da&&(b="a "+Z(a.ca.G)+" "+b);var f=b.replace(/ +/g," ").split(" ");if(f&&f.length)for(var h=f[0],g=h.charAt(0),k=1;k<h.length;k++){var l=h.charAt(k);if("?"==g||"r"==g||"a">l||"z"<l){f[0]=h.substr(k);f.unshift(h.substr(0,k));break}}switch(f[0].charAt(0)){case "a":var p=He(a,f[1],!0);if(p)if(a.ca=
p,void 0===f[2])a.g("begin assemble at "+Z(p.G)),a.da=!0,Dc(a.b);else{var q;a.g("not supported yet");q=[];if(q.length){for(var x=0;x<q.length;x++)a.ta(p,q[x],1);a.g(Af(a,a.ca))}}break;case "b":a:{var u=f[0],r=f[1],B=b;if("?"==r)a.g("breakpoint commands:"),a.g("\tbi [p]\ttoggle break on input port [p]"),a.g("\tbo [p]\ttoggle break on output port [p]"),a.g("\tbp [a]\tset exec breakpoint at addr [a]"),a.g("\tbr [a]\tset read breakpoint at addr [a]"),a.g("\tbw [a]\tset write breakpoint at addr [a]"),
a.g("\tbc [a]\tclear breakpoint at addr [a]"),a.g("\tbl\tlist all breakpoints"),a.g("\tbn [n]\tbreak after [n] instruction(s)");else{var y=u.charAt(1);if("l"==y){var X=0,X=X+yf(a,a.j),X=X+yf(a,a.R);(X+=yf(a,a.J))||a.g("no breakpoints")}else if("n"==y)a.pa=Gf(a,r),a.g("break after "+a.pa+" instruction(s)");else if(void 0===r)a.g("missing breakpoint address");else{var A=W();if("*"!=r&&(A=He(a,r,!0),!A))break a;r=t(A.G);"c"==y?null==A.G?(ye(a),a.g("all breakpoints cleared")):wf(a,a.j,A)||wf(a,a.R,A)||
wf(a,a.J,A)||a.g("breakpoint missing: "+Z(A.G)):"i"==y?a.g("breakpoint "+(Gb(a.w,A.G)?"enabled":"cleared")+": port "+r+" (input)"):"o"==y?a.g("breakpoint "+(Sb(a.w,A.G)?"enabled":"cleared")+": port "+r+" (output)"):null!=A.G&&(Ne(a,A,B),"p"==y?a.$a(a.j,A):"r"==y?a.$a(a.R,A):"w"==y?a.$a(a.J,A):a.g("unknown breakpoint command: "+y))}}}break;case "c":a.Fa&&(a.Fa.value="");break;case "d":a:{var Q,aa=f[0],Y=f[1],ua=f[2],Eb=f[3];if("?"==Y){var Fa="";for(Q in tb)a.Ba[Q]&&(Fa&&(Fa+=","),Fa+=Q);Fa+=",state,symbols";
a.g("dump memory commands:");a.g("\tdb [a] [#]    dump # bytes at address a");a.g("\tdw [a] [#]    dump # words at address a");a.g("\tdd [a] [#]    dump # dwords at address a");a.g("\tdh [#] [#]    dump # instructions from history");Fa.length&&a.g("dump extension commands:\n\t"+Fa)}else if("state"==Y){var We=Rf(a.C,!0);"console"==ua?console.log(We):(a.Fa&&(a.Fa.value=""),a.g(We))}else if("symbols"==Y)for(var kd=0;kd<a.H.length;kd++){var ld=a.H[kd],nb;for(nb in ld.Ra)if("."!=nb.charAt(0)){var Xe=ld.Ra[nb].o;
if(void 0!==Xe){var Ye=ld.Ra[nb].l;Ye&&(nb=Ye);a.g(Z(Xe)+" "+nb)}}}else{if("d"==aa){for(Q in tb)if(f[1]==Q){var Ze=a.Ba[Q];Ze?(f.shift(),f.shift(),Ze(f)):a.g("no dump registered for "+Y);break a}Y||(aa=a.yb||"db")}else a.yb=aa;if("dh"==aa){var $e=Y,af=ua,bf="",cf=0,ba=a.ga,Ga=a.N;if(Ga.length){var ia=+$e||a.hb,ob=+af||10;isNaN(ia)?ia=ob:bf="more ";ia>Ga.length&&(a.g("note: only "+Ga.length+" available"),ia=Ga.length);ba-=ia;0>ba&&(null==Ga[Ga.length-1].G?(ia=ba+ia,ba=0):ba+=Ga.length);var md=[];"call"==
af&&(ob=1E5,md=["CALL"]);for(void 0!==$e&&a.g(ia+" instructions earlier:");0<ob&&ba!=a.ga;){var df=Ga[ba++];if(null==df.G)break;var Jb=W(df.G),jg=ia--,ef=Af(a,Jb,"history",jg);(!md.length||0<=ef.indexOf(md[0]))&&a.g(ef);Jb.Tb&&(ba+=Jb.Tb,ob-=Jb.Tb,ia-=Jb.Tb);ba>=Ga.length&&(ba=0);a.hb=ia;cf++;ob--}}cf||(a.g("no "+bf+"history available"),a.hb=void 0)}else{var pc=He(a,Y);if(pc){var qc=0;ua&&("l"==ua.charAt(0)&&(ua=ua.substr(1)||Eb),qc=Gf(a,ua)>>>0,65536<qc&&(qc=65536));for(var Xa="",rc="dd"==aa?4:"dw"==
aa?2:1,sc=rc*qc||128,kg=sc+15>>4||1;kg--&&0<sc;){var tc=0,nd=0,Kb,Lb="",od="",Y=Z(pc.G);for(Kb=16;0<Kb&&0<sc;Kb--){var uc=a.$(pc,1),tc=tc|uc<<(nd++<<3);nd==rc&&(Lb+=n(tc,2*rc),Lb+=1==rc?9==Kb?"-":" ":"  ",tc=nd=0);od+=32<=uc&&128>uc?String.fromCharCode(uc):".";sc--}Xa&&(Xa+="\n");Xa+=Y+"  "+Lb+(0==Kb?" "+od:"")}Xa&&a.g(Xa);a.ab=pc}}}}break;case "e":if("else"==f[0])break;var vc=1,ff=255,gf=a.$,hf=a.ta;"ew"==f[0]&&(vc=2,ff=65535,gf=a.Ta,hf=a.Sb);var jf=vc<<1,kf=f[1];if(null==kf)a.g("edit memory commands:"),
a.g("\teb [a] [...]  edit bytes at address a"),a.g("\tew [a] [...]  edit words at address a");else{var wc=He(a,kf);if(wc)for(var xc=2;xc<f.length;xc++){var Mb=Me(a,f[xc]);if(void 0===Mb){a.g("unrecognized value: "+f[xc]);break}Mb&~ff&&a.g("warning: "+n(Mb)+" exceeds "+vc+"-byte value");var lg=gf.call(a,wc);a.g("changing "+Z(wc.G)+" from 0x"+n(lg,jf)+" to 0x"+n(Mb,jf));hf.call(a,wc,Mb,vc)}}break;case "f":Lf(a,f[1]);break;case "g":a:{var lf=f[1],mg=b;if(void 0!==lf){var pd=He(a,lf,!0);if(!pd)break a;
Ne(a,pd,mg);a.$a(a.j,pd,!0)}a.gb(!0)||c||a.g("cpu busy or unavailable, run command ignored")}break;case "h":a:{var qd;if(a.D.xa)qd="halting",a.ma();else{if(mb(a,!0))break a;qd="already halted"}c||a.g(qd)}break;case "i":if("if"==f[0]){var rd;var Nb=b.substr(2),Nb=ma(Nb);Me(a,Nb)?(c||a.g("true: "+Nb),rd=!0):(c||a.g("false: "+Nb),rd=!1);rd||(d=!1);break}if("int"==f[0]){var yc;var ng=f[1];if(a.b.sa&512){var sd=Me(a,ng);null==sd?yc=!1:(a.g("requesting interrupt level "+sd),Gd(a.b,sd),yc=!0)}else a.g("interrupts disabled (use rif=1 to enable)"),
yc=!1;yc||(d=!1);break}var td=f[1];if(td&&"?"!=td){var ud=Gf(a,td);if(void 0!==ud){var og=Ib(a.w,ud);a.g(t(ud)+": "+da(og))}}else a.g("input commands:"),a.g("\ti [p]\tread port [p]"),a.g("warning: port accesses can affect hardware state");break;case "k":var pg=f[0];if("?"==f[1])a.g("stack trace commands:"),a.g("\tk\tshow frame addresses"),a.g("\tks\tshow symbol information");else{var vd=0,mf=W(),Ob=W(a.b.ka);for(a.g("stack trace for "+Z(Ob.G));10>vd;){for(var Ya=null,qg=256;65536>Ob.G>>>0;){mf.G=
a.Ta(Ob,2);if(null==Ob.G||!qg--)break;for(var rg=a,zc=mf,nf=null,Pb=zc.G,of=Pb,wd=1;6>=wd&&Pb;wd++){if(2<wd){zc.G=Pb;var Ac=Af(rg,zc);if(0<=Ac.indexOf("CALL")){var pf=Ac.indexOf(" ");if(Pb+(Ac.indexOf(" ",pf+1)-pf-1)/2==of){nf=Ac;break}}}Pb--}zc.G=of;if(Ya=nf)break}if(!Ya||null==Ya)break;var qf=null;if("ks"==pg){var rf=Ya.match(/[0-9A-F]+$/);rf&&(qf=Nf(a,rf[0]))}Ya=la(Ya,50)+"  ;"+(qf||"stack="+Z(Ob.G));a.g(Ya);vd++}vd||a.g("no return addresses found")}break;case "l":if("ln"==f[0]){Nf(a,f[1],!0);
break}break;case "m":a:{var Ha,Ia=null,N=f[1];"?"==N&&(N=void 0);if(void 0!==N){var Ra=0;if("all"==N)Ra=1878917119,N=null;else if("on"==N)Ia=!0,N=null;else if("off"==N)Ia=!1,N=null;else{"keys"==N&&(N="key");"kbd"==N&&(N="keyboard");for(Ha in tb)if(N==Ha){Ra=tb[Ha];Ia=!!(a.ra&Ra);break}if(!Ra){a.g("unknown message category: "+N);break a}}if(Ra)if("on"==f[2])a.ra|=Ra,Ia=!0;else if("off"==f[2]&&(a.ra&=~Ra,Ia=!1,1073741824==Ra)){for(var xd=0;xd<a.ua.length;xd++)a.g(a.ua[xd]);a.ua=[]}}var sg=0,Sa="";for(Ha in tb)if(!N||
N==Ha){var tg=!!(a.ra&tb[Ha]);if(null===Ia||Ia==tg)Sa&&(Sa+=","),++sg%10||(Sa+="\n\t"),"key"==Ha&&(Ha="keys"),Sa+=Ha}void 0===N&&a.g("message commands:\n\tm [category] [on|off]\tturn categories on/off");a.g((null!==Ia?Ia?"messages on:  ":"messages off: ":"message categories:\n\t")+(Sa||"none"));ze(a)}break;case "o":var yd=f[1],ug=f[2];if(yd&&"?"!=yd){var zd=Gf(a,yd,"port #"),Ad=Gf(a,ug);void 0!==zd&&void 0!==Ad&&(Ub(a.w,zd,Ad),a.g(t(zd)+": "+da(Ad)))}else a.g("output commands:"),a.g("\to [p] [b]\twrite byte [b] to port [p]"),
a.g("warning: port accesses can affect hardware state");break;case "p":if("print"==f[0]){Pf(a,b.substr(5));break}var sf="pr"==f[0]?1:0,vg=1+sf;if(a.X)a.g("step in progress");else{var Bd=W(a.b.P);switch(a.$(Bd)){case 205:a.X=vg,Ie(Bd,3)}a.X?(a.$a(a.j,Bd,!0),a.gb()||(a.C&&a.C.Fb(),a.X=0)):Qf(a,sf?"tr":"t")}break;case "r":if("reset"==b){a.C&&a.C.reset();break}Ve(a,f);break;case "s":Of(a,f);break;case "t":Qf(a,f[0],f[1]);break;case "u":uf(a,f[1],f[2],8);break;case "v":if("var"==f[0]){Mf(a,b.substr(3))||
(d=!1);break}a.g("PC8080 version 1.24.1 ("+a.b.zc+",RELEASE"+(rb?",TYPEDARRAYS":",LONGARRAYS")+")");a.g(ta());break;case "?":if(f[1]){Pf(a,b.substr(1));break}var Qb="commands:",Cd;for(Cd in Be)Qb+="\n"+la(Cd,9)+Be[Cd];Hd(a)||(Qb+="\nnote: frequency/history disabled if no exec breakpoints");a.g(Qb);break;default:a.g("unknown command: "+b),d=!1}}}catch(tf){a.g("debugger error: "+(tf.stack||tf.message)),d=!1}return d}function Cc(a,b,c){b=Oe(a,b,c);for(var d in b)if(!zf(a,b[d]))return!1;return!0}
Ma(function(){for(var a=C(document,"pc8080","debugger"),b=0;b<a.length;b++){var c=a[b],d=z(c),d=new we(d);hb(d,c)}});
function Sf(a,b,c){w.call(this,"Computer",a,Sf,67108864);this.D.va=!1;Tf(this,b);this.R=nc(this,"autoPower",a);this.A=0;this.fa=a.busWidth||a.buswidth;this.C=Uf;this.N=null;this.K=this.ca=!1;this.ga=nc(this,"url")||"";(Math.random()+.1).toString(36);this.j=Vf(this);if(this.b=gb("CPU",this.id)){this.I=gb("Debugger",this.id);this.H=[];for(b=null;b=vb(this,"Video",b);)this.H.push(b);this.w=new xb({id:this.Kb+".bus",busWidth:this.fa},this.b,this.I);var d,e=eb(this.id);if((this.F=gb("Panel",this.id))&&
this.F.Fa)for(b=0;b<e.length;b++)d=e[b],d.ia=this.F.ia,d.g=this.F.g,d.Fa=this.F.Fa;this.g("PC8080 v1.24.1\nCopyright \u00a9 2012-2016 Jeff Parsons <Jeff@pcjs.org>\nLicense: GPL version 3 or later <http://gnu.org/licenses/gpl.html>");for(b=0;b<e.length;b++)d=e[b],d.Qa&&d.Qa(this,this.w,this.b,this.I);b=null;d=a.resume;void 0!==d&&(1<d.length?b=this.L=d:this.C=parseInt(d,10));var f;if(a=nc(this,"state")||(f=!0,a.state))b=this.X=a,f||(this.K=!0,this.C=Uf),this.C&&(this.O=new H(this,"1.24.1"),Wf(this.O)?
b=null:delete this.O);!b&&this.C&&(b=Xf(this))&&(this.K=!0);if(b){var h=this;sa(b,null,!0,function(a,b,c){c?(h.L=null,h.K=!1,h.ia("Unable to load machine state from server (error "+c+(b?": "+ma(b):"")+")")):(h.N=b,h.ca=!0);E(h)})}else E(this);this.M.power||(this.R=!0);!c&&this.R&&Yf(this,this.Db)}else v("Unable to find CPU component")}bb(Sf);var Uf=0;function Tf(a,b){if(!b){var c;if("object"==typeof resources&&(c=resources.parms))try{b=eval("("+c+")")}catch(d){v(d.message+" ("+c+")")}}a.da=b}
function nc(a,b,c){var d=b.toLowerCase(),d=Va[b]||Va[d];void 0===d&&a.da&&(d=a.da[b]);void 0===d&&c&&(d=c[b]);void 0===d&&"object"==typeof resources&&resources[b]&&(d=b);return d}function Yf(a,b,c){for(var d=eb(a.id),e=0;e<=d.length;e++){var f=e<d.length?d[e]:a;if(!pb(f)){pb(f,function(){Yf(a,b,c)});return}}b.call(a,c)}
function Zf(a,b){var c=new H(a,"1.24.1","validate");if(Wf(c)&&$f(c)){var d=ag(c,"timestamp"),e=b?ag(b,"timestamp"):"unknown";d!=e&&(a.ia("Machine state may be out-of-date\n("+d+" vs. "+e+")\nCheck your browser's local storage limits"),b||c.clear())}}m=Sf.prototype;
m.Db=function(a){void 0===a&&(a=this.C||(this.N?1:Uf));if(!this.A){this.A++;var b=!1,c=!1;this.ba=!1;var d=this.O||new H(this,"1.24.1");if(-1==a)b=!0;else if(a>Uf){if(Wf(d,this.N)){this.J=new H(this,"1.24.1","failsafe");Wf(this.J)&&(bg(this,d),a=2,cg(this.J));I(this.J,"timestamp",qa());dg(this.J);var e=this.C&&!this.K;if(1==a||va("Click OK to restore the previous PC8080 machine state, or CANCEL to reset the machine.")){if(c=$f(d)){var f=ag(d,"code"),h=ag(d,"data");f&&("ok"==f?Wf(d,h):("error"==f&&
"no machine state"!=h?(this.ia("Error: "+h),"unable to verify user"==h&&(za("user",""),this.j=null)):this.g(f+": "+h),cg(d),Wf(d)?(c=$f(d),e=!0):c=!1))}e&&Zf(this,c?d:null)}else 2==a&&d.clear()}else Zf(this);delete this.N;delete this.O}e=eb(this.id);for(f=0;f<e.length;f++)h=e[f],h!==this&&h!=this.b&&(c=eg(this,h,d,b,c));b=[d,a,c];-1!=a?Yf(this,this.oc,b):this.oc(b)}};
function eg(a,b,c,d,e){if(!b.D.va){b.D.va=!0;if(b.Ea){var f=null;e&&((f=ag(c,b.id))||(f=ag(c,b.id.replace(/[a-z0-9]\./i,"."))));"string"===typeof f&&(f=null);!b.Ea(f,d)&&f&&(v("Unable to restore state for "+b.type),a.X&&!a.ca?(c.clear(),a.C=Uf,window&&window.location.reload()):a.ba=!0,b.Ea(null),e=!1)}if(!d&&b.tc)for(a=b.tc.split("|"),c=0;c<a.length;c++)b.status(a[c])}return e}
m.oc=function(a){var b=a[0],c=0>a[1];a=a[2];this.ha=!0;this.D.va=!0;var d=this.M.power;d&&(d.textContent="Shutdown");this.b&&(eg(this,this.b,b,c,a),Ec(this.b));this.ba&&(bg(this,b),b.clear());!c&&this.J&&(this.J.clear(),delete this.J);this.A=0};
function bg(a,b){if(va("There may be a problem with your PC8080 machine.\n\nTo help us diagnose it, click OK to send this PC8080 machine state to http://www.pcjs.org.")){var c=a.j||"",d=b.toString(),e={app:"PC8080",ver:"1.24.1"};e.url=a.ga;e.user=c;e.type="bug";e.data=d;sa("http://www.pcjs.org/api/v1/report",e,!0)}}
function Rf(a,b,c){var d,e="none";if(a.A)return null;a.A--;var f=new H(a,"1.24.1"),h=new H(a,"1.24.1","validate"),g=qa();I(h,"timestamp",g);I(f,"timestamp",g);I(f,"version","1.24.1");I(f,"url",window?window.location.href:null);I(f,"browser",ta());a.b&&a.b.Ha&&(c&&a.b.ma(),d=a.b.Ha(b,c),"object"===typeof d&&I(f,a.b.id,d),c&&(a.b.D.va=!1,!1===d&&(e=null)));for(var g=eb(a.id),k=0;k<g.length;k++){var l=g[k];l.D.va&&(l.Ha&&(d=l.Ha(b,c),"object"===typeof d&&I(f,l.id,d)),c&&(l.D.va=!1,!1===d&&(e=null)))}e&&
(c?(g=d=!1,b?(a.j&&fg(a,a.j,f.toString()),dg(h)&&dg(f)||(e=null,d=g=!0)):a.C&&(d=!0,g=3==a.C),d&&f.clear(g)):e=f.toString());c&&(a.D.va=!1,b=a.M.power)&&(b.textContent="Power");a.A=0;return e}m.reset=function(){this.w&&this.w.reset&&(jb(this,"Resetting "+this.w.type),this.w.reset());for(var a=eb(this.id),b=0;b<a.length;b++){var c=a[b];c!==this&&c!==this.w&&c.reset&&(jb(this,"Resetting "+c.type),c.reset())}};
m.start=function(a,b){for(var c=eb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.start&&e.start(a,b)}};m.stop=function(a,b){for(var c=eb(this.id),d=0;d<c.length;d++){var e=c[d];"CPU"!=e.type&&e!==this&&e.stop&&e.stop(a,b)}};
m.la=function(a,b,c){var d=this;switch(b){case "power":return this.M[b]=c,c.onclick=function(){d.A||(d.D.va?Rf(d,!1,!0):Yf(d,d.Db))},!0;case "reset":return this.M[b]=c,c.onclick=function(){if(d.D.va&&!d.A)if(d.C&&!d.L){var a=va("Click OK to save changes to this PC8080 machine.\n\nWARNING: If you CANCEL, all disk changes will be discarded.");Rf(d,a,!0);!a&&d.X?window&&window.location.reload():d.Db(Uf)}else d.reset(),d.b&&Ec(d.b)},!0;case "save":if(ga()){c.parentNode.removeChild(c);break}this.M[b]=
c;c.onclick=function(){var a=Vf(d,!0);if(a){var b=!!(d.C&&!d.L||d.X),c=Rf(d,b);b?fg(d,a,c):d.ia("Resume disabled, machine state not saved")}};return!0}return!1};
function Vf(a,b){var c=a.j;c||(c=ya("user"),void 0!==c?!c&&b&&(c=null,window&&(c=window.prompt("Saving machine states on the pcjs.org server is currently unsupported.\n\nIf you're running your own server, enter your user ID below.","")),c&&((c=gg(a,c))||a.ia("The user ID is invalid."))):b&&a.ia("Browser local storage is not available"));return c}
function gg(a,b){a.j=null;var c=sa(ha()+"/api/v1/user?req=verify&user="+b),d=c[1];if(!c[0]&&d)try{c=eval("("+d+")"),c.code&&"ok"==c.code&&(za("user",c.data),a.j=c.data)}catch(e){v(e.message+" ("+d+")")}return a.j}function Xf(a){var b=null;a.j&&(b=ha()+"/api/v1/user?req=load&user="+a.j+"&state="+hg(a,"1.24.1"));return b}
function fg(a,b,c){if(c){var d={req:"store"};d.user=b;d.state=hg(a,"1.24.1");d.data=c;b=sa(ha()+"/api/v1/user",d);d=b[0];if(b[1]){if(d){var e=d.indexOf("\n");0<e&&(d=d.substr(0,e));d.indexOf("Error: ")||(d=d.substr(7))}d='{"code":'+b[1]+',"data":"'+d+'"}'}b=JSON.parse(d);b&&"ok"==b.code?a.ia("Machine state saved to server"):c&&(c=b&&b.data||"unable to save machine state",c="error"==b.code?"Error: "+c:"Error "+b.code+": "+c,a.ia(c),za("user",""),a.j=null)}}
function vb(a,b,c){a=eb(a.id);for(var d=0;d<a.length;d++){var e=a[d];if(c)c==e&&(c=null);else if(e.type==b)return e}return null}m.Fb=function(a){if(this.H.length){var b=0,c=0;!a&&window&&(b=window.scrollX,c=window.scrollY);var d=this.H[0];d.qa&&d.qa.focus();!a&&window&&window.scrollTo(b,c)}};m.Ia=function(a){this.b&&this.b.Ia(a);this.F&&this.F.Ia(a)};
Ma(function(){for(var a=C(document,"pc8080-machine"),b=0;b<a.length;b++)for(var c=a[b],d=z(c),c=C(c,"pc8080","computer"),e=0;e<c.length;e++){var f=c[e],h=z(f),h=new Sf(h,d,!0);hb(h,f);h.R&&Yf(h,h.Db)}});Da.show.push(function(){for(var a=C(document,"pc8080","computer"),b=0;b<a.length;b++){var c=z(a[b]);(c=gb("Computer",c.id))&&c.ha&&!c.D.va&&c.Db(-1)}});
Da.exit.push(function(){for(var a=C(document,"pc8080","computer"),b=0;b<a.length;b++){var c=z(a[b]);(c=gb("Computer",c.id))&&c.D.va&&Rf(c,!(!c.C||c.L),!0)}});function H(a,b,c){this.id=a.id;this.key=hg(a,b,c);this.I=a.I;cg(this,a.Xd)}function hg(a,b,c){a=a.id;if(b){var d=b.indexOf(".");0<d&&(a+=".v"+b.substr(0,d))}c&&(a+="."+c);return a}
H.prototype={constructor:H,value:function(){return this[this.id]},data:function(){return this[this.id]},toString:function(){var a=this[this.id];return"string"==typeof a?a:JSON.stringify(a)},clear:function(a){cg(this);var b=[];try{for(var c=0,d=window.localStorage.length;c<d;c++)b.push(window.localStorage.key(c))}catch(e){}for(c=0;c<b.length;c++)if((d=b[c])&&(a||d.substr(0,this.key.length)==this.key)){try{window.localStorage.removeItem(d)}catch(e){}b.splice(c,1);c=0}}};
function cg(a,b){a[a.id]={};b&&I(a,"parms",b);a.b=!1}function dg(a){var b=!0;if(xa()){var c=JSON.stringify(a[a.id]);za(a.key,c)||(v("Unable to store "+c.length+" bytes in browser local storage"),b=!1)}return b}function $f(a){var b=!0;try{a[a.id]=JSON.parse(a[a.id])}catch(c){v(c.message||c),b=!1}return b}function Wf(a,b){return b?(a[a.id]=b,a.b=!0):a.b?!0:xa()&&(b=ya(a.key))?(a[a.id]=b,a.b=!0):!1}function ag(a,b){return a[a.id][b]||null}function I(a,b,c){try{a[a.id][b]=c}catch(d){}}var ig=0;
function wg(a,b,c,d,e,f){e("Loading "+a+"...");sa(a,null,!0,function(h,g,k){k?(g||(g="unable to load "+a+" ("+k+")"),f(g,null)):xg(g,a,b,c,d,e,f)})}
function xg(a,b,c,d,e,f,h){function g(a,f){if(f)h(f,null);else{if(c){db(c,b,a);var g=b;g&&0>g.indexOf("/")&&"/"==window.location.pathname.slice(-1)&&(g=window.location.pathname+g);d?"}"==d.slice(-1)?(d=d.slice(0,-1),1<d.length&&(d+=",")):d='{state:"'+d+'",':d="{";d+='url:"'+g+'"}';"object"==typeof resources&&(g=null);a=a.replace(/(<machine[^>]*\sid=)(['"]).*?\2/,"$1$2"+c+"$2"+(d?" parms='"+d+"'":"")+(g?' url="'+g+'"':""))}e||(a=a.replace(/(<xsl:variable name="APPCLASS">).*?(<\/xsl:variable>)/,"$1pc8080$2"));
g=null;if("<"==a.charAt(0))try{e||(a=a.replace(/<!DOCTYPE(.|[\r\n])*]>\s*/g,"")),window.ActiveXObject||"ActiveXObject"in window?(g=new window.ActiveXObject("Microsoft.XMLDOM"),g.async=!1,g.loadXML(a)):g=(new window.DOMParser).parseFromString(a,"text/xml")}catch(q){g=null,a=q.message}else a="unrecognized XML: "+(255<a.length?a.substr(0,255)+"...":a);h(a,g)}}a?e?yg(a,f,g):g(a,null):h("no data"+(b?" for file: "+b:""),null)}
function yg(a,b,c){var d;if(d=/<([a-z]+)\s+ref="(.*?)"(.*?)\/>/g.exec(a)){var e=d[2];b("Loading "+e+"...");sa(e,null,!0,function(f,h,g){if(g||!h)c(a,"unable to resolve XML reference: "+d[0]+" ("+g+")");else{if(f=d[3])if(g=h.match(new RegExp("<"+d[1]+"[^>]*>"))){for(var k=g[0],l,p=/( [a-z]+=)(['"])(.*?)\2/g;l=p.exec(f);)k=0>k.indexOf(l[1])?k.replace(">",l[0]+">"):k.replace(new RegExp(l[1]+"(['\"])(.*?)\\1"),l[0]);g[0]!=k&&(h=h.replace(g[0],k))}else{c(a,"missing <"+d[1]+"> in "+e);return}h=h.replace(/<\?xml[^>]*>[\r\n]*/,
"");a=a.replace(d[0],h);yg(a,b,c)}})}else c(a,null)}
function zg(a,b,c,d){function e(a){if(void 0===g){var b=h&&C(h,"machine-warning");g=b&&b[0]||h}g&&(g.innerHTML=ka(a))}function f(a){e("Error: "+a);k&&(--ig||Pa(!0));k=!1}var h,g,k=!0;ig++;cb[a]={};try{if(h=document.getElementById(a)){var l;if("object"==typeof resources&&(l=resources.css)){var p=document.head||document.getElementsByTagName("head")[0],q=document.createElement("style");q.type="text/css";q.styleSheet?q.styleSheet.cssText=l:q.appendChild(document.createTextNode(l));p.appendChild(q)}c||
(c="/versions/pc8080/1.24.1/components.xsl");l=function(d,g){g?wg(c,null,null,!1,e,function(d,k){if(k)if(db(a,c,d),e("Processing "+b+"..."),window.ActiveXObject||"ActiveXObject"in window){var l=g.transformNode(k);l?(h.outerHTML=l,--ig||Pa(!0)):f("transformNodeToObject failed")}else document.implementation&&document.implementation.createDocument?(l=new XSLTProcessor,l.importStylesheet(k),(l=l.transformToFragment(g,document))?h.parentNode?(h.parentNode.replaceChild(l,h),--ig||Pa(!0)):f("invalid machine element: "+
a):f("transformToFragment failed")):f("unable to transform XML: unsupported browser");else f(d)}):f(d)};"<"!=b.charAt(0)?wg(b,a,d,!0,e,l):xg(b,null,a,d,!1,e,l)}else f("missing machine element: "+a)}catch(x){f(x.message)}return k}window.embedPC8080=function(a,b,c,d){Pa(!1);return zg(a,b,c,d)};window.enableEvents=Pa;window.sendEvent=Qa;})();
